/*! For license information please see owl.b76fad26ae7efdff5377.js.LICENSE.txt */
var Microsoft;!function(){var n,e,t,o,i={2227:function(n,e,t){n.exports=t(6282)},5999:function(n,e,t){"use strict";var o=t(8899),i=t(1083),r=t(7589),u=t(4748),a=t(2762),s=t(3903),l=t(683),c=t(7496),d=t(239),f=t(2881);n.exports=function(n){return new Promise((function(e,t){var v,h=n.data,p=n.headers,m=n.responseType;function w(){n.cancelToken&&n.cancelToken.unsubscribe(v),n.signal&&n.signal.removeEventListener("abort",v)}o.isFormData(h)&&delete p["Content-Type"];var g=new XMLHttpRequest;if(n.auth){var S=n.auth.username||"",b=n.auth.password?unescape(encodeURIComponent(n.auth.password)):"";p.Authorization="Basic "+btoa(S+":"+b)}var I=a(n.baseURL,n.url);function C(){if(g){var o="getAllResponseHeaders"in g?s(g.getAllResponseHeaders()):null,r={data:m&&"text"!==m&&"json"!==m?g.response:g.responseText,status:g.status,statusText:g.statusText,headers:o,config:n,request:g};i((function(n){e(n),w()}),(function(n){t(n),w()}),r),g=null}}if(g.open(n.method.toUpperCase(),u(I,n.params,n.paramsSerializer),!0),g.timeout=n.timeout,"onloadend"in g?g.onloadend=C:g.onreadystatechange=function(){g&&4===g.readyState&&(0!==g.status||g.responseURL&&0===g.responseURL.indexOf("file:"))&&setTimeout(C)},g.onabort=function(){g&&(t(c("Request aborted",n,"ECONNABORTED",g)),g=null)},g.onerror=function(){t(c("Network Error",n,null,g)),g=null},g.ontimeout=function(){var e=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded",o=n.transitional||d;n.timeoutErrorMessage&&(e=n.timeoutErrorMessage),t(c(e,n,o.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",g)),g=null},o.isStandardBrowserEnv()){var A=(n.withCredentials||l(I))&&n.xsrfCookieName?r.read(n.xsrfCookieName):void 0;A&&(p[n.xsrfHeaderName]=A)}"setRequestHeader"in g&&o.forEach(p,(function(n,e){void 0===h&&"content-type"===e.toLowerCase()?delete p[e]:g.setRequestHeader(e,n)})),o.isUndefined(n.withCredentials)||(g.withCredentials=!!n.withCredentials),m&&"json"!==m&&(g.responseType=n.responseType),"function"==typeof n.onDownloadProgress&&g.addEventListener("progress",n.onDownloadProgress),"function"==typeof n.onUploadProgress&&g.upload&&g.upload.addEventListener("progress",n.onUploadProgress),(n.cancelToken||n.signal)&&(v=function(n){g&&(t(!n||n&&n.type?new f("canceled"):n),g.abort(),g=null)},n.cancelToken&&n.cancelToken.subscribe(v),n.signal&&(n.signal.aborted?v():n.signal.addEventListener("abort",v))),h||(h=null),g.send(h)}))}},6282:function(n,e,t){"use strict";var o=t(8899),i=t(1012),r=t(363),u=t(7416),a=function n(e){var t=new r(e),a=i(r.prototype.request,t);return o.extend(a,r.prototype,t),o.extend(a,t),a.create=function(t){return n(u(e,t))},a}(t(1584));a.Axios=r,a.Cancel=t(2881),a.CancelToken=t(8466),a.isCancel=t(3824),a.VERSION=t(2655).version,a.all=function(n){return Promise.all(n)},a.spread=t(7447),a.isAxiosError=t(3608),n.exports=a,n.exports.default=a},2881:function(n){"use strict";function e(n){this.message=n}e.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},e.prototype.__CANCEL__=!0,n.exports=e},8466:function(n,e,t){"use strict";var o=t(2881);function i(n){if("function"!=typeof n)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(n){e=n}));var t=this;this.promise.then((function(n){if(t.A){var e,o=t.A.length;for(e=0;e<o;e++)t.A[e](n);t.A=null}})),this.promise.then=function(n){var e,o=new Promise((function(n){t.subscribe(n),e=n})).then(n);return o.cancel=function(){t.unsubscribe(e)},o},n((function(n){t.reason||(t.reason=new o(n),e(t.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.prototype.subscribe=function(n){this.reason?n(this.reason):this.A?this.A.push(n):this.A=[n]},i.prototype.unsubscribe=function(n){if(this.A){var e=this.A.indexOf(n);-1!==e&&this.A.splice(e,1)}},i.source=function(){var n;return{token:new i((function(e){n=e})),cancel:n}},n.exports=i},3824:function(n){"use strict";n.exports=function(n){return!(!n||!n.__CANCEL__)}},363:function(n,e,t){"use strict";var o=t(8899),i=t(4748),r=t(3148),u=t(2061),a=t(7416),s=t(3928),l=s.validators;function c(n){this.defaults=n,this.interceptors={request:new r,response:new r}}c.prototype.request=function(n,e){"string"==typeof n?(e=e||{}).url=n:e=n||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&s.assertOptions(t,{silentJSONParsing:l.transitional(l.boolean),forcedJSONParsing:l.transitional(l.boolean),clarifyTimeoutError:l.transitional(l.boolean)},!1);var o=[],i=!0;this.interceptors.request.forEach((function(n){"function"==typeof n.runWhen&&!1===n.runWhen(e)||(i=i&&n.synchronous,o.unshift(n.fulfilled,n.rejected))}));var r,c=[];if(this.interceptors.response.forEach((function(n){c.push(n.fulfilled,n.rejected)})),!i){var d=[u,void 0];for(Array.prototype.unshift.apply(d,o),d=d.concat(c),r=Promise.resolve(e);d.length;)r=r.then(d.shift(),d.shift());return r}for(var f=e;o.length;){var v=o.shift(),h=o.shift();try{f=v(f)}catch(n){h(n);break}}try{r=u(f)}catch(n){return Promise.reject(n)}for(;c.length;)r=r.then(c.shift(),c.shift());return r},c.prototype.getUri=function(n){return n=a(this.defaults,n),i(n.url,n.params,n.paramsSerializer).replace(/^\?/,"")},o.forEach(["delete","get","head","options"],(function(n){c.prototype[n]=function(e,t){return this.request(a(t||{},{method:n,url:e,data:(t||{}).data}))}})),o.forEach(["post","put","patch"],(function(n){c.prototype[n]=function(e,t,o){return this.request(a(o||{},{method:n,url:e,data:t}))}})),n.exports=c},3148:function(n,e,t){"use strict";var o=t(8899);function i(){this.handlers=[]}i.prototype.use=function(n,e,t){return this.handlers.push({fulfilled:n,rejected:e,synchronous:!!t&&t.synchronous,runWhen:t?t.runWhen:null}),this.handlers.length-1},i.prototype.eject=function(n){this.handlers[n]&&(this.handlers[n]=null)},i.prototype.forEach=function(n){o.forEach(this.handlers,(function(e){null!==e&&n(e)}))},n.exports=i},2762:function(n,e,t){"use strict";var o=t(4283),i=t(4451);n.exports=function(n,e){return n&&!o(e)?i(n,e):e}},7496:function(n,e,t){"use strict";var o=t(3729);n.exports=function(n,e,t,i,r){var u=new Error(n);return o(u,e,t,i,r)}},2061:function(n,e,t){"use strict";var o=t(8899),i=t(2214),r=t(3824),u=t(1584),a=t(2881);function s(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new a("canceled")}n.exports=function(n){return s(n),n.headers=n.headers||{},n.data=i.call(n,n.data,n.headers,n.transformRequest),n.headers=o.merge(n.headers.common||{},n.headers[n.method]||{},n.headers),o.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete n.headers[e]})),(n.adapter||u.adapter)(n).then((function(e){return s(n),e.data=i.call(n,e.data,e.headers,n.transformResponse),e}),(function(e){return r(e)||(s(n),e&&e.response&&(e.response.data=i.call(n,e.response.data,e.response.headers,n.transformResponse))),Promise.reject(e)}))}},3729:function(n){"use strict";n.exports=function(n,e,t,o,i){return n.config=e,t&&(n.code=t),n.request=o,n.response=i,n.isAxiosError=!0,n.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},n}},7416:function(n,e,t){"use strict";var o=t(8899);n.exports=function(n,e){e=e||{};var t={};function i(n,e){return o.isPlainObject(n)&&o.isPlainObject(e)?o.merge(n,e):o.isPlainObject(e)?o.merge({},e):o.isArray(e)?e.slice():e}function r(t){return o.isUndefined(e[t])?o.isUndefined(n[t])?void 0:i(void 0,n[t]):i(n[t],e[t])}function u(n){if(!o.isUndefined(e[n]))return i(void 0,e[n])}function a(t){return o.isUndefined(e[t])?o.isUndefined(n[t])?void 0:i(void 0,n[t]):i(void 0,e[t])}function s(t){return t in e?i(n[t],e[t]):t in n?i(void 0,n[t]):void 0}var l={url:u,method:u,data:u,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s};return o.forEach(Object.keys(n).concat(Object.keys(e)),(function(n){var e=l[n]||r,i=e(n);o.isUndefined(i)&&e!==s||(t[n]=i)})),t}},1083:function(n,e,t){"use strict";var o=t(7496);n.exports=function(n,e,t){var i=t.config.validateStatus;t.status&&i&&!i(t.status)?e(o("Request failed with status code "+t.status,t.config,null,t.request,t)):n(t)}},2214:function(n,e,t){"use strict";var o=t(8899),i=t(1584);n.exports=function(n,e,t){var r=this||i;return o.forEach(t,(function(t){n=t.call(r,n,e)})),n}},1584:function(n,e,t){"use strict";var o=t(8899),i=t(3527),r=t(3729),u=t(239),a={"Content-Type":"application/x-www-form-urlencoded"};function s(n,e){!o.isUndefined(n)&&o.isUndefined(n["Content-Type"])&&(n["Content-Type"]=e)}var l,c={transitional:u,adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(l=t(5999)),l),transformRequest:[function(n,e){return i(e,"Accept"),i(e,"Content-Type"),o.isFormData(n)||o.isArrayBuffer(n)||o.isBuffer(n)||o.isStream(n)||o.isFile(n)||o.isBlob(n)?n:o.isArrayBufferView(n)?n.buffer:o.isURLSearchParams(n)?(s(e,"application/x-www-form-urlencoded;charset=utf-8"),n.toString()):o.isObject(n)||e&&"application/json"===e["Content-Type"]?(s(e,"application/json"),function(n,e,t){if(o.isString(n))try{return(0,JSON.parse)(n),o.trim(n)}catch(n){if("SyntaxError"!==n.name)throw n}return(0,JSON.stringify)(n)}(n)):n}],transformResponse:[function(n){var e=this.transitional||c.transitional,t=e&&e.silentJSONParsing,i=e&&e.forcedJSONParsing,u=!t&&"json"===this.responseType;if(u||i&&o.isString(n)&&n.length)try{return JSON.parse(n)}catch(n){if(u){if("SyntaxError"===n.name)throw r(n,this,"E_JSON_PARSE");throw n}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};o.forEach(["delete","get","head"],(function(n){c.headers[n]={}})),o.forEach(["post","put","patch"],(function(n){c.headers[n]=o.merge(a)})),n.exports=c},239:function(n){"use strict";n.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},2655:function(n){n.exports={version:"0.26.1"}},1012:function(n){"use strict";n.exports=function(n,e){return function(){for(var t=new Array(arguments.length),o=0;o<t.length;o++)t[o]=arguments[o];return n.apply(e,t)}}},4748:function(n,e,t){"use strict";var o=t(8899);function i(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}n.exports=function(n,e,t){if(!e)return n;var r;if(t)r=t(e);else if(o.isURLSearchParams(e))r=e.toString();else{var u=[];o.forEach(e,(function(n,e){null!=n&&(o.isArray(n)?e+="[]":n=[n],o.forEach(n,(function(n){o.isDate(n)?n=n.toISOString():o.isObject(n)&&(n=JSON.stringify(n)),u.push(i(e)+"="+i(n))})))})),r=u.join("&")}if(r){var a=n.indexOf("#");-1!==a&&(n=n.slice(0,a)),n+=(-1===n.indexOf("?")?"?":"&")+r}return n}},4451:function(n){"use strict";n.exports=function(n,e){return e?n.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):n}},7589:function(n,e,t){"use strict";var o=t(8899);n.exports=o.isStandardBrowserEnv()?{write:function(n,e,t,i,r,u){var a=[];a.push(n+"="+encodeURIComponent(e)),o.isNumber(t)&&a.push("expires="+new Date(t).toGMTString()),o.isString(i)&&a.push("path="+i),o.isString(r)&&a.push("domain="+r),!0===u&&a.push("secure"),document.cookie=a.join("; ")},read:function(n){var e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(n){this.write(n,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},4283:function(n){"use strict";n.exports=function(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}},3608:function(n,e,t){"use strict";var o=t(8899);n.exports=function(n){return o.isObject(n)&&!0===n.isAxiosError}},683:function(n,e,t){"use strict";var o=t(8899);n.exports=o.isStandardBrowserEnv()?function(){var n,e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");function i(n){var o=n;return e&&(t.setAttribute("href",o),o=t.href),t.setAttribute("href",o),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return n=i(window.location.href),function(e){var t=o.isString(e)?i(e):e;return t.protocol===n.protocol&&t.host===n.host}}():function(){return!0}},3527:function(n,e,t){"use strict";var o=t(8899);n.exports=function(n,e){o.forEach(n,(function(t,o){o!==e&&o.toUpperCase()===e.toUpperCase()&&(n[e]=t,delete n[o])}))}},3903:function(n,e,t){"use strict";var o=t(8899),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];n.exports=function(n){var e,t,r,u={};return n?(o.forEach(n.split("\n"),(function(n){if(r=n.indexOf(":"),e=o.trim(n.substr(0,r)).toLowerCase(),t=o.trim(n.substr(r+1)),e){if(u[e]&&i.indexOf(e)>=0)return;u[e]="set-cookie"===e?(u[e]?u[e]:[]).concat([t]):u[e]?u[e]+", "+t:t}})),u):u}},7447:function(n){"use strict";n.exports=function(n){return function(e){return n.apply(null,e)}}},3928:function(n,e,t){"use strict";var o=t(2655).version,i={};["object","boolean","number","function","string","symbol"].forEach((function(n,e){i[n]=function(t){return typeof t===n||"a"+(e<1?"n ":" ")+n}}));var r={};i.transitional=function(n,e,t){return function(i,u,a){if(!1===n)throw new Error(function(n,e){return"[Axios v"+o+"] Transitional option '"+n+"'"+e+(t?". "+t:"")}(u," has been removed"+(e?" in "+e:"")));return e&&!r[u]&&(r[u]=!0),!n||n(i,u,a)}},n.exports={assertOptions:function(n,e,t){if("object"!=typeof n)throw new TypeError("options must be an object");for(var o=Object.keys(n),i=o.length;i-- >0;){var r=o[i],u=e[r];if(u){var a=n[r],s=void 0===a||u(a,r,n);if(!0!==s)throw new TypeError("option "+r+" must be "+s)}else if(!0!==t)throw Error("Unknown option "+r)}},validators:i}},8899:function(n,e,t){"use strict";var o=t(1012),i=Object.prototype.toString;function r(n){return Array.isArray(n)}function u(n){return void 0===n}function a(n){return"[object ArrayBuffer]"===i.call(n)}function s(n){return null!==n&&"object"==typeof n}function l(n){if("[object Object]"!==i.call(n))return!1;var e=Object.getPrototypeOf(n);return null===e||e===Object.prototype}function c(n){return"[object Function]"===i.call(n)}function d(n,e){if(null!=n)if("object"!=typeof n&&(n=[n]),r(n))for(var t=0,o=n.length;t<o;t++)e.call(null,n[t],t,n);else for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.call(null,n[i],i,n)}n.exports={isArray:r,isArrayBuffer:a,isBuffer:function(n){return null!==n&&!u(n)&&null!==n.constructor&&!u(n.constructor)&&"function"==typeof n.constructor.isBuffer&&n.constructor.isBuffer(n)},isFormData:function(n){return"[object FormData]"===i.call(n)},isArrayBufferView:function(n){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(n):n&&n.buffer&&a(n.buffer)},isString:function(n){return"string"==typeof n},isNumber:function(n){return"number"==typeof n},isObject:s,isPlainObject:l,isUndefined:u,isDate:function(n){return"[object Date]"===i.call(n)},isFile:function(n){return"[object File]"===i.call(n)},isBlob:function(n){return"[object Blob]"===i.call(n)},isFunction:c,isStream:function(n){return s(n)&&c(n.pipe)},isURLSearchParams:function(n){return"[object URLSearchParams]"===i.call(n)},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:d,merge:function n(){var e={};function t(t,o){l(e[o])&&l(t)?e[o]=n(e[o],t):l(t)?e[o]=n({},t):r(t)?e[o]=t.slice():e[o]=t}for(var o=0,i=arguments.length;o<i;o++)d(arguments[o],t);return e},extend:function(n,e,t){return d(e,(function(e,i){n[i]=t&&"function"==typeof e?o(e,t):e})),n},trim:function(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")},stripBOM:function(n){return 65279===n.charCodeAt(0)&&(n=n.slice(1)),n}}},9697:function(n,e,t){"use strict";t.d(e,{X:function(){return u}});var o=t(6578),i=t(5089),r=t(9990),u=function(n){function e(e){var t=n.call(this)||this;return t.H=e,t}return o.ZT(e,n),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype.F=function(e){var t=n.prototype.F.call(this,e);return t&&!t.closed&&e.next(this.H),t},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new r.N;return this.H},e.prototype.next=function(e){n.prototype.next.call(this,this.H=e)},e}(i.xQ)},1917:function(n,e,t){"use strict";t.d(e,{y:function(){return l}});var o=t(1448),i=t(7229),r=t(7026),u=t(3754);function a(n){return n}var s=t(7829),l=function(){function n(n){this.P=!1,n&&(this.F=n)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(n,e,t){var u=this.operator,a=function(n,e,t){if(n){if(n instanceof o.L)return n;if(n[i.b])return n[i.b]()}return n||e||t?new o.L(n,e,t):new o.L(r.c)}(n,e,t);if(u?a.add(u.call(a,this.source)):a.add(this.source||s.v.useDeprecatedSynchronousErrorHandling&&!a.syncErrorThrowable?this.F(a):this._(a)),s.v.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable&&(a.syncErrorThrowable=!1,a.syncErrorThrown))throw a.syncErrorValue;return a},n.prototype._=function(n){try{return this.F(n)}catch(e){s.v.useDeprecatedSynchronousErrorHandling&&(n.syncErrorThrown=!0,n.syncErrorValue=e),function(n){for(;n;){var e=n,t=e.closed,i=e.destination,r=e.isStopped;if(t||r)return!1;n=i&&i instanceof o.L?i:null}return!0}(n)&&n.error(e)}},n.prototype.forEach=function(n,e){var t=this;return new(e=c(e))((function(e,o){var i;i=t.subscribe((function(e){try{n(e)}catch(n){o(n),i&&i.unsubscribe()}}),o,e)}))},n.prototype.F=function(n){var e=this.source;return e&&e.subscribe(n)},n.prototype[u.L]=function(){return this},n.prototype.pipe=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return 0===n.length?this:(0===(t=n).length?a:1===t.length?t[0]:function(n){return t.reduce((function(n,e){return e(n)}),n)})(this);var t},n.prototype.toPromise=function(n){var e=this;return new(n=c(n))((function(n,t){var o;e.subscribe((function(n){return o=n}),(function(n){return t(n)}),(function(){return n(o)}))}))},n.create=function(e){return new n(e)},n}();function c(n){if(n||(n=s.v.Promise||Promise),!n)throw new Error("no Promise impl found");return n}},7026:function(n,e,t){"use strict";t.d(e,{c:function(){return r}});var o=t(7829),i=t(6387),r={closed:!0,next:function(n){},error:function(n){if(o.v.useDeprecatedSynchronousErrorHandling)throw n;(0,i.z)(n)},complete:function(){}}},5089:function(n,e,t){"use strict";t.d(e,{xQ:function(){return d}});var o=t(6578),i=t(1917),r=t(1448),u=t(4461),a=t(9990),s=function(n){function e(e,t){var o=n.call(this)||this;return o.subject=e,o.subscriber=t,o.closed=!1,o}return o.ZT(e,n),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var n=this.subject,e=n.observers;if(this.subject=null,e&&0!==e.length&&!n.isStopped&&!n.closed){var t=e.indexOf(this.subscriber);-1!==t&&e.splice(t,1)}}},e}(u.w),l=t(7229),c=function(n){function e(e){var t=n.call(this,e)||this;return t.destination=e,t}return o.ZT(e,n),e}(r.L),d=function(n){function e(){var e=n.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return o.ZT(e,n),e.prototype[l.b]=function(){return new c(this)},e.prototype.lift=function(n){var e=new f(this,this);return e.operator=n,e},e.prototype.next=function(n){if(this.closed)throw new a.N;if(!this.isStopped)for(var e=this.observers,t=e.length,o=e.slice(),i=0;i<t;i++)o[i].next(n)},e.prototype.error=function(n){if(this.closed)throw new a.N;this.hasError=!0,this.thrownError=n,this.isStopped=!0;for(var e=this.observers,t=e.length,o=e.slice(),i=0;i<t;i++)o[i].error(n);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new a.N;this.isStopped=!0;for(var n=this.observers,e=n.length,t=n.slice(),o=0;o<e;o++)t[o].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._=function(e){if(this.closed)throw new a.N;return n.prototype._.call(this,e)},e.prototype.F=function(n){if(this.closed)throw new a.N;return this.hasError?(n.error(this.thrownError),u.w.EMPTY):this.isStopped?(n.complete(),u.w.EMPTY):(this.observers.push(n),new s(this,n))},e.prototype.asObservable=function(){var n=new i.y;return n.source=this,n},e.create=function(n,e){return new f(n,e)},e}(i.y),f=function(n){function e(e,t){var o=n.call(this)||this;return o.destination=e,o.source=t,o}return o.ZT(e,n),e.prototype.next=function(n){var e=this.destination;e&&e.next&&e.next(n)},e.prototype.error=function(n){var e=this.destination;e&&e.error&&this.destination.error(n)},e.prototype.complete=function(){var n=this.destination;n&&n.complete&&this.destination.complete()},e.prototype.F=function(n){return this.source?this.source.subscribe(n):u.w.EMPTY},e}(d)},1448:function(n,e,t){"use strict";t.d(e,{L:function(){return c}});var o=t(6578),i=t(4319),r=t(7026),u=t(4461),a=t(7229),s=t(7829),l=t(6387),c=function(n){function e(t,o,i){var u=n.call(this)||this;switch(u.syncErrorValue=null,u.syncErrorThrown=!1,u.syncErrorThrowable=!1,u.isStopped=!1,arguments.length){case 0:u.destination=r.c;break;case 1:if(!t){u.destination=r.c;break}if("object"==typeof t){t instanceof e?(u.syncErrorThrowable=t.syncErrorThrowable,u.destination=t,t.add(u)):(u.syncErrorThrowable=!0,u.destination=new d(u,t));break}default:u.syncErrorThrowable=!0,u.destination=new d(u,t,o,i)}return u}return o.ZT(e,n),e.prototype[a.b]=function(){return this},e.create=function(n,t,o){var i=new e(n,t,o);return i.syncErrorThrowable=!1,i},e.prototype.next=function(n){this.isStopped||this.B(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this.Y(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this.$())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this))},e.prototype.B=function(n){this.destination.next(n)},e.prototype.Y=function(n){this.destination.error(n),this.unsubscribe()},e.prototype.$=function(){this.destination.complete(),this.unsubscribe()},e.prototype.nn=function(){var n=this.en;return this.en=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this.en=n,this},e}(u.w),d=function(n){function e(e,t,o,u){var a,s=n.call(this)||this;s.tn=e;var l=s;return(0,i.m)(t)?a=t:t&&(a=t.next,o=t.error,u=t.complete,t!==r.c&&(l=Object.create(t),(0,i.m)(l.unsubscribe)&&s.add(l.unsubscribe.bind(l)),l.unsubscribe=s.unsubscribe.bind(s))),s.rn=l,s.B=a,s.Y=o,s.$=u,s}return o.ZT(e,n),e.prototype.next=function(n){if(!this.isStopped&&this.B){var e=this.tn;s.v.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this.B,n)&&this.unsubscribe():this.__tryOrUnsub(this.B,n)}},e.prototype.error=function(n){if(!this.isStopped){var e=this.tn,t=s.v.useDeprecatedSynchronousErrorHandling;if(this.Y)t&&e.syncErrorThrowable?(this.__tryOrSetError(e,this.Y,n),this.unsubscribe()):(this.__tryOrUnsub(this.Y,n),this.unsubscribe());else if(e.syncErrorThrowable)t?(e.syncErrorValue=n,e.syncErrorThrown=!0):(0,l.z)(n),this.unsubscribe();else{if(this.unsubscribe(),t)throw n;(0,l.z)(n)}}},e.prototype.complete=function(){var n=this;if(!this.isStopped){var e=this.tn;if(this.$){var t=function(){return n.$.call(n.rn)};s.v.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(n,e){try{n.call(this.rn,e)}catch(n){if(this.unsubscribe(),s.v.useDeprecatedSynchronousErrorHandling)throw n;(0,l.z)(n)}},e.prototype.__tryOrSetError=function(n,e,t){if(!s.v.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this.rn,t)}catch(e){return s.v.useDeprecatedSynchronousErrorHandling?(n.syncErrorValue=e,n.syncErrorThrown=!0,!0):((0,l.z)(e),!0)}return!1},e.prototype.un=function(){var n=this.tn;this.rn=null,this.tn=null,n.unsubscribe()},e}(c)},4461:function(n,e,t){"use strict";t.d(e,{w:function(){return a}});var o=t(6464),i=t(6519),r=t(4319),u=function(){function n(n){return Error.call(this),this.message=n?n.length+" errors occurred during unsubscription:\n"+n.map((function(n,e){return e+1+") "+n.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=n,this}return n.prototype=Object.create(Error.prototype),n}(),a=function(){function n(n){this.closed=!1,this.en=null,this.an=null,n&&(this.sn=!0,this.un=n)}var e;return n.prototype.unsubscribe=function(){var e;if(!this.closed){var t=this,a=t.en,l=t.sn,c=t.un,d=t.an;if(this.closed=!0,this.en=null,this.an=null,a instanceof n)a.remove(this);else if(null!==a)for(var f=0;f<a.length;++f)a[f].remove(this);if((0,r.m)(c)){l&&(this.un=void 0);try{c.call(this)}catch(n){e=n instanceof u?s(n.errors):[n]}}if((0,o.k)(d)){f=-1;for(var v=d.length;++f<v;){var h=d[f];if((0,i.K)(h))try{h.unsubscribe()}catch(n){e=e||[],n instanceof u?e=e.concat(s(n.errors)):e.push(n)}}}if(e)throw new u(e)}},n.prototype.add=function(e){var t=e;if(!e)return n.EMPTY;switch(typeof e){case"function":t=new n(e);case"object":if(t===this||t.closed||"function"!=typeof t.unsubscribe)return t;if(this.closed)return t.unsubscribe(),t;if(!(t instanceof n)){var o=t;(t=new n).an=[o]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var i=t.en;if(null===i)t.en=this;else if(i instanceof n){if(i===this)return t;t.en=[i,this]}else{if(-1!==i.indexOf(this))return t;i.push(this)}var r=this.an;return null===r?this.an=[t]:r.push(t),t},n.prototype.remove=function(n){var e=this.an;if(e){var t=e.indexOf(n);-1!==t&&e.splice(t,1)}},n.EMPTY=((e=new n).closed=!0,e),n}();function s(n){return n.reduce((function(n,e){return n.concat(e instanceof u?e.errors:e)}),[])}},7829:function(n,e,t){"use strict";t.d(e,{v:function(){return i}});var o=!1,i={Promise:void 0,set useDeprecatedSynchronousErrorHandling(n){o=n},get useDeprecatedSynchronousErrorHandling(){return o}}},3754:function(n,e,t){"use strict";t.d(e,{L:function(){return o}});var o=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}()},7229:function(n,e,t){"use strict";t.d(e,{b:function(){return o}});var o=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}()},9990:function(n,e,t){"use strict";t.d(e,{N:function(){return o}});var o=function(){function n(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return n.prototype=Object.create(Error.prototype),n}()},6387:function(n,e,t){"use strict";function o(n){setTimeout((function(){throw n}),0)}t.d(e,{z:function(){return o}})},6464:function(n,e,t){"use strict";t.d(e,{k:function(){return o}});var o=function(){return Array.isArray||function(n){return n&&"number"==typeof n.length}}()},4319:function(n,e,t){"use strict";function o(n){return"function"==typeof n}t.d(e,{m:function(){return o}})},6519:function(n,e,t){"use strict";function o(n){return null!==n&&"object"==typeof n}t.d(e,{K:function(){return o}})},6578:function(n,e,t){"use strict";t.d(e,{ZT:function(){return i}});var o=function(n,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t])},o(n,e)};function i(n,e){function t(){this.constructor=n}o(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}},533:function(n,e,t){"use strict";t.d(e,{CR:function(){return a},Jh:function(){return r},XA:function(){return u},ev:function(){return s},mG:function(){return i},pi:function(){return o}});var o=function(){return o=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n},o.apply(this,arguments)};function i(n,e,t,o){return new(t||(t=Promise))((function(i,r){function u(n){try{s(o.next(n))}catch(n){r(n)}}function a(n){try{s(o.throw(n))}catch(n){r(n)}}function s(n){var e;n.done?i(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(u,a)}s((o=o.apply(n,e||[])).next())}))}function r(n,e){var t,o,i,r,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(s){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(u=0)),u;)try{if(t=1,o&&(i=2&a[0]?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return u.label++,{value:a[1],done:!1};case 5:u.label++,o=a[1],a=[0];continue;case 7:a=u.ops.pop(),u.trys.pop();continue;default:if(!((i=(i=u.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){u=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){u.label=a[1];break}if(6===a[0]&&u.label<i[1]){u.label=i[1],i=a;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(a);break}i[2]&&u.ops.pop(),u.trys.pop();continue}a=e.call(n,u)}catch(n){a=[6,n],o=0}finally{t=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function u(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],o=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&o>=n.length&&(n=void 0),{value:n&&n[o++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function a(n,e){var t="function"==typeof Symbol&&n[Symbol.iterator];if(!t)return n;var o,i,r=t.call(n),u=[];try{for(;(void 0===e||e-- >0)&&!(o=r.next()).done;)u.push(o.value)}catch(n){i={error:n}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(i)throw i.error}}return u}function s(n,e,t){if(t||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||(o||(o=Array.prototype.slice.call(e,0,i)),o[i]=e[i]);return n.concat(o||Array.prototype.slice.call(e))}Object.create,Object.create},5358:function(n,e,t){"use strict";var o;t.d(e,{O:function(){return o}}),function(n){n.blurFocus="blurFocus",n.boot="boot",n.completeCreateNew="completeCreateNew",n.continueAccessibilityLoop="continueAccessibilityLoop",n.createNew="createNew",n.dispose="dispose",n.grabFocus="grabFocus",n.moveToFolder="moveToFolder",n.popState="popState",n.sendChannelId="sendChannelId",n.sendConvId="sendConvId",n.teamsUsersReply="teamsUsersReply",n.teamsUserMentionReply="teamsUserMentionReply",n.backButtonPressed="backButtonPressed",n.getClientUrl="getClientUrl",n.getWebUrl="getWebUrl",n.sendOwlFrameDiagnostics="sendOwlFrameDiagnostics",n.rename="rename",n.completeSharedFilePicker="completeSharedFilePicker",n.sendAccessToken="sendAccessToken",n.sendAuthToken="sendAuthToken",n.sendCustomAuthConfig="sendCustomAuthConfig",n.sendEmbeddedViewUrl="sendEmbeddedViewUrl",n.sendFrameTrustResult="sendFrameTrustResult",n.sendHWRTelemetry="sendHWRTelemetry",n.sendSessionInfo="sendSessionInfo",n.sendUserAccessAndPermissions="sendUserAccessAndPermissions",n.sendWopiInfo="sendWopiInfo",n.sendDavUrl="sendDavUrl",n.switchMode="switchMode",n.signalShared="signalShared",n.postWacToken="postWacToken"}(o||(o={}))},2818:function(n,e,t){"use strict";var o;t.d(e,{L8:function(){return d}}),function(n){n[n.Trace=0]="Trace",n[n.Assert=1]="Assert"}(o||(o={}));var i,r,u=t(8643),a=t(9829),s=function(){function n(n){var e=this;this.ln=3e4,this.cn=30,this.dn=0,this.fn=[],this.vn=(0,a.Ks)(),this.hn=[],this.pn="",this.mn=0,this.flushOnClose=function(){e.wn(!1,!1)},this.flush=function(){e.gn()},this.flushAndSetNewEndpoint=function(n,t){var o,i=e.Sn(n);i.localeCompare(null!==(o=e.bn)&&void 0!==o?o:"",void 0,{sensitivity:"accent"})&&(e.hn.push((function(){e.bn=i,t&&t()})),e.wn(!0,!0))},this.Sn=function(n){return n+"?usid="+e.pn+"&officeserverversion="+function(){try{return __VERSION_PLACEHOLDER__}catch(n){return"###VERSION###"}}()},this.gn=function(){window.setTimeout((function(){return e.wn(!0,!0)}),0)},this.wn=function(n,t){var o,i,r,u,s,l,c,d=(0,a.u3)();window.clearTimeout(e.In),e.bn&&(e.fn.length>0&&(e.dn+=1,function(n,e,t){if(e){var o=window.navigator;if(o&&o.sendBeacon)try{return void o.sendBeacon(e,n)}catch(n){}!function(n,e,t){var o=new XMLHttpRequest;o.readyState!==XMLHttpRequest.UNSENT&&o.readyState!==XMLHttpRequest.DONE||(o.open("POST",e,t),o.send(n))}(n,e,t)}}((o=e.fn.splice(0,n?e.cn:e.fn.length),i=e.pn,r=e.dn,u=e.vn,s=[],l=o.map((function(n){return function(n,e,t){var o={};if(o.G=n.tag,o.T=n.timestamp-e,o.M=n.message,o.C=n.category,n.correlationId){var i=t.findIndex((function(e){return e===n.correlationId}));i<0&&(i=t.push(n.correlationId)-1),o.I=i}var r=1e3*n.type+n.level;return o.D=r,o}(n,u,s)})),c=function(n,e,t,o,i){var r={};return r.T=n,r.L=e,r.S=t,r.I=o,i&&i.length>0&&(r.W=i),r.V=1,r}(u,l,i,r,s),JSON.stringify(c)),e.bn,t),e.vn=(0,a.Ks)()),0===e.fn.length&&e.hn.length>0&&(e.hn.forEach((function(n){"requestIdleCallback"in window?window.requestIdleCallback(n):window.setTimeout(n,0)})),e.hn=[]),n&&(e.In=window.setTimeout((function(){e.gn()}),e.fn.length>e.cn||e.hn.length>0?1e3:e.ln)),e.mn+=(0,a.u3)()-d)},n&&this.configure(n)}return n.prototype.getTimeSpentLogging=function(){return this.mn},n.prototype.addLoggingTime=function(n){this.mn+=n},n.prototype.configure=function(n){var e=this,t=(0,a.u3)();if(n.uploadCadenceInMs&&(this.ln=n.uploadCadenceInMs),n.uploadTriggerSize&&(this.cn=n.uploadTriggerSize),n.sessionId&&(this.pn=n.sessionId),n.remoteUlsEndpoint){if(!n.sessionId&&this.bn)throw new Error("Remote ULS endpoint is already set");this.bn=this.Sn(n.remoteUlsEndpoint),this.vn=(0,a.Ks)(),window.setTimeout((function(){return e.wn(!0,!0)}),0)}this.mn+=(0,a.u3)()-t},n.prototype.handleTrace=function(n){var e=(0,a.u3)();n.message.length>3072&&(n.message=n.message.substring(0,3059)+"... [Trimmed]"),this.fn.push(n),(this.fn.length>this.cn||n.level===u.G.Error)&&this.gn(),this.mn+=(0,a.u3)()-e},n.prototype.getUserSessionId=function(){return this.pn},n}(),l=[];!function(n){n.Cn="BootstrapperMaxUlsHeartbeatTime",n.An="BootstrapperNoCompleteWarning1Time",n.Tn="BootstrapperNoCompleteWarning2Time",n.yn="RemoteUlsETag",n.Hn="RemoteUlsSuppressions",n.Un="BootstrapperSettingsFetchPeriod",n.En="timestamp",n.kn="BootstrapperUlsHeartbeatIntervalMs",n.Rn="BootstrapperUlsHeartBeatIsEnabled",n.Fn="BootstrapperUlsUploadCadenceMs",n.Pn="WordConsumptionViewToEditRedirectIsEnabled",n.Nn="RequestedCallThrottlingDefaultToViewMinimumValue",n.On="BulsEndpointUrl",n.Dn="EnableCommonHostDiagnosticsParams",n._n="EnableICNForWord",n.Wn="EnableModernEmbedViewForPowerPoint",n.xn="EnableModernReadingViewForPowerPoint",n.Mn="EnableDefaultToModernForPowerPoint",n.jn="ShouldLogJsApiKpisForWord",n.Gn="EnableFramePageErrorReportingForWord",n.Ln="WordSwitchToViewInTeamsJsapiV1Enabled"}(r||(r={}));var c=6e4;function d(n){var e=new s(n);function t(n,t,i,r){var u=(0,a.u3)();if(!function(n){return 1===l[n]}(n)){var s={timestamp:(0,a.Ks)(),category:t,tag:n,level:i,type:o.Trace,message:r,correlationId:""};e.addLoggingTime((0,a.u3)()-u),e.handleTrace(s)}}return{ULS:{sendTraceTag:function(n,e,o,i){t(n,e,o,i)},shipAssertTag:function(n,e,o,i){o&&t(n,e,u.G.Error,i)},debugAssertTag:function(n,e,t,o){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:e.flush,flushOnClose:e.flushOnClose,setCorrelationId:function(){}},configure:function(n){e.configure(n)},settingsChangeHandler:function(n){var t,o;t=n.Vn.getValue(r.Hn,""),o=n.Vn.getValue(r.yn,""),i&&o===i||(l=[],i=o,t&&t.split(",").forEach((function(n){var e=parseInt(n,10);e&&(l[e]=1)}))),e.configure({uploadCadenceInMs:n.Vn.getValue(r.Fn,c)});var u=n.Vn.getValue(r.On,"").toString();""!==u&&e.flushAndSetNewEndpoint(u)},getTimeSpentLogging:function(){return e.getTimeSpentLogging()},getUserSessionId:function(){return e.getUserSessionId()},flushAndSetNewEndpoint:function(n,t){e.flushAndSetNewEndpoint(n,t)}}}},4730:function(n,e,t){"use strict";t.d(e,{n:function(){return u}});var o=t(533);function i(n){if(!n)return"";var e=Object.getOwnPropertyNames(n),t=Object.getOwnPropertyNames(Object.getPrototypeOf(n));return JSON.stringify(n,(0,o.ev)((0,o.ev)([],e,!0),t,!0))}var r=t(9829);function u(){var n=new Uint8Array(31),e=function(n){var e={crypto:!1,perfNow:!1,exceptions:[]},t=window.crypto||window.msCrypto;if(t){e.crypto=!0;try{return t.getRandomValues(n),e}catch(n){e.exceptions.push("crypto: ".concat(i(n)))}}e.perfNow=r.Xm;for(var o=0;o<n.length;o+=1){try{if(r.Xm){var u=Math.floor(100*window.performance.now())%10;(u<0||u>9)&&(u=0);for(var a=0;a<u;a+=1)Math.random()}}catch(n){e.exceptions.push("Math.random: ".concat(i(n)))}n[o]=Math.floor(16*Math.random())}return e}(n),t=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var o=15&n[t];return t+=1,("x"===e?o:3&o|8).toString(16)})),e]}},9829:function(n,e,t){"use strict";t.d(e,{Ks:function(){return u},Xm:function(){return i},u3:function(){return r}});var o,i=function(){try{var n=window.performance;return n&&n.now&&n.now()!==1/0}catch(n){return!1}}();function r(){return i?window.performance.now():Date.now()}function u(){if(!o){var n=window.performance;o=i&&n.timing&&n.timing.navigationStart?function(){return Math.round(n.now()+n.timing.navigationStart)}:Date.now?Date.now:function(){return(new Date).getTime()}}return o()}},7430:function(n,e,t){"use strict";t.d(e,{o:function(){return o}});var o,i=t(8404),r=t(533),u=function(){function n(){this.blockedEvents=new Map,this.eventHitCounts=new Map,this.eventDurations=new Map,this.eventDurationsTotal=new Map}return n.prototype.isEventBlocked=function(n){var e=this.blockedEvents.get(n);return!!e&&(Date.now()>=e?(this.unblockEvent(n),!1):(this.aggregateEventCount(n),!0))},n.prototype.blockEvent=function(n,e){var t=Date.now()+e;this.blockedEvents.set(n,t),this.updateEventHitCount(n,0),this.eventDurations.delete(n),this.eventDurationsTotal.delete(n)},n.prototype.unblockEvent=function(n){this.blockedEvents.delete(n)},n.prototype.getEventHitCount=function(n){return this.eventHitCounts.get(n)},n.prototype.updateEventHitCount=function(n,e){this.eventHitCounts.set(n,e)},n.prototype.aggregateEventCount=function(n){var e=this.getEventHitCount(n);"number"==typeof e&&this.updateEventHitCount(n,++e)},n.prototype.getEventDurations=function(n){return this.eventDurations.get(n)},n.prototype.aggregateEventDuration=function(n,e){var t,o=(null!==(t=this.getEventHitCount(n))&&void 0!==t?t:0)+1,i=this.eventDurationsTotal.get(n),u=this.eventDurations.get(n);if(void 0!==u){var a=(0,r.ev)([],u,!0);u[0]>e&&(a[0]=e),u[1]<e&&(a[1]=e);var s=void 0;void 0!==i&&i.length<10?(i.push(e),s=i.reduce((function(n,e){return n+e}),0)/o):(s=u[2]+(e-u[2])/o,this.eventDurationsTotal.delete(n)),a[2]=s,this.eventDurations.set(n,a)}else this.eventDurations.set(n,[e,e,e]),this.eventDurationsTotal.set(n,[e])},n}(),a=function(){function n(n,e,t,o,i){this.healthLogger=n,this.featureConfig=e,this.kpiUsageEventBlocker=t,this.kpiFailureEventBlocker=o,this.kpiSuccessEventBlocker=i}return n.prototype.logKpiUsage=function(e,t,o,i){var r=this.getKpiKey(e+n.USAGE_KPI,null==o?void 0:o.extendedProperties);if(this.kpiUsageEventBlocker.isEventBlocked(r))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(o),this.recordKpiUsage(e,t,o,r),0!==i){var u=null!=i?i:3e5;this.kpiUsageEventBlocker.blockEvent(r,u)}return!0},n.prototype.logKpiFailure=function(e,t,o,i,r){var u,a,s,l=this.getKpiKey(e+n.FAILURE_KPI+t,null===(u=null==o?void 0:o.additionalValues)||void 0===u?void 0:u.extendedProperties);if("number"==typeof(null===(a=null==o?void 0:o.additionalValues)||void 0===a?void 0:a.durationMs)&&this.kpiFailureEventBlocker.aggregateEventDuration(l,o.additionalValues.durationMs),this.kpiFailureEventBlocker.isEventBlocked(l))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(),this.recordKpiFailure(e,t,o,l),i&&this.recordQosError(null!==(s=i.errorNameOverride)&&void 0!==s?s:t,i.name,i),0!==r){var c=null!=r?r:3e5;this.kpiFailureEventBlocker.blockEvent(l,c)}return!0},n.prototype.logKpiSuccess=function(e,t,o){var i,r,u=this.getKpiKey(e+n.SUCCESS_KPI,null===(i=null==t?void 0:t.additionalValues)||void 0===i?void 0:i.extendedProperties);if("number"==typeof(null===(r=null==t?void 0:t.additionalValues)||void 0===r?void 0:r.durationMs)&&this.kpiSuccessEventBlocker.aggregateEventDuration(u,t.additionalValues.durationMs),this.kpiSuccessEventBlocker.isEventBlocked(u))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(),this.recordKpiSuccess(e,t,u),0!==o){var a=null!=o?o:3e5;this.kpiSuccessEventBlocker.blockEvent(u,a)}return!0},n.prototype.ensureFeatureDenominatorLoggedAndVetoPillarRegistered=function(e){var t,i=this.featureConfig.topLevelKpiName,r=this.getKpiKey(this.featureConfig.topLevelKpiName,null==e?void 0:e.extendedProperties);if(!this.kpiUsageEventBlocker.isEventBlocked(null!=r?r:"")){this.recordKpiUsage(i,o.FailureBased,e);var u=null!==(t=this.featureConfig.vetoPillar)&&void 0!==t?t:this.featureConfig.areaName;u&&n.QOS_PILLARS_LIST.includes(u)&&this.healthLogger.addQosPillar(u),this.kpiUsageEventBlocker.blockEvent(null!=r?r:"",864e5)}},n.prototype.recordKpiUsage=function(n,e,t,o){var i;void 0===t&&(t={});var r=(i=t||{}).extendedProperties,u=i.isForAlertableKpi,a=this.createExtendedPropertiesWithMoreFields(r,o);u?this.healthLogger.recordKpiUsageForAlertableKpi(n,this.featureConfig.crewAlias,a):this.healthLogger.recordKpiUsage(n,e,this.featureConfig.crewAlias,a)},n.prototype.getKpiKey=function(n,e){var t=this.getKpiAreaName(e),o=this.getKpiFeatureName(e),i=this.getKpiPivot(e);return"".concat(t,".").concat(o,".").concat(null!=n?n:"").concat(i&&0===i.length?"."+i:"")},n.prototype.getKpiAreaName=function(e){var t,o,i;return null!==(i=null!==(o=null!==(t=null==e?void 0:e.get(n.AREA_NAME_COLUMN_KEY))&&void 0!==t?t:this.featureConfig.areaName)&&void 0!==o?o:this.featureConfig.vetoPillar)&&void 0!==i?i:""},n.prototype.getKpiFeatureName=function(e){var t,o;return null!==(o=null!==(t=null==e?void 0:e.get(n.FEATURE_NAME_COLUMN_KEY))&&void 0!==t?t:this.featureConfig.featureName)&&void 0!==o?o:""},n.prototype.getKpiPivot=function(e){var t=null==e?void 0:e.get(n.PIVOT_TYPE_COLUMN_KEY),o=null==e?void 0:e.get(n.PIVOT_VALUE_COLUMN_KEY);return t&&0!==t.length&&o&&0!==o.length?"".concat(t,"=").concat(o):""},n.prototype.recordKpiFailure=function(n,e,t,o){var i;void 0===t&&(t={});var r=(i=t||{}).isIntentional,u=i.isInternal,a=i.additionalValues,s=i.hasImpliedUsage,l=this.createAdditionalValuesWithMoreFields(a,o);!1===s?this.healthLogger.recordKpiFailure(n,e,r,u,l):this.healthLogger.recordKpiImpliedFailure(n,e,r,u,this.featureConfig.crewAlias,l)},n.prototype.recordKpiSuccess=function(n,e,t){var o;void 0===e&&(e={});var i=(o=e||{}).additionalValues,r=o.hasImpliedUsage,u=this.createAdditionalValuesWithMoreFields(i,t);!1===r?this.healthLogger.recordKpiSuccess(n,u):this.healthLogger.recordKpiImpliedSuccess(n,this.featureConfig.crewAlias,u)},n.prototype.recordQosError=function(n,e,t){void 0===t&&(t={});var o=t.isIntentional,i=t.isInternal,r=t.alertOnPillar,u=t.isSessionEndingError,a=t.additionalValues,s=this.createAdditionalValuesWithMoreFields(a);this.healthLogger.recordQosError(n,[e],o,i,r,u,s)},n.prototype.createExtendedPropertiesWithMoreFields=function(e,t){var o=new Map(e||new Map);if(o.get(n.FEATURE_NAME_COLUMN_KEY)||o.set(n.FEATURE_NAME_COLUMN_KEY,this.getKpiFeatureName(e)),o.set(n.AREA_NAME_COLUMN_KEY,this.getKpiAreaName(o)),o.has(n.SKIP_ARIA_COLUMN_KEY)||o.has("skipAria")||o.set(n.SKIP_ARIA_COLUMN_KEY,"true"),!this.featureConfig.doNotEmitAggregatedCount&&t){var i=this.getEventBlocker(t);if(i){var r=i.getEventHitCount(t);if(r){o.set(n.AGGREGATED_COUNT_COLUMN_KEY,r.toString());var u=i.getEventDurations(t);r>1&&u&&o.set(n.AGGREGATED_DURATION_COLUMN_KEY,u.map((function(n){return Math.round(100*n)/100})).toString())}}}return o},n.prototype.createAdditionalValuesWithMoreFields=function(n,e){var t={};return(t=(0,r.pi)({},n)).extendedProperties=this.createExtendedPropertiesWithMoreFields(null==n?void 0:n.extendedProperties,e),t},n.prototype.getEventBlocker=function(e){return e.endsWith(n.USAGE_KPI)?this.kpiUsageEventBlocker:e.includes(n.FAILURE_KPI)?this.kpiFailureEventBlocker:e.endsWith(n.SUCCESS_KPI)?this.kpiSuccessEventBlocker:void 0},n.FEATURE_NAME_COLUMN_KEY="FeatureName",n.AREA_NAME_COLUMN_KEY="AreaName",n.AGGREGATED_COUNT_COLUMN_KEY="AggCount",n.AGGREGATED_DURATION_COLUMN_KEY="AggMs",n.SKIP_ARIA_COLUMN_KEY="SkipAria",n.PIVOT_TYPE_COLUMN_KEY="PivotType",n.PIVOT_VALUE_COLUMN_KEY="PivotValue",n.QOS_PILLARS_LIST=["Interruptions","Open","NotebookNavigation","Fidelity","AsyncCollab","Present","ContentConsumption","bSqmCompatibility","Boot"],n.USAGE_KPI=".Usage",n.SUCCESS_KPI=".Success",n.FAILURE_KPI=".Failure.",n}(),s=function(){function n(e,t,i,u,s){var l,c,d,f=this;this.healthLogger=e,this.featureConfig=t,this.kpiUsageEventBlocker=i,this.kpiFailureEventBlocker=u,this.kpiSuccessEventBlocker=s,this.featureUsageAndHealthLogger=new a(this.healthLogger,this.featureConfig,null!==(l=this.kpiUsageEventBlocker)&&void 0!==l?l:n.kpiUsageBlocker,null!==(c=this.kpiSuccessEventBlocker)&&void 0!==c?c:n.kpiFailureBlocker,null!==(d=this.kpiFailureEventBlocker)&&void 0!==d?d:n.kpiSuccessBlocker),this.executeCallbackWithLogging=function(n,e){var t,i,u,a=function(n){return"VetoFailureLoggingParams".includes(n)};(null==e?void 0:e.kpiUsageLoggingParams)?(i="Usage",u=null==e?void 0:e.kpiUsageLoggingParams):(null==e?void 0:e.kpiSuccessLoggingParams)?(i="UsageWithSuccess",u=null==e?void 0:e.kpiSuccessLoggingParams):(null==e?void 0:e.kpiFailureLoggingParams)?(i="UsageWithFailure",u=null==e?void 0:e.kpiFailureLoggingParams):(i="UsageWithVetoFailure",u=null==e?void 0:e.vetoFailureLoggingParams);var s=null==u?void 0:u.usageName,l=null==u?void 0:u.usageKpiType;f.logKpiUsage({kpiName:s,kpiType:null!=l?l:o.FailureBased});try{null==n||n(),"UsageWithSuccess"===i&&"KpiSuccessLoggingParams".includes(u)&&f.logKpiSuccess({kpiName:s,optionalProperties:u.successOptionalProperties})}catch(n){if("UsageWithFailure"===i&&"KpiFailureLoggingParams".includes(u)||"UsageWithVetoFailure"===i&&a(u)){var c=void 0;a(u)&&(c=(0,r.pi)({name:null!==(t=u.vetoName)&&void 0!==t?t:""},u.vetoOptionalProperties)),f.logKpiFailure({kpiName:u.usageName,errorName:u.failureErrorName,optionalProperties:u.failureOptionalProperties,optionalVeto:c})}throw n}}}return n.getInstance=function(e,t,o,i,r){return new n(e,t,o,i,r)},n.prototype.logKpiUsage=function(n){var e;return!(!n||!n.kpiName)&&this.featureUsageAndHealthLogger.logKpiUsage(n.kpiName,null!==(e=n.kpiType)&&void 0!==e?e:o.FailureBased,n.optionalProperties,n.blockFutureEmissionDurationInMs)},n.prototype.logKpiFailure=function(n){return!!(n&&n.kpiName&&n.errorName)&&this.featureUsageAndHealthLogger.logKpiFailure(n.kpiName,n.errorName,n.optionalProperties,n.optionalVeto,n.blockFutureEmissionDurationInMs)},n.prototype.logKpiSuccess=function(n){return!(!n||!n.kpiName)&&this.featureUsageAndHealthLogger.logKpiSuccess(n.kpiName,n.optionalProperties,n.blockFutureEmissionDurationInMs)},n.prototype.ensureFeatureDenominatorLoggedAndVetoPillarRegistered=function(n){this.featureUsageAndHealthLogger.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(n)},n.kpiUsageBlocker=new u,n.kpiFailureBlocker=new u,n.kpiSuccessBlocker=new u,n}(),l=function(){function n(){}return n.prototype.getHealthInstance=function(n){if(n)return i.S9.getInstance().initialize(n),i.S9.getInstance()},n.prototype.getExtendedHealthInstance=function(n,e){if(n&&e)return s.getInstance(n,e)},n}();!function(n){n[n.FailureBased=0]="FailureBased",n[n.SuccessBased=1]="SuccessBased"}(o||(o={})),new l},8404:function(n,e,t){"use strict";t.d(e,{S9:function(){return v}});var o,i=t(533);function r(n){if(n){var e={};return n.forEach((function(n,t){t&&(e[t]=n)})),e}}function u(n,e){var t=[],o=new Set;return n.concat(e).forEach((function(n){return o.add(n)})),o.forEach((function(n){return t.push(n)})),t}!function(n){n[n.Failure=0]="Failure",n[n.ImpliedUsageFailure=1]="ImpliedUsageFailure",n[n.ImpliedUsageSuccess=2]="ImpliedUsageSuccess",n[n.Success=3]="Success",n[n.Usage=4]="Usage"}(o||(o={}));var a,s,l,c,d,f=t(7430);!function(n){n[n.BSqmError=0]="BSqmError",n[n.Kpi=1]="Kpi",n[n.QosError=2]="QosError",n[n.QosPillar=3]="QosPillar",n[n.DiagnosticLog=4]="DiagnosticLog",n[n.OfflineWorkerInit=5]="OfflineWorkerInit",n[n.OfflineWorkerFlush=6]="OfflineWorkerFlush",n[n.OfflineWorkerFailedUpload=7]="OfflineWorkerFailedUpload"}(a||(a={})),function(n){n.HealthDimensions="d",n.PartCDimensions="a",n.BSqmErrors="b",n.QosErrors="e",n.Heartbeat="h",n.QosPillars="q",n.Kpis="k",n.DiagnosticLogs="l",n.ClientSendTime="t"}(s||(s={})),function(n){n[n.AttemptToUseFunctionalityBeforeIitialization=0]="AttemptToUseFunctionalityBeforeIitialization",n[n.WorkerApiIsNotAvailable=1]="WorkerApiIsNotAvailable",n[n.InvalidWorkerUrl=2]="InvalidWorkerUrl",n[n.InstallingOfflineWorker=3]="InstallingOfflineWorker",n[n.OfflineWorkerMessage=4]="OfflineWorkerMessage",n[n.FailedToProcessMessageFromOfflineWorker=5]="FailedToProcessMessageFromOfflineWorker",n[n.FailedToInstallOfflineWorker=6]="FailedToInstallOfflineWorker",n[n.InitializedHealth=7]="InitializedHealth",n[n.BatchesOfHealthEventsInIndexedDB=8]="BatchesOfHealthEventsInIndexedDB",n[n.IndexedDbTransactionFailed=9]="IndexedDbTransactionFailed",n[n.InstalledOfflineWorker=10]="InstalledOfflineWorker",n[n.IndexedDdIsNotSupported=11]="IndexedDdIsNotSupported",n[n.GetAllKeysIsNotSupported=12]="GetAllKeysIsNotSupported",n[n.FailedToProcessMessage=13]="FailedToProcessMessage",n[n.FailedToLoadWorkerScript=14]="FailedToLoadWorkerScript",n[n.FailedToSendEventToWorker=15]="FailedToSendEventToWorker",n[n.FailedToJsonStringifyEvent=16]="FailedToJsonStringifyEvent"}(l||(l={})),function(n){n[n.AttemptedToAddOrUpdatePartCDimension=0]="AttemptedToAddOrUpdatePartCDimension",n[n.AttemptedToRecordBSqmQosError=1]="AttemptedToRecordBSqmQosError",n[n.AttemptedToRecordSessionEndingQosError=2]="AttemptedToRecordSessionEndingQosError",n[n.AttemptedToSetAppOnlineStatus=3]="AttemptedToSetAppOnlineStatus",n[n.AttemptedToUpdatePartADimensions=4]="AttemptedToUpdatePartADimensions"}(c||(c={})),function(n){n[n.SendSucceeded=0]="SendSucceeded",n[n.SendFailed=1]="SendFailed",n[n.DidNotAttempt=2]="DidNotAttempt"}(d||(d={}));var v=function(){function n(){var n=this;this.Kn={},this.Jn={},this.qn=[],this.zn={},this.Qn=0,this.Xn={Zn:3e5,Yn:!1,$n:!1,ne:!1,ee:3e4,te:25,oe:"",ie:864e5,re:"",ue:"",ae:3,se:3,le:15e3,ce:new Set},this.de=!1,this.fe=-1,this.ve=!1,this.he=0,this.pe=!0,this.me=function(){return!1},this.we={},this.Se=[],this.be=0,this.Ie=0,this.Ce=void 0,this.Ae=[],this.Te=[],this.ye=[],this.He=[],this.Ue=0,this.Ee=0,this.ke=0,this.Re=[],this.Fe=!1,this.Pe=0,this.Ne=!1,this.Oe=function(){n.Ue&&(window.clearTimeout(n.Ue),n.Ue=0)},this.De=function(){n.Se=[],n.Ae=[],n.Te=[],n.Ce=void 0,n.ye=[],n.He=[],n.be=0,n.Ie=0},this._e=function(){try{if(n.be<=0)return;var e=n.We();n.xe(e,n.Qn,n.Xn.se),n.De()}catch(n){}},this.We=function(){return{d:n.zn,a:n.Me(),b:n.Se,e:n.Te,h:n.Ce,q:n.ye,k:n.Ae,l:n.He,type:"h_v2"}},this.Me=function(){return n.Xn.ne&&(n.Se&&n.Se.length>0||n.Te&&n.Te.length>0)&&Object.keys(n.Jn).length>0?(0,i.pi)((0,i.pi)({},n.Kn),n.Jn):n.Kn},this.je=function(e,t,o,i){var r;if(void 0===i&&(i=!1),t&&!n.Xn.ce.has(o))if(n.pe){switch(e){case a.BSqmError:n.Se.push(t);break;case a.Kpi:n.Ae.push(t);break;case a.QosError:n.Te.push(t);break;case a.QosPillar:-1===n.ye.map((function(n){return n.n})).indexOf(t.n)&&n.ye.push(t);break;case a.DiagnosticLog:n.He.push(t)}if(n.be+=1,e!==a.DiagnosticLog&&e!==a.QosPillar&&(n.Ie+=1),n.me()&&!i)return void n._e();n.be>=n.Xn.te&&(n.Oe(),n.Ge())}else t.o=(new Date).toJSON(),null===(r=n.Be)||void 0===r||r.postMessage({t:e,k:"".concat(n.zn.w,".").concat(n.Qn),m:n.zn,c:n.Me(),v:t})},this.Le=function(){n.Oe(),n.Ue=window.setTimeout((function(){n.Ge()}),n.Xn.ee)},this.Ge=function(e){void 0===e&&(e=!1),e&&n.Ie<=0||(n._e(),n.Le())},this.Ve=function(){if(n.Re||n.we){n.Ce&&-1!==n.fe||(n.fe=(n.fe+1)%1e3),n.Ce||(n.be+=1);var e={p:n.Ce?u(n.Ce.p,n.Re):n.Re,k:n.Ce?u(n.Ce.k,n.qn):n.qn,i:n.Xn.Zn,o:n.fe};n.Ce=e}},this.Ke=function(e,t,o,i,u,s,l,c,d,f){if(e&&(!t||n.we[e])){t||n.Je(e,c,d,f);var v=n.we[e],h={n:v.k,e:o,t:v.t,a:v.a,f:v.o,d:null==i?void 0:i.durationMs,p:r(null==i?void 0:i.extendedProperties)};if(u){var p={n:u,x:l,z:s};h.k=p}n.je(a.Kpi,h,e)}},this.qe=function(){var e,t,o,i,r,u,a,s,l,c,d,f,v,h,p,m,w,g,S,b,I,C,A,T,y,H,U,E,k,R,F,P,N,O,D,_,W,x=n.Xn.zn;x&&(n.zn={a:null!==(e=x.application)&&void 0!==e?e:void 0,b:null!==(t=x.applicationLcid)&&void 0!==t?t:void 0,c:null!==(o=x.applicationMode)&&void 0!==o?o:void 0,d:null!==(i=x.applicationModeExtended)&&void 0!==i?i:void 0,e:null!==(r=x.arrVersion)&&void 0!==r?r:void 0,f:null!==(u=x.browser)&&void 0!==u?u:void 0,g:null!==(a=x.browserLcid)&&void 0!==a?a:void 0,h:null!==(s=x.browserMajorVersion)&&void 0!==s?s:void 0,i:null!==(l=x.browserVersion)&&void 0!==l?l:void 0,j:null!==(c=x.clientVersion)&&void 0!==c?c:void 0,k:null!==(d=x.datacenter)&&void 0!==d?d:void 0,l:null!==(f=x.dataCulture)&&void 0!==f?f:void 0,m:null!==(v=x.flightsImpressionId)&&void 0!==v?v:void 0,n:null!==(h=x.host)&&void 0!==h?h:void 0,o:null!==(p=x.isAnonymousUser)&&void 0!==p?p:void 0,p:null!==(m=x.isBusinessUser)&&void 0!==m?m:void 0,q:null!==(w=x.isEduUser)&&void 0!==w?w:void 0,r:null!==(g=x.isSynthetic)&&void 0!==g?g:void 0,s:null!==(S=x.loggableUserId)&&void 0!==S?S:void 0,t:null!==(b=x.loggableUserIdSpace)&&void 0!==b?b:void 0,u:null!==(I=x.ring)&&void 0!==I?I:void 0,v:null!==(C=x.serverDocId)&&void 0!==C?C:void 0,w:null!==(A=x.session_id)&&void 0!==A?A:void 0,x:null!==(T=x.sessionOrigin)&&void 0!==T?T:void 0,y:null!==(y=x.tenantId)&&void 0!==y?y:void 0,z:null!==(H=x.uiHost)&&void 0!==H?H:void 0,aa:null!==(U=x.wfeVersion)&&void 0!==U?U:void 0,ab:null!==(E=x.fileExtension)&&void 0!==E?E:void 0,ac:null!==(k=x.uiHostIntegrationType)&&void 0!==k?k:void 0,ad:null!==(R=x.osVersion)&&void 0!==R?R:void 0,af:null!==(F=x.networkDownlink)&&void 0!==F?F:void 0,ag:null!==(P=x.networkDownlinkMax)&&void 0!==P?P:void 0,ah:null!==(N=x.networkEffectiveType)&&void 0!==N?N:void 0,ai:null!==(O=x.networkRTT)&&void 0!==O?O:void 0,aj:null!==(D=x.networkSaveData)&&void 0!==D?D:void 0,ak:null!==(_=x.networkType)&&void 0!==_?_:void 0,al:null!==(W=x.userLicenseType)&&void 0!==W?W:void 0})},this.ze=function(){n.Ve(),n.he=window.setTimeout((function(){n.ze()}),n.Xn.Zn)},this.Qe=function(){n.Re&&n.Re.forEach((function(e){e&&n.Xe(e,!0)}))},this.Xe=function(e,t){var o={};o.n=e,n.je(a.QosPillar,o,e,t)},this.Ze=function(){n.Re&&(n.Ee=Date.now(),n.Qe()),n.Ye()},this.Ye=function(e){void 0===e&&(e=n.Xn.ie),n.ke=window.setTimeout((function(){n.Ze()}),e)},this.$e=function(){n.de||(n.de=!0,n.ve=!0,n.ze())},this.nt=function(){0!==n.ke&&(window.clearTimeout(n.ke),n.ke=0)},this.et=function(){if(n.Xn.Yn&&n.Xn.$n&&n.Xn.ue&&""!==n.Xn.ue&&n.Xn.oe&&""!==n.Xn.oe)try{if("undefined"==typeof Worker)return void n.tt(l.WorkerApiIsNotAvailable);if(!n.Xn.oe)return void n.tt(l.InvalidWorkerUrl);n.tt(l.InstallingOfflineWorker);var e=new Blob(["try{importScripts('".concat(encodeURI(n.Xn.oe),"');}catch(e){self.postMessage({i:14,l:'W',r:e.toString()})}")],{type:"application/javascript"});n.Be=new Worker(URL.createObjectURL(e)),n.Be.onmessage=function(e){try{var t=e.data;n.tt(t.i,t.r)}catch(e){n.tt(l.FailedToProcessMessageFromOfflineWorker,e.toString())}},n.Be.postMessage({t:a.OfflineWorkerInit,v:n.Xn.ue}),n.Be.postMessage({t:a.OfflineWorkerFlush})}catch(e){n.tt(l.FailedToInstallOfflineWorker,e.toString())}},this.ot=function(e,t){var o;if(e.b.length>0||e.e.length>0||e.q.length>0||e.k.length>0||e.l.length>0)try{return null===(o=n.Be)||void 0===o||o.postMessage({t:a.OfflineWorkerFailedUpload,k:"".concat(e.d.w,".").concat(t),v:e}),d.SendSucceeded}catch(e){var i=n.it(e);return n.tt(l.FailedToSendEventToWorker,i),d.SendFailed}return d.DidNotAttempt},this.Je=function(e,t,o,i){e&&void 0!==t&&(n.we[e]||(n.we[e]={k:e,t,a:!0===o,o:null!=i?i:void 0},o&&(n.qn.push(e),n.Ve())))},this.rt=function(e){n.fe=-1,e?(n.Ee=Date.now(),n.Ye(),n.$e()):n.Ve()},this.ut=function(e){return!!n.Ne||(n.tt(l.AttemptToUseFunctionalityBeforeIitialization,null==e?void 0:e.toString()),!1)},this.xe=function(e,t,o){if(e){var r=n.Xn.re;if(n.Fe&&(o<=0||!n.pe)&&n.ot(e,t)!==d.SendFailed)return;if(!(o<=0)){var u=n.st(e,!1);if(null!==u){if(n.me())try{if(void 0!==navigator.sendBeacon){if(u.length>=65536&&n.Xn.ne){var a=(0,i.pi)((0,i.pi)({},e),{a:n.Kn}),s=n.st(a,!0);if(null===s)return;navigator.sendBeacon(r,s)}else navigator.sendBeacon(r,u);return}}catch(n){}var l=new XMLHttpRequest;l.open("POST",r,!0),l.onreadystatechange=function(){l.readyState===XMLHttpRequest.DONE&&(200===l.status?n.Fe||(n.Fe=!0):n.Pe<n.Xn.ae?(n.Pe+=1,window.setTimeout((function(){n.Pe-=1,n.xe(e,t,o-1)}),n.Xn.le)):n.Fe&&n.ot(e,t))},l.send(u)}}}},this.tt=function(e,t){var o={i:e,r:t};n.je(a.DiagnosticLog,o,e.toString())},this.it=function(n){var e=void 0;return"string"==typeof n?e=n:n instanceof Error&&(e=n.name+" "+n.message,n.stack&&(e+=" "+n.stack)),e},this.st=function(e,t){try{return i=e,JSON.stringify(i)}catch(e){var o=n.it(e);return o="ModifiedPayload: "+t+" | "+o,n.tt(l.FailedToJsonStringifyEvent,o),null}var i}}return n.getInstance=function(){return n.lt||(n.lt=new n),this.lt},n.prototype.initialize=function(n){if(n)try{return this.Xn=function(n){var e,t,o,i,r,u,a,s,l,c,d,f,v,h,p;return{zn:null!==(e=n.dimensions)&&void 0!==e?e:void 0,Zn:null!==(t=n.heartbeatIntervalMs)&&void 0!==t?t:3e5,Yn:null!==(o=n.isHealthEnabled)&&void 0!==o&&o,$n:null!==(i=n.isOfflineEnabled)&&void 0!==i&&i,ne:null!==(r=n.isErrorPartCEnabled)&&void 0!==r&&r,ee:null!==(u=n.loggerMaxIntervalMs)&&void 0!==u?u:3e4,te:null!==(a=n.loggerMaxQueueSize)&&void 0!==a?a:25,oe:null!==(s=n.offlineWorkerUrl)&&void 0!==s?s:"",ue:null!==(l=n.absoluteRemoteTelemetryUrlForOfflineWorker)&&void 0!==l?l:"",ie:null!==(c=n.recordPillarToWarmPipelineIntervalMs)&&void 0!==c?c:864e5,re:null!==(d=n.remoteTelemetryUrl)&&void 0!==d?d:"",ae:null!==(f=n.maxConcurrentRetries)&&void 0!==f?f:3,se:null!==(v=n.retryMaxAttempts)&&void 0!==v?v:3,le:null!==(h=n.retryDelayMs)&&void 0!==h?h:15e3,ce:null!==(p=n.disabledHealthEvents)&&void 0!==p?p:new Set}}(n),this.qe(),this.Le(),this.et(),this.Ne=!0,void this.tt(l.InitializedHealth)}catch(n){}this.Ne=!1},n.prototype.addOrUpdatePartCDimension=function(n,e){this.ut(c.AttemptedToAddOrUpdatePartCDimension)&&n&&(this.Kn.hasOwnProperty(n)&&this.Kn[n]===e||(this.Ge(!0),this.Kn[n]=e,this.Qn+=1,this.Ve(),this.Qe()))},n.prototype.addOrUpdateErrorPartCDimension=function(n,e){this.Xn.ne&&n&&(this.Jn[n]=e)},n.prototype.addQosPillar=function(n){if(n){var e=0===this.Re.length;-1===this.Re.indexOf(n)&&(this.Re.push(n),this.Xe(n,!1),this.rt(e))}},n.prototype.recordBsqmQosError=function(n,e,t){if(this.ut(c.AttemptedToRecordBSqmQosError)&&(this.ct(!1),this.Qe(),n)){var o={b:n,v:e,d:null==t?void 0:t.durationMs,p:r(null==t?void 0:t.extendedProperties),s:this.Re,i:null==t?void 0:t.inStaging};this.je(a.BSqmError,o,n),this.shutdown(!0)}},n.prototype.recordKpiFailure=function(n,e,t,i,r){this.Ke(n,!0,o.Failure,r,e,i,t)},n.prototype.recordKpiImpliedFailure=function(n,e,t,i,r,u){this.Ke(n,!1,o.ImpliedUsageFailure,u,e,i,t,f.o.FailureBased,!1,r)},n.prototype.recordKpiImpliedSuccess=function(n,e,t){this.Ke(n,!1,o.ImpliedUsageSuccess,t,void 0,void 0,void 0,f.o.FailureBased,!1,e)},n.prototype.recordKpiSuccess=function(n,e){this.Ke(n,!0,o.Success,e)},n.prototype.recordKpiUsage=function(n,e,t,i){this.Ke(n,!1,o.Usage,{extendedProperties:i},void 0,void 0,void 0,e,!1,t)},n.prototype.recordKpiUsageForAlertableKpi=function(n,e,t){if(n){var i=!0,r=this.we[n];r&&(i=r.t===f.o.FailureBased),this.Ke(n,!1,o.Usage,{extendedProperties:t},void 0,void 0,void 0,f.o.FailureBased,!0,e),i&&this.$e()}},n.prototype.recordQosError=function(n,e,t,o,i,u,s){if((!u||this.ut(c.AttemptedToRecordSessionEndingQosError))&&n&&e){var l={n,x:t,z:o,l:i,v:e,e:u,d:null==s?void 0:s.durationMs,p:r(null==s?void 0:s.extendedProperties),s:this.Re,i:null==s?void 0:s.inStaging};this.je(a.QosError,l,n),u&&(this.ct(!1),this.Qe(),this.shutdown(!0))}},n.prototype.removeQosPillar=function(n){if(n){var e=this.Re.indexOf(n);e>-1&&(this.Re.splice(e,1),this.rt(!1)),0===this.Re.length&&this.nt()}},n.prototype.resumeAllHealthTimers=function(){if(this.de&&!this.ve&&this.ze(),0===this.ke&&0!==this.Ee){var n=Date.now()-this.Ee;n>=this.Xn.ie||n<=0?this.Ze():this.Ye(this.Xn.ie-n)}},n.prototype.setHandlerForIsAppShuttingDown=function(n){n&&(this.me=n)},n.prototype.setIsAppOnline=function(n){var e;this.ut(c.AttemptedToSetAppOnlineStatus)&&(!this.pe&&n&&(null===(e=this.Be)||void 0===e||e.postMessage({t:a.OfflineWorkerFlush,v:this.me()})),this.pe=n)},n.prototype.shutdown=function(n){var e;void 0===n&&(n=!1),this.Xn.Yn&&(this.Oe(),this.ct(!1),this.me=function(){return!0},this._e(),(!n||n&&this.pe)&&(null===(e=this.Be)||void 0===e||e.terminate()))},n.prototype.stopAllHealthTimers=function(){this.ct(!0)},n.prototype.ct=function(n){this.ve=!1,this.fe=-1,0!==this.he&&(window.clearTimeout(this.he),this.he=0),this.nt(),n&&this._e()},n.prototype.updatePartADimensions=function(n){var e=this;if(n&&this.ut(c.AttemptedToUpdatePartADimensions)){var t=!1;Object.keys(n).forEach((function(o){void 0!==n[o]&&null!==n[o]&&""!==n[o]&&e.Xn.zn[o]!==n[o]&&(e.Xn.zn[o]=n[o],t=!0)})),t&&(this.Ge(),this.qe(),this.Qn+=1,this.Ve(),this.Qe())}},n.prototype.flushAndSetNewEndpoint=function(n,e){var t;n.localeCompare(null!==(t=this.Xn.re)&&void 0!==t?t:"",void 0,{sensitivity:"accent"})&&(this.Ge(!1),this.Xn.re=n,e&&e())},n}()},3650:function(n,e,t){"use strict";var o;t.d(e,{W:function(){return o}}),function(n){n[n.ft=0]="msoulscat_ES_EWAJS",n[n.vt=1]="msoulscat_ES_EWAJSGrid",n[n.ht=6]="msoulscat_ES_EWAJSChart",n[n.wt=202]="msoulscat_MSOSP_FileMenuCommands",n[n.gt=220]="msoulscat_MSOSP_AddInCommands",n[n.St=225]="msoulscat_MSOSP_OTelJS",n[n.bt=227]="msoulscat_MSOSP_OTelJSInWebWoker",n[n.It=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",n[n.Ct=301]="msoulscat_Wac_WordViewer",n[n.At=306]="msoulscat_Wac_BrowserGeneral",n[n.Tt=320]="msoulscat_Wac_TaskPane",n[n.yt=339]="msoulscat_Wac_OneNoteGeneral",n[n.Ht=340]="msoulscat_Wac_Ribbon",n[n.Ut=356]="msoulscat_Wac_WacFeedback",n[n.Et=379]="msoulscat_Wac_WopiPendingApplication",n[n.kt=383]="msoulscat_Wac_Telemetry",n[n.Rt=391]="msoulscat_Wac_WacCatchUpActivities",n[n.Ft=394]="msoulscat_Wac_Dictation",n[n.Pt=395]="msoulscat_Wac_OneNoteSync",n[n.Nt=700]="msoulscat_Wac_VisioApp",n[n.Ot=1601]="msoulscat_OneNoteOnline_EditableCache",n[n.Dt=800]="msoulscat_Wac_PptAnimation",n[n._t=833]="msoulscat_Wac_PptLive",n[n.Wt=834]="msoulscat_Wac_PptMWeb",n[n.xt=835]="msoulscat_Wac_PptGc2General",n[n.Mt=836]="msoulscat_Wac_PptGc2GraphicHost",n[n.jt=837]="msoulscat_Wac_PptGc2Operation",n[n.Gt=844]="msoulscat_Wac_PptDataSync",n[n.Bt=848]="msoulscat_Wac_PptFluidRuntime",n[n.Lt=815]="msoulscat_Wac_PptShape",n[n.Vt=817]="msoulscat_Wac_PptSession",n[n.Kt=830]="msoulscat_Wac_PptSlideshow",n[n.Jt=822]="msoulscat_Wac_PptView",n[n.qt=846]="msoulscat_Wac_PptVideos",n[n.zt=1303]="msoulscat_Uci_Insights",n[n.Qt=2300]="msoulscat_Wac_VersionHistory",n[n.Xt=302]="msoulscat_Wac_WordPresence",n[n.Zt=3e3]="msoulscat_Wac_OAuth",n[n.Yt=3005]="msoulscat_Wac_WordVersionHistory",n[n.$t=3006]="msoulscat_Wac_LivePersonaCard",n[n.no=3012]="msoulscat_Wac_CatchUpFlyout",n[n.eo=3016]="msoulscat_Wac_WordDesigner",n[n.oo=3021]="msoulscat_Wac_ModernFontPicker",n[n.io=3027]="msoulscat_Wac_UnifiedUiHost",n[n.ro=3033]="msoulscat_Wac_EquationTools",n[n.uo=1401]="msoulscat_Osf_Latency",n[n.ao=1402]="msoulscat_Osf_Notification",n[n.so=1403]="msoulscat_Osf_Runtime",n[n.lo=3041]="msoulscat_Wac_AiMaker",n[n.co=3043]="msoulscat_Wac_AiRewrite",n[n.do=3044]="msoulscat_Wac_AiInsert",n[n.fo=3047]="msoulscat_Wac_AiSummarize",n[n.vo=3048]="msoulscat_Wac_CopilotCompose",n[n.ho=3049]="msoulscat_Wac_Skittles"}(o||(o={}))},8643:function(n,e,t){"use strict";var o;t.d(e,{G:function(){return o}}),function(n){n[n.Error=10]="Error",n[n.Warning=15]="Warning",n[n.Important=20]="Important",n[n.Info=50]="Info",n[n.Verbose=100]="Verbose",n[n.Spam=200]="Spam"}(o||(o={}))},1753:function(n,e,t){"use strict";t.d(e,{o:function(){return a}});var o=t(3650),i=t(8643),r=t(9527),u=t(9893);function a(n,e,t,s,l,c,d){void 0===s&&(s=!1),void 0===l&&(l=!1),void 0===c&&(c=1),void 0===d&&(d=!1);var f=(0,u.a)();return(0,u.l)("wopiDataStartTime"),e(n,s,l,t).then((function(e){var a,s,l,c;if(!e){var d="Graph call failed";return null==t||t.ULS.sendTraceTag(553726284,o.W.io,i.G.Error,"GetWopiData: Failed to get the driveItem. [ErrorMessage: ".concat(d,"]")),Promise.reject(d)}var v={docUrl:null!==(a=e.webDavUrl)&&void 0!==a?a:n.docUrl,driveId:null!==(l=null===(s=null==e?void 0:e.parentReference)||void 0===s?void 0:s.driveId)&&void 0!==l?l:n.driveId,docId:null!==(c=null==e?void 0:e.id)&&void 0!==c?c:n.docId,fileName:e.name};null==t||t.ULS.sendTraceTag(553726285,o.W.io,i.G.Info,"GetWopiData: Fetched documentIdentifier. [IsValid: ".concat(!!v,"]"));var h=Promise.resolve(v);null==t||t.ULS.sendTraceTag(553726286,o.W.io,i.G.Info,"GetWopiData: Fetched documentIdentifier. [IsValid: ".concat(!!h,"]"));var p=(0,r.YI)(e,t);null==t||t.ULS.sendTraceTag(553726287,o.W.io,i.G.Info,"GetWopiData: Getting WopiHostData from drive item. [IsValid: ".concat(!!p,"]"));var m={startTime:f,endTime:(0,u.a)()};return(0,u.l)("wopiDataEndTime"),{fetchedDocumentIdentifier:h,wopiHostData:p,fetchDiagnostics:m}})).catch((function(r){var u;return null==t||t.ULS.sendTraceTag(520729472,o.W.io,i.G.Warning,"GetWopiData: General getWopiData error. [Error: ".concat(JSON.stringify(r),"][FailureReason: ").concat(null==r?void 0:r.failure,"]")),c>0&&(null==r?void 0:r.retry)?(null==t||t.ULS.sendTraceTag(544306772,o.W.io,i.G.Error,"GetWopiData: Retrying getWopiData. [Error: ".concat(JSON.stringify(r),"][FailureReason: ").concat(null==r?void 0:r.failure,"]")),new Promise((function(n){var e=function(n){if(0===n)throw new Error("Retry count should not be 0");return 1===n?window.crypto.getRandomValues(new Uint32Array(1))[0]%291+10:10}(c);setTimeout(n,e),null==t||t.ULS.sendTraceTag(508035599,o.W.io,i.G.Warning,"GetWopiData: Retrying getWopiData with ".concat(c," retries left. Delaying retry for ").concat(e,"ms."))})).then((function(){return a(n,e,t,s,l,c-1)})).catch((function(n){return null==t||t.ULS.sendTraceTag(508035598,o.W.io,i.G.Error,"GetWopiData: Failed to delay retry getWopiData. [Error: ".concat(n.message,"]")),Promise.reject(n)}))):c>0&&d&&"accessDenied"===(null==r?void 0:r.errorCode)?new Promise((function(n){setTimeout(n,3e3),null==t||t.ULS.sendTraceTag(523269073,o.W.io,i.G.Warning,"GetWopiData: Retrying getWopiData after retryIntervalForWopiDataRequest: ".concat(3e3,"ms. [Error: ").concat(JSON.stringify(r),"][FailureReason: ").concat(null==r?void 0:r.failure,"]"))})).then((function(){return a(n,e,t,s,l,0)})):(null==t||t.ULS.sendTraceTag(544306773,o.W.io,i.G.Error,"GetWopiData: Not retrying getWopiData. [Error: ".concat(JSON.stringify(r),"][ShouldRetry: ").concat(c>0,"][FailureReason: ").concat(null!==(u=null==r?void 0:r.failure)&&void 0!==u?u:null==r?void 0:r.message,"]")),Promise.reject(r))}))}},4723:function(n,e,t){"use strict";t.d(e,{n:function(){return f},g:function(){return d}});var o,i=t(533),r=t(3650),u=t(8643),a=t(9893),s=t(6652),l=["res-1.cdn.office.net","res-2.cdn.office.net","res-3.cdn.office.net","wise.public.cdn.office.net"];function c(n,e,t,i,a){if(null==o||o.delete(t),i&&"PRODUCTION"===i){var s=new URL(n),c=new Uint32Array(1);window.crypto.getRandomValues(c);var f=c[0]%l.length,v=l[f];return s.hostname=v,null==a||a.ULS.sendTraceTag(507810057,r.W.io,u.G.Important,"JSAPI Retrying with new cdn host at index: ".concat(f)),d(s.toString(),e,t,!1,i)}return d(n,e,t,!1,i)}function d(n,e,t,l,d,f){return void 0===l&&(l=!0),(0,i.mG)(this,void 0,void 0,(function(){var v,h,p=this;return(0,i.Jh)(this,(function(m){return o||(o=new Map),(v=o.get(t))?[2,v]:(h=new Promise((function(o,v){var h=(0,a.a)();!function(n,e,t,o,i,r,u){if(void 0===o&&(o=!1),void 0===r&&(r=!1),void 0===u&&(u=!1),!document)return null;if(i){var a=document.getElementById(i);if(null!=a)return e&&e(),a}var s=document.createElement("script");if(s.src=n,i&&(s.id=i),e&&(s.onload=e),t&&(s.onerror=function(){var n;u&&(null===(n=s.parentNode)||void 0===n||n.removeChild(s)),t()}),r&&(s.crossOrigin="anonymous"),o){var l=document.getElementsByTagName("script")[0];if(l&&l.parentNode)return l.parentNode.insertBefore(s,l)}document.body.appendChild(s)}(n,(function(){var i=(0,a.a)();null==f||f.ULS.sendTraceTag(507834582,r.W.io,u.G.Important,"JSAPI fetch succeeded for ".concat(s.T[t]," bootstrapper. OnRetry: false")),o({bootstrapperUrl:n,applicationUrl:e,performance:{startTime:h,endTime:i}})}),(function(){return(0,i.mG)(p,void 0,void 0,(function(){var p;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:if(!l)return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,c(n,e,t,d,f)];case 2:return i.sent(),p=(0,a.a)(),null==f||f.ULS.sendTraceTag(507834581,r.W.io,u.G.Important,"JSAPI fetch succeeded for ".concat(s.T[t]," bootstrapper. OnRetry: true")),o({bootstrapperUrl:n,applicationUrl:e,performance:{startTime:h,endTime:p}}),[3,4];case 3:return i.sent(),null==f||f.ULS.sendTraceTag(507834580,r.W.io,u.G.Error,"JSAPI fetch failed for ".concat(s.T[t]," bootstrapper. OnRetry: true")),v("Load bootstrapper script failed"),[3,4];case 4:return[3,6];case 5:null==f||f.ULS.sendTraceTag(507834579,r.W.io,u.G.Error,"JSAPI fetch failed for ".concat(s.T[t]," bootstrapper. OnRetry: false")),v("Load bootstrapper script failed"),i.label=6;case 6:return[2]}}))}))}),!1,"".concat(s.T[t],"_bootstrapper"),!1,l)})),o.set(t,h),[2,h])}))}))}function f(n){var e=window.Microsoft;if(void 0===e)return[void 0,"Microsoft is undefined"];var t=e.Office,o=s.T[n];return t&&t[o]?[t[o],void 0]:[void 0,"Failed to find bootstrapper for app: ".concat(o)]}},8587:function(n,e,t){"use strict";t.d(e,{Zl:function(){return P},Tq:function(){return N}});var o=t(533),i=t(3650),r=t(8643),u=t(5358),a=t(6578),s=t(5089),l=t(4461),c=function(n){function e(){var e=null!==n&&n.apply(this,arguments)||this;return e.value=null,e.hasNext=!1,e.hasCompleted=!1,e}return a.ZT(e,n),e.prototype.F=function(e){return this.hasError?(e.error(this.thrownError),l.w.EMPTY):this.hasCompleted&&this.hasNext?(e.next(this.value),e.complete(),l.w.EMPTY):n.prototype.F.call(this,e)},e.prototype.next=function(n){this.hasCompleted||(this.value=n,this.hasNext=!0)},e.prototype.error=function(e){this.hasCompleted||n.prototype.error.call(this,e)},e.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&n.prototype.next.call(this,this.value),n.prototype.complete.call(this)},e}(s.xQ),d=t(1917),f=t(274),v=t(5665),h=t(43),p=t(2022),m=t(7125),w=t(8807);function g(n,e,t,o,u,a){if(t){var s=(0,w.vJ)(w.Fh.FeatureGate_DisableEUDBBrowserULSRouting,u);n.then((function(n){if(n&&((0,w.dt)(w.Fh.FeatureGate_DisableEUDBBrowserULSRouting,s,t),!s)){var o=S(n),u=(0,p.fy)(e,o.dataBoundary);t.flushAndSetNewEndpoint(u,(function(){null==t||t.ULS.sendTraceTag(509612803,i.W.io,r.G.Info,"Updated ULS endpoint. Environment: ".concat(e,", DataBoundary: ").concat(o.dataBoundary,", Region: ").concat(o.region))}))}})).catch((function(n){null==t||t.ULS.sendTraceTag(509875042,i.W.io,r.G.Warning,"Failed to identify data boundary-aware bULS endpoint. Error: ".concat(n.message))}))}if(o){var l=(0,w.vJ)(w.Fh.FeatureGate_DisableEUDBHealthTelemetryRouting,u);n.then((function(n){if(n&&((0,w.dt)(w.Fh.FeatureGate_DisableEUDBHealthTelemetryRouting,l,t),!l)){var u=S(n),s=(0,p.S$)(e,a,u.dataBoundary);o.flushAndSetNewEndpoint(s,(function(){null==t||t.ULS.sendTraceTag(509612802,i.W.io,r.G.Info,"Updated Health endpoint. Environment: ".concat(e,", DataBoundary: ").concat(u.dataBoundary,", Region: ").concat(u.region))}))}})).catch((function(n){null==t||t.ULS.sendTraceTag(509875041,i.W.io,r.G.Warning,"Failed to identify data boundary-aware Health endpoint. Error: ".concat(n.message))}))}}function S(n){var e,t=(e=n.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i))&&e[1]?e[1]:"public";return{region:t,dataBoundary:(0,m.g)(t)}}var b=t(6652),I=t(9893),C=t(9697),A=t(2182),T=t(3007),y=t(654),H=t(4723),U=t(9527),E=t(2597);function k(n,e,t,u,a,s,l,c){var h=this,p=n.loadFunctionSubject,m=n.documentBootInfo,g=n.correlationId,S=n.wopiFetchData,k=void 0===S?{wopiHostData:void 0,fetchDiagnostics:void 0}:S,R=m.fileType,F=m.wdOrigin,P=m.puid,N=m.uiCulture,O=m.dataCulture,D=m.clickTime,_=m.rebootOverrideData,W=k.wopiHostData,x=k.fetchDiagnostics,M=null==t?void 0:t.logger,j=null==t?void 0:t.health;if(!(W&&W.wac&&W.wac.bootstrapperUrl&&W.wac.applicationUrl)){var G=!!W,B=!!(null==W?void 0:W.wac),L=new Map([["WopiHostDataPresent","".concat(G)],["WopiWacDataPresent","".concat(B)]]),V=JSON.stringify(Array.from(L.entries())),K={wacErrorName:f.AU.po,qosErrorName:f.DG.QosError_VroomWopiFailure,errorMessage:V};return null==M||M.ULS.sendTraceTag(554964098,i.W.io,r.G.Info,"".concat(f.AU.po,": Failed to get wopi data for the item, ").concat(V)),void(u&&u(K))}var J=c||W.wac.bootstrapperUrl,q=W.wac.applicationUrl;W.wac.userId&&(null==j||j.updatePartADimensions({loggableUserId:W.wac.userId}));var z=new Promise((function(n,e){setTimeout((function(){return e("jsApi timed out after 60 seconds")}),6e4)})),Q=new Promise((function(n,c){return(0,o.mG)(h,void 0,void 0,(function(){var h;return(0,o.Jh)(this,(function(S){return p.subscribe((function(){return n("jsApi successfully loaded")})),h=function(n,u){var c,h,S=(0,E.e8)(W,q,null!==(c=null==e?void 0:e.uiHostName)&&void 0!==c?c:"UUIH",m,null==e?void 0:e.uiEmbed),H=(0,U.ss)(S,M);(0,E.ZR)(R,null==e?void 0:e.featureGates,M)?(null==j||j.addOrUpdatePartCDimension("JsApiVersion","V2"),h=function(c){var h=c.container,p=c.flushTime;return new d.y((function(c){var d,U,k,R,P,N,j,G,B,L,V,K=(0,A.Z)(m,J,e,t,W),q=v.r.isCreateNewFlowExecuting&&v.r.application?v.r.application:n.createApplication(K),z={hostSessionId:g},Q=v.r.isCreateNewFlowExecuting&&v.r.session?v.r.session:q.createSession(z);s&&s(q,W,m,Q),(0,w.vJ)("UseNewEuplReporting",null==e?void 0:e.featureGates)&&m.fileType!==b.T.Excel||!a||a();var X={appUrl:S,file:(0,o.pi)({name:W.fileName,getUrl:(null===(R=W.wac)||void 0===R?void 0:R.fileGetUrl)||W.downloadUrl,size:W.fileSize,eTag:W.eTag},m.docId&&{uniqueId:m.docId}),customFontCatalogUrl:W.wac.customFontCatalogUrl,contentBundle:{majorVersion:W.bundleVersion?Number(W.bundleVersion):0,url:null!==(P=W.bundleUrl)&&void 0!==P?P:"",staleness:W.bundleStaleness||0},newFileTemplate:m.newFileTemplate,container:h,wopi:{source:W.wac.wopiSrc,accessToken:W.wac.accessToken,expiry:parseInt(W.wac.accessTokenExpiry,10),wacToken:null==t?void 0:t.wacToken},bootParams:{readOnly:W.readOnly,irmEnabled:W.irmEnabled,supportsDecryptedContentDownload:W.protectionEnabled,viewOnly:W.blocksDownload,disableChat:!0,openViewByDefault:"view"===m.intent,dataLanguage:O},diagnostics:(null===(N=null==t?void 0:t.bootDiagnostics)||void 0===N?void 0:N.legacyPerformanceData)?(0,o.pi)((0,o.pi)((0,o.pi)({},(0,E.xL)(null===(j=null==t?void 0:t.bootDiagnostics)||void 0===j?void 0:j.legacyPerformanceData.host,null===(G=null==t?void 0:t.bootDiagnostics)||void 0===G?void 0:G.legacyPerformanceData.owlFrame)),(0,E.YV)(D,p,F,x,u.performance,t,null==e?void 0:e.featureGates)),{legacyPerformanceData:null===(B=null==t?void 0:t.bootDiagnostics)||void 0===B?void 0:B.legacyPerformanceData}):(0,E.ge)(D,p,F,x,u.performance,t,null==e?void 0:e.featureGates),sessionContext:H||(0,E.l_)(),preseededSession:{key:W.preSeededSessionKey,id:W.preSeededWacSessionId},wdParams:(0,o.pi)((0,o.pi)((0,o.pi)({},m.templateId&&(d={},d.wdTpl=m.templateId,d)),_&&_.lcid&&(U={},U.wdlcid=_.lcid,U)||m.uiCulture&&(k={},k.wdlcid=m.uiCulture,k)),(0,E.q6)(m.wdValue)),hostGeneratedSessionId:null==t?void 0:t.sessionId,meeting:null==t?void 0:t.meeting,rebootOverride:_,throttling:{protection:null===(L=W.wac)||void 0===L?void 0:L.clientThrottlingProtection,request:null===(V=W.wac)||void 0===V?void 0:V.requestedCallThrottling}};(0,I.l)(T.r_.OwlWacBootStart),(v.r.isCreateNewFlowExecuting?v.r.completeCreateNewPromise:Q.boot(X,l)).then((function(n){var e;if("success"===n.completion)c.next({wopiHostData:W,officeApplication:q,bootedDocumentInfo:new C.X(m),officeDocumentSession:Q,wacBootDiagnostics:null===(e=null==Q?void 0:Q.diagnostics)||void 0===e?void 0:e.appInitDiagnostics}),c.complete();else if("cancelled"===n.completion)null==M||M.ULS.sendTraceTag(509646293,i.W.io,r.G.Info,"User cancelled document session boot");else{var t=n.completion,o={wacErrorName:f.AU.mo,qosErrorName:f.DG.QosError_EncounteredJsApiError,errorMessage:t,error:n.error},u=(0,y.x)(o),a=JSON.stringify(Array.from(u.entries()));null==M||M.ULS.sendTraceTag(575419404,i.W.io,r.G.Error,a),c.error(o)}})).catch((function(n){return null==M?void 0:M.ULS.sendTraceTag(512337547,i.W.io,r.G.Error,"officeDocumentSession.boot threw error: ".concat(n))}))}))}):(null==j||j.addOrUpdatePartCDimension("JsApiVersion","V1"),h=function(o){var s=o.container,l=o.flushTime;return new d.y((function(o){var c=(0,E.N6)(W?W.wac.userId:P,g,N,O,e,t,(0,E.q6)(m.wdValue),H),d=(0,E.EN)(m,W),v=(0,E.ge)(D,l,F,x,u.performance,t,null==e?void 0:e.featureGates),h=null==e?void 0:e.uiHostName,p=(0,E.v1)(W.wac),w=(0,E.UI)(s,u,p,c,d,v,(function(n,e){o.next({wopiHostData:W,officeApplication:n,bootedDocumentInfo:new C.X(m),wopiPendingApp:b,wacBootDiagnostics:e}),o.complete()}),(function(n){var e=n.errorObject.message,t={wacErrorName:f.AU.wo,qosErrorName:f.DG.QosError_EncounteredJsApiError,errorName:n.errorType,errorMessage:e,error:n},u=(0,y.x)(t),a=JSON.stringify(Array.from(u.entries()));null==M||M.ULS.sendTraceTag(575419405,i.W.io,r.G.Error,a),o.error(t)}),h,m,W,null==e?void 0:e.showCloseButton,null==e?void 0:e.supportsShare,null==e?void 0:e.openInBrowserEnabled,null==e?void 0:e.ellipsisDownloadACopyButtonEnabled,null==e?void 0:e.copyLinkEnabled,null==e?void 0:e.uiEmbed,null==e?void 0:e.supportsHostUiControls,null==e?void 0:e.conversationButtonEnabled,null==t?void 0:t.additionalApplicationParameters),S=(0,I.a)();null==M||M.ULS.sendTraceTag(576578583,i.W.io,r.G.Info,"BootStrapFile: About to call InitializeWopiPending");var b=n.Application.InitializeWopiPending(w,void 0,null==t?void 0:t.sessionId),A=(0,I.a)()-S;null==M||M.ULS.sendTraceTag(570775769,i.W.io,r.G.Info,"BootStrapFile: InitializeWopiPending returned. [IsValidWopiPendingApp: ".concat(!!b,"][TimeElapsed: ").concat(A,"]"));var T=(0,I.a)();if(b){a&&a(),b.Complete(p);var U=(0,I.a)(),k=U-T,R=U-S;null==M||M.ULS.sendTraceTag(570775770,i.W.io,r.G.Info,"BootStrapFile: Complete returned.[TimeElapsedInComplete: ".concat(k,"][TimeElapsedSinceInitializeWopiPending: ").concat(R,"]"))}else{var _={wacErrorName:f.AU.So,qosErrorName:f.DG.QosError_EncounteredJsApiError,errorMessage:"WOPI pending failed"},j=(0,y.x)(_),G=JSON.stringify(Array.from(j.entries()));o.error(_),null==M||M.ULS.sendTraceTag(575419406,i.W.io,r.G.Error,G)}}))}),p.next(h),p.complete()},v.r.isTwoStepCreateNew&&v.r.bootstrapperLoadPromise?v.r.bootstrapperLoadPromise.then((function(n){n?h(v.r.bootstrapper,v.r.bootstrapperInfo):null==M||M.ULS.sendTraceTag(507778322,i.W.io,r.G.Warning,"Office bootstrapper failed to load for 2-step create new, check previous logs for more details")})).catch((function(n){return null==M?void 0:M.ULS.sendTraceTag(507778321,i.W.io,r.G.Error,"Encountered error loading Office bootstrapper for 2-step create new: ".concat(n))})):(0,H.g)(J,W.wac.applicationUrl,R,!0,null==t?void 0:t.wiseEnvironment,M).then((function(n){var e=(0,o.CR)((0,H.n)(R),2),t=e[0],a=e[1];if(!a&&t)h(t,n);else{var s=null!=a?a:"Error message undefined. BootStrapped not loaded: ".concat(!t);null==M||M.ULS.sendTraceTag(575419403,i.W.io,r.G.Error,s);var l={wacErrorName:f.AU.bo,qosErrorName:f.DG.QosError_OfficeBootstrapperNotLoaded,errorMessage:s,error:a,inStaging:!1};u&&u(l)}})).catch((function(n){c(n)})),[2]}))}))}));Promise.race([z,Q]).catch((function(n){var e=(null!=n?n:"Failed to load the document")+", bootstrapperUrl: ".concat(J.replace(/^https?:\/\//,"")),t={wacErrorName:f.AU.So,qosErrorName:f.DG.QosError_FailedToLoadDocument,errorMessage:e,error:n,inStaging:!1};null==M||M.ULS.sendTraceTag(575419407,i.W.io,r.G.Error,"".concat(f.AU.So,": ").concat(e)),u&&u(t)}))}var R,F=t(1753);function P(n){return R?"".concat(n,".").concat(R.size):n}function N(n,e,t,a,s,l,p,m,w,S,b,I){if(void 0===p&&(p=!1),R||(R=new Map),!n.isNewFile||!n.createNewInfo){var C=(0,U.q_)(n);if(!C)return{correlationId:e,bootstrapperObservable:("Not enough document information was provided",new d.y((function(n){return n.error("Not enough document information was provided")}))),fileNamePromise:Promise.reject("No name was provided"),applicationUrlPromise:Promise.reject("No applicationUrl")};var A=R.get(C);if(A)return A}return function(n,e,t,a,s,l,d,p,m,w,S,b){var I,C;void 0===d&&(d=!1);var A=P(e),T=null==s?void 0:s.logger,y=new c,H=null!=b?b:k;if(!v.r.isTwoStepCreateNew||!v.r.hostSessionId||!(null==s?void 0:s.createNewParams)){var E=(0,F.o)(n,t,T,d,!(!n.isNewFile&&!n.templateId),1,!!(null==s?void 0:s.meeting));E.then((function(e){e.fetchedDocumentIdentifier.then((function(t){var i;H({documentBootInfo:(0,o.pi)((0,o.pi)({},n),t),correlationId:A,loadFunctionSubject:y,wopiFetchData:e},a,s,l,p,m,w,null===(i=null==S?void 0:S.get(n.fileType))||void 0===i?void 0:i.jsApiUrl)})).catch((function(n){null==T||T.ULS.sendTraceTag(509723932,i.W.io,r.G.Error,"Failed to fetch document identifier for document with error: ".concat(n)),v.r.isTwoStepCreateNew&&v.r.session&&v.r.session.run(u.O.completeCreateNew,{state:"failure",reason:"document identifier fetch failed"},w)}))})).catch((function(e){if(v.r.isTwoStepCreateNew&&v.r.session&&v.r.session.run(u.O.completeCreateNew,{state:"failure",reason:"wopiFetchFailed"},w),l){var t=JSON.stringify(e),o={wacErrorName:f.AU.Io,qosErrorName:f.DG.QosError_VroomWopiFailure,errorMessage:t,error:e,httpErrorCode:e.status,networkError:(0,h.eE)(e)};l(o,n)}}));var R={correlationId:A,bootstrapperObservable:y.asObservable(),fileNamePromise:n.fileName?Promise.resolve(n.fileName):E.then((function(n){return n.wopiHostData.fileName})),applicationUrlPromise:new Promise((function(n,e){E.then((function(e){var t,o;return n(null===(o=null===(t=null==e?void 0:e.wopiHostData)||void 0===t?void 0:t.wac)||void 0===o?void 0:o.applicationUrl)})).catch((function(n){e(n)}))}))};return s&&s.wiseEnvironment&&g(R.applicationUrlPromise,s.wiseEnvironment,T,s.health,null==a?void 0:a.featureGates,s.sessionId),R}H({documentBootInfo:n,correlationId:A,loadFunctionSubject:y,wopiFetchData:(0,U.PI)(s.createNewParams,n)},a,s,l,p,m,w,null===(I=null==S?void 0:S.get(n.fileType))||void 0===I?void 0:I.jsApiUrl);var N={correlationId:v.r.hostSessionId,bootstrapperObservable:y.asObservable(),fileNamePromise:Promise.resolve(n.fileName),applicationUrlPromise:Promise.resolve(null===(C=null==s?void 0:s.createNewParams)||void 0===C?void 0:C.appUrl)};return s&&s.wiseEnvironment&&g(N.applicationUrlPromise,s.wiseEnvironment,T,s.health,null==a?void 0:a.featureGates,s.sessionId),N}(n,e,t,a,s,l,p,m,w,S,b,I)}},9527:function(n,e,t){"use strict";t.d(e,{PI:function(){return f},VN:function(){return d},YI:function(){return c},q_:function(){return l},ss:function(){return v}});var o=t(533),i=t(3650),r=t(8643),u=t(6652),a=t(5665),s=t(2597);function l(n){return n.shareUrl?n.shareUrl:n.docId&&n.driveId?"".concat(n.driveId,"_").concat(n.docId):n.docUrl?n.docUrl:n.isNewFile&&n.fileName?"".concat(n.fileName,"_").concat(u.T[n.fileType]):n.baseUrl&&n.fileId?"".concat(n.baseUrl,"_").concat(n.fileId):void 0}function c(n,e){var t,u,a,s,l,c,d,f,v,h=!!(null==n?void 0:n.openWith),p=!!(null===(t=null==n?void 0:n.openWith)||void 0===t?void 0:t.wac);return null==e||e.ULS.sendTraceTag(553916429,i.W.io,r.G.Info,"GetWopiHostDataFromItem: [ValidOpenWith: ".concat(h,"][ValidWac: ").concat(p,"]")),{bundleStaleness:n.officeBundle?n.officeBundle.bundleStaleness:0,bundleUrl:n.officeBundle?n.officeBundle.url:"",bundleVersion:n.officeBundle?n.officeBundle.version:"",sharepointSiteUrl:n.sharepointIds?n.sharepointIds.siteUrl:"",downloadUrl:n["@content.downloadUrl"]||n["@microsoft.graph.downloadUrl"],eTag:n.eTag,fileName:n.name,fileSize:n.size,irmEnabled:(null===(u=n.file)||void 0===u?void 0:u.contentSensitivityLabelProtected)||(null===(a=n.file)||void 0===a?void 0:a.irmEffectivelyEnabled)||(null===(s=n.sensitivityLabel)||void 0===s?void 0:s.protectionEnabled)||(null===(l=n.file)||void 0===l?void 0:l.irmEnabled),protectionEnabled:(null===(c=n.sensitivityLabel)||void 0===c?void 0:c.protectionEnabled)||(null===(d=n.file)||void 0===d?void 0:d.contentSensitivityLabelProtected),isNewFile:!1,readOnly:n.currentUserRole&&n.currentUserRole.readOnly,blocksDownload:n.currentUserRole&&n.currentUserRole.blocksDownload,wac:n.openWith.wac,sharePointInfo:(0,o.pi)({},n.sharepointIds),webUrl:n.webUrl,preSeededSessionKey:null===(f=null==n?void 0:n.wacSession)||void 0===f?void 0:f.preSeededSessionKey,preSeededWacSessionId:null===(v=null==n?void 0:n.wacSession)||void 0===v?void 0:v.preSeededWacSessionId,webDavUrl:n.webDavUrl}}function d(n,e,t,i,r){var u,l,c,d,f,h,p,m,w,g,S,b,I,C,A,T,y,H,U,E,k,R,F,P,N;if(!n.appUrl)throw new Error("appUrl must be provided in CreateNewParams");return{appUrl:(0,s.e8)(void 0,n.appUrl,(null==i?void 0:i.uiHostName)||"OWL-2-step-create-new",e,null==i?void 0:i.uiEmbed),file:(0,o.pi)({name:null===(c=n.file)||void 0===c?void 0:c.name,getUrl:null===(d=n.file)||void 0===d?void 0:d.getUrl,size:null===(f=n.file)||void 0===f?void 0:f.size,eTag:null===(h=n.file)||void 0===h?void 0:h.eTag},e.docId&&{uniqueId:e.docId}),customFontCatalogUrl:n.customFontCatalogUrl,contentBundle:{majorVersion:(null===(p=n.contentBundle)||void 0===p?void 0:p.majorVersion)?Number(null===(m=n.contentBundle)||void 0===m?void 0:m.majorVersion):0,url:null!==(g=null===(w=n.contentBundle)||void 0===w?void 0:w.url)&&void 0!==g?g:"",staleness:(null===(S=n.contentBundle)||void 0===S?void 0:S.staleness)||0},newFileTemplate:e.newFileTemplate,container:t,bootParams:{readOnly:null===(b=n.bootParams)||void 0===b?void 0:b.readOnly,irmEnabled:null===(I=n.bootParams)||void 0===I?void 0:I.irmEnabled,supportsDecryptedContentDownload:null===(C=n.bootParams)||void 0===C?void 0:C.supportsDecryptedContentDownload,viewOnly:null===(A=n.bootParams)||void 0===A?void 0:A.viewOnly,disableChat:!0,openViewByDefault:"view"===e.intent,dataLanguage:e.dataCulture},diagnostics:(null===(T=null==r?void 0:r.bootDiagnostics)||void 0===T?void 0:T.legacyPerformanceData)?(0,o.pi)((0,o.pi)((0,o.pi)({},(0,s.xL)(null===(y=null==r?void 0:r.bootDiagnostics)||void 0===y?void 0:y.legacyPerformanceData.host,null===(H=null==r?void 0:r.bootDiagnostics)||void 0===H?void 0:H.legacyPerformanceData.owlFrame)),(0,s.YV)(e.clickTime,0,e.wdOrigin,void 0,null===(U=a.r.bootstrapperInfo)||void 0===U?void 0:U.performance,r,null==i?void 0:i.featureGates)),{legacyPerformanceData:null===(E=null==r?void 0:r.bootDiagnostics)||void 0===E?void 0:E.legacyPerformanceData}):(0,s.ge)(e.clickTime,0,e.wdOrigin,void 0,null===(k=a.r.bootstrapperInfo)||void 0===k?void 0:k.performance,r,null==i?void 0:i.featureGates),sessionContext:v(n.appUrl)||(0,s.l_)(),preseededSession:{key:null===(R=n.preseededSession)||void 0===R?void 0:R.key,id:null===(F=n.preseededSession)||void 0===F?void 0:F.id},wdParams:(0,o.pi)((0,o.pi)((0,o.pi)({},e.templateId&&(u={},u.wdTpl=e.templateId,u)),e.uiCulture&&(l={},l.wdlcid=e.uiCulture,l)),(0,s.q6)(e.wdValue)),hostGeneratedSessionId:null==r?void 0:r.sessionId,meeting:null==r?void 0:r.meeting,throttling:{protection:null===(P=n.throttling)||void 0===P?void 0:P.protection,request:null===(N=n.throttling)||void 0===N?void 0:N.request}}}function f(n,e){var t,o,i,r,u,s,l,c,d,f,v,h;return{fetchedDocumentIdentifier:Promise.resolve({docUrl:e.docUrl,driveId:e.driveId,docId:e.docId,fileName:null===(t=n.file)||void 0===t?void 0:t.name}),wopiHostData:{bundleStaleness:null===(o=n.contentBundle)||void 0===o?void 0:o.staleness,bundleUrl:null===(i=n.contentBundle)||void 0===i?void 0:i.url,bundleVersion:null===(r=n.contentBundle)||void 0===r?void 0:r.majorVersion.toString(),downloadUrl:null===(u=n.file)||void 0===u?void 0:u.getUrl,eTag:null===(s=n.file)||void 0===s?void 0:s.eTag,fileName:null===(l=n.file)||void 0===l?void 0:l.name,fileSize:null===(c=n.file)||void 0===c?void 0:c.size,irmEnabled:null===(d=n.bootParams)||void 0===d?void 0:d.irmEnabled,protectionEnabled:null===(f=n.bootParams)||void 0===f?void 0:f.supportsDecryptedContentDownload,isNewFile:!!e.isNewFile,readOnly:!!(null===(v=n.bootParams)||void 0===v?void 0:v.readOnly),blocksDownload:!!(null===(h=n.bootParams)||void 0===h?void 0:h.viewOnly),sharePointInfo:{},wac:{bootstrapperUrl:a.r.bootstrapperUrl,applicationUrl:n.appUrl,userId:e.puid}},fetchDiagnostics:{}}}function v(n,e){var t;try{t=new URLSearchParams(new URL(n).search).get("sc")||void 0}catch(n){null==e||e.ULS.sendTraceTag(520135565,i.W.io,r.G.Info,"Error trying to get session context from app URL: ".concat(JSON.stringify(n)))}return t}},2597:function(n,e,t){"use strict";t.d(e,{EN:function(){return m},N2:function(){return v},N6:function(){return p},UI:function(){return U},YV:function(){return b},ZR:function(){return T},e8:function(){return y},fG:function(){return g},ge:function(){return S},l_:function(){return h},q6:function(){return H},t1:function(){return A},v1:function(){return w},xL:function(){return I}});var o=t(533),i=t(3650),r=t(8643),u=t(9893),a=t(6652),s=t(274),l=t(394),c=t(5416),d=t(8807),f=t(5160),v="officecom";function h(){return JSON.stringify({pmo:window.location.origin,pmshare:!0,surl:void 0,curl:void 0,vurl:void 0,eurl:void 0})}function p(n,e,t,o,i,r,u,a){return{HostName:"office.com",HostSessionId:e,UserId:n,OwnerId:void 0,UiLocale:t,DataLocale:o,DisableChat:!0,CookieCompliant:!0,WdParams:u,DisableFocusOnBoot:!1,SessionContext:a||h(),HighContrastMode:null==r?void 0:r.highContrastMode,HideHeader:null==i?void 0:i.hideHeader,HideAppLauncherInHeader:null==i?void 0:i.hideAppLauncherInHeader,HideSearchInHeader:null==i?void 0:i.hideSearchInHeader,HideMeInHeader:null==i?void 0:i.hideMeInHeader,HideChatInHeader:null==i?void 0:i.hideChatInHeader,HideWorkflowInHeader:null==i?void 0:i.hideWorkflowInHeader,HideSettingsInHeader:null==i?void 0:i.hideSettingsInHeader,ShowAppIconInHeader:null==i?void 0:i.showAppIconInHeader,UseNeutralColorInHeader:null==i?void 0:i.useNeutralColorInHeader,SupportsDocReboot:null==i?void 0:i.supportsDocumentReboot,SupportsCreateNewDocument:null==i?void 0:i.supportsCreateNewDocument,SupportsAuthToken:null==i?void 0:i.supportsAuthToken,SupportsAtMentions:null==i?void 0:i.supportsAtMentions,SupportsMoveToFolder:null==i?void 0:i.supportsMoveToFolder,SupportsCommonFilePicker:null==i?void 0:i.supportsCommonFilePicker,SupportsDirectPrint:null==i?void 0:i.supportsDirectPrint,SupportsDirectDownload:null==i?void 0:i.supportsDirectDownload,MetaUiHostVersion:null==r?void 0:r.metaUiHostVersion,SupportsAccessibilityLoop:null==i?void 0:i.supportsAccessibilityLoop,SupportsExcelExternalLinks:null==i?void 0:i.supportsExcelExternalLinks,UiHostIntegrationType:null==i?void 0:i.uiHostIntegrationType,OpenLinksInNewWindow:null==i?void 0:i.openLinksInNewWindow,UiHostTabId:null==r?void 0:r.uiHostTabId,Upn:null==r?void 0:r.upn,TenantId:null==r?void 0:r.tenantId,Meeting:null==r?void 0:r.meeting,SupportsCustomAuthConfig:null==i?void 0:i.supportsCustomAuthConfig,ContentAssemblyMode:null==i?void 0:i.contentAssemblyMode,SupportsRefreshAccessToken:null==i?void 0:i.supportsRefreshAccessToken,IsSynthetic:null==r?void 0:r.isSynthetic,OwlVersion:null==r?void 0:r.owlVersion,OwlRollout:null==r?void 0:r.owlRollout}}function m(n,e){var t,i,r,u=n.docId,a=n.isNewFile,s=n.fileName,l=n.intent;return e?(0,o.pi)((0,o.pi)({FileName:e.fileName,FileGetUrl:(null===(t=e.wac)||void 0===t?void 0:t.fileGetUrl)||e.downloadUrl,CustomFontCatalogUrl:e.wac.customFontCatalogUrl,FileSize:e.fileSize,BundleInfo:{Url:e.bundleUrl,MajorVersion:e.bundleVersion,BundleStaleness:e.bundleStaleness},ReadOnly:e.readOnly,IrmEnabled:e.irmEnabled,ViewOnly:e.blocksDownload,ETag:e.eTag,ClientThrottlingProtection:null===(i=e.wac)||void 0===i?void 0:i.clientThrottlingProtection,RequestedCallThrottling:null===(r=e.wac)||void 0===r?void 0:r.requestedCallThrottling,IsNewFile:!!a||e.isNewFile},u&&{DocUniqueId:u}),{OpenViewByDefault:"view"===l}):(0,o.pi)({FileName:s,IsNewFile:!0},u&&{DocUniqueId:u})}function w(n){return{WopiSrc:n.wopiSrc,AccessToken:n.accessToken,AccessTokenExpiry:new Date(parseInt(n.accessTokenExpiry,10)),WacToken:n.wacToken}}function g(n){switch((0,l.aE)(n)){case l.o4.OneDrive:return"OneDrive";case l.o4.SharePoint:return"SharePoint Online";default:return"Unknown"}}function S(n,e,t,i,r,u,a){void 0===i&&(i={startTime:0,endTime:0}),void 0===r&&(r={startTime:0,endTime:0});var s=window.performance.timing,l=window.performance.navigation,c=l.redirectCount||0,d=s.navigationStart||0,f=s.fetchStart||0,v=s.responseEnd||0,h=s.requestStart||0,p=s.responseStart||0,m=s.responseEnd||0,w=s.domComplete||0,g="UNKNOWN";switch(l.type){case 0:g="NAVIGATE";break;case 1:g="RELOAD";break;case 2:g="BACK_FORWARD";break;case 255:g="RESERVED"}return(0,o.pi)((0,o.pi)({},b(n,e,t,i,r,u,a)),{hostPageNavigationStartTime:d,hostPageFetchStartTime:f,hostPageFetchEndTime:v,hostPageRequestStartTime:h,hostPageResponseStartTime:p,hostPageResponseEndTime:m,hostPageDomCompleteTime:w,hostPageRedirectCount:c,hostPageNavigationType:g})}function b(n,e,t,a,l,d,v){void 0===a&&(a={startTime:0,endTime:0}),void 0===l&&(l={startTime:0,endTime:0});var h=l.startTime||0,p=l.endTime||0,m=(0,u.a)();(0,u.l)("officeInitializationTime");var w,g,S=null==d?void 0:d.logger,b=(null==d?void 0:d.bootDiagnostics)||{},I=b.tabsCacheHit,C=b.packageEntryTime,A=b.isTestMode,T=b.ringId;n&&(w=m-n),C&&(g=m-C);var y=(0,o.pi)((0,o.pi)((0,o.pi)({},b),s.c),{bootStrapStartTime:(null==l?void 0:l.startTime)||0,bootStrapEndTime:(null==l?void 0:l.endTime)||0,wopiDataStartTime:(null==a?void 0:a.startTime)||0,wopiDataEndTime:(null==a?void 0:a.endTime)||0,isCookieBlocked:!c.X,createNewEndTime:b.createNewStartTime?(0,u.a)():void 0,owlFeatureGates:v?(0,f.d)(v):void 0});return s.c.accessTokenStartTime=void 0,s.c.accessTokenEndTime=void 0,s.c.driveItemStartTime=void 0,s.c.driveItemEndTime=void 0,s.c.driveItemFromWacStartTime=void 0,s.c.driveItemFromWacEndTime=void 0,s.c.spRequestGuid=void 0,s.c.createNewStartTime=void 0,s.c.createNewEndTime=void 0,s.c.loadManifestStartTime=void 0,s.c.loadManifestEndTime=void 0,s.c.getManifestFromRemoteTimeElapsed=void 0,s.c.loadManifestServerTimeElapsed=void 0,s.c.loadOwlStartTime=void 0,s.c.loadOwlEndTime=void 0,s.c.isVroom21=!1,null==S||S.ULS.sendTraceTag(556613895,i.W.io,r.G.Info,"getDiagnostics: [SessionOrigin: ".concat(t,"][TabsCacheHit: ").concat(I,"][IsTestMode: ").concat(A,"][RingId: ").concat(T,"][TimeElapsedSinceUserClick:").concat(w,"][TimeElapsedSincePackageEntry: ").concat(g,"]")),{entryPoint:t,hostPageFirstFlushTime:e,userClickTime:n,officeBootstrapperStartTime:h,officeBootstrapperEndTime:p,officeInitializationTime:m,unifiedUiHostDiagnostics:y}}function I(n,e){var t="UNKNOWN";switch(null==n?void 0:n.navigation.type){case 0:t="NAVIGATE";break;case 1:t="RELOAD";break;case 2:t="BACK_FORWARD";break;case 255:t="RESERVED"}var o="UNKNOWN";switch(null==e?void 0:e.navigation.type){case 0:o="NAVIGATE";break;case 1:o="RELOAD";break;case 2:o="BACK_FORWARD";break;case 255:o="RESERVED"}return{hostPageNavigationStartTime:(null==n?void 0:n.timing.navigationStart)||0,hostPageFetchStartTime:(null==n?void 0:n.timing.fetchStart)||0,hostPageFetchEndTime:(null==n?void 0:n.timing.responseEnd)||0,hostPageRequestStartTime:(null==n?void 0:n.timing.responseEnd)||0,hostPageResponseStartTime:(null==n?void 0:n.timing.responseStart)||0,hostPageResponseEndTime:(null==n?void 0:n.timing.responseEnd)||0,hostPageDomCompleteTime:(null==n?void 0:n.timing.domComplete)||0,hostPageRedirectCount:(null==n?void 0:n.navigation.redirectCount)||0,hostPageNavigationType:t,owlFramePageNavigationStartTime:(null==e?void 0:e.timing.navigationStart)||0,owlFramePageFetchStartTime:(null==e?void 0:e.timing.fetchStart)||0,owlFramePageFetchEndTime:(null==e?void 0:e.timing.responseEnd)||0,owlFramePageRequestStartTime:(null==e?void 0:e.timing.responseEnd)||0,owlFramePageResponseStartTime:(null==e?void 0:e.timing.responseStart)||0,owlFramePageResponseEndTime:(null==e?void 0:e.timing.responseEnd)||0,owlFramePageDomCompleteTime:(null==e?void 0:e.timing.domComplete)||0,owlFramePageRedirectCount:(null==e?void 0:e.navigation.redirectCount)||0,owlFramePageNavigationType:o}}var C=function(n){var e=new URL(n);return e.searchParams.delete("wopisrc"),e.href};function A(n){return function(e){var t=e;switch(e){case"OfficeComWordJsApiV2":case"OfficeComExcelJsApiV2":case"OfficeComPptJsApiV2":return!0;case"OfficeUnifiedUiHostTeams":t="unifiedUiHostInTeams"}if((null==n?void 0:n.experiments)&&t in(null==n?void 0:n.experiments))return function(n){switch(n){case 0:return!1;case 1:return!0;default:return}}(null==n?void 0:n.experiments[t])}}function T(n,e,t){switch(n){case a.T.Word:case a.T.PowerPoint:case a.T.Excel:case a.T.Visio:return!0;case a.T.OneNote:var o=(0,d.vJ)(d.Fh.FeatureGate_OneNoteJsApiV2Gate,e);return(0,d.dt)(d.Fh.FeatureGate_OneNoteJsApiV2Gate,o,t),o;default:return!1}}function y(n,e,t,o,i){var r,u,a=n?(null===(r=n.wac)||void 0===r?void 0:r.applicationUrl)||(null===(u=n.wac)||void 0===u?void 0:u.editUrl):C(e);return a?function(n,e,t,o,i,r){var u="".concat(n,"&uih=").concat(e);return(null==r||r)&&(u="".concat(u,"&uiEmbed=1")),o&&(u="".concat(u,"&wdTpl=").concat(o)),i&&(u="".concat(u,"&wdlcid=").concat(i)),t&&(u="".concat(u,"&actNavId=").concat(t)),u}(a,t,o.navId,o.templateId,o.rebootOverrideData?o.rebootOverrideData.lcid:o.uiCulture,i):""}function H(n){var e;return n?((e={}).wd=encodeURIComponent(n),e):{}}function U(n,e,t,i,r,u,a,s,l,c,d,f,v,h,p,m,w,g,S,b){var I=e.applicationUrl,C=e.bootstrapperUrl;void 0===l&&(l="officecom"),void 0===b&&(b={});var T={HostUIControls:g?[{id:"close",visibility:f?1:0},{id:"share",visibility:v?1:0},{id:"ellipsisOpenInBrowser",visibility:h?1:0},{id:"ellipsisDownload",visibility:p?1:0},{id:"copyLink",visibility:m?1:0},{id:"conversation",visibility:S?1:0}]:void 0,additionalApplicationParameters:b},H=y(d,I,l,c,w);return(0,o.pi)({BootstrapperUrl:C,Container:n,SessionInformation:i,ApplicationUrl:H,WopiPrecheckInfo:r,ApplicationCustomSettings:T,Diagnostics:u,FnOnInitializeSuccess:a,FnOnInitializeFailure:s,FnIsFeatureEnabled:A(),RebootOverrideData:c.rebootOverrideData},t?{WopiInfo:t}:{})}},1877:function(n,e,t){"use strict";t.d(e,{R:function(){return a}});var o=t(3650),i=t(8643),r=t(807),u=t(5358);function a(n,e,t,a,s){if(a){var l=function(n){switch(n){case r.KX.PostMessage_RefreshSessionInfo:return u.O.sendSessionInfo;case r.KX.PostMessage_GrantPermissions:return u.O.sendUserAccessAndPermissions;case r.KX.PostMessage_SetAuthToken:return u.O.sendAuthToken;case r.KX.PostMessage_HostAccessibilityLoopComplete:return u.O.continueAccessibilityLoop;case r.KX.PostMessage_SetHostWopiInfoFromUrl:return u.O.sendWopiInfo;case r.KX.PostMessage_MoveToFolderCompleted:return u.O.moveToFolder;case r.KX.PostMessage_CompleteFilePicker:return u.O.completeSharedFilePicker;case r.KX.PostMessage_SendCustomAuthConfig:return u.O.sendCustomAuthConfig;case r.KX.PostMessage_SetDavUrlFromIds:return u.O.sendDavUrl;case r.KX.PostMessage_BlurFocus:return u.O.blurFocus;case r.KX.PostMessage_PopState:return u.O.popState;case r.KX.PostMessage_GrabFocus:return u.O.grabFocus;case r.KX.PostMessage_HostGetClientUrl:return u.O.getClientUrl;case r.KX.PostMessage_HostGetWebUrl:return u.O.getWebUrl;case r.KX.PostMessage_OwlFrameDiagnostics:return u.O.sendOwlFrameDiagnostics;case r.KX.PostMessage_HostBackButtonPressed:return u.O.backButtonPressed;case r.KX.PostMessage_HostSendChannelId:return u.O.sendChannelId;case r.KX.PostMessage_HostSendConversationId:return u.O.sendConvId;case r.KX.PostMessage_PostWacToken:return u.O.postWacToken;default:return}}(n);if(l){var c=l;a.run(c,e).catch((function(n){return null==s?void 0:s.ULS.sendTraceTag(512337544,o.W.io,i.G.Warning,"Failed to send post message. officeDocumentSession.run returned error: ".concat(n))}))}}else t?t.then((function(t){t?function(n,e,t,r){var u,a=null;try{a=new URL(n)}catch(e){return void(null==r||r.ULS.sendTraceTag(541180047,o.W.io,i.G.Warning,"Failed to send post message. could not create url from ".concat(n," with error: ").concat(e)))}var s=a.origin,l={MessageId:e,SendTime:(new Date).getTime(),Values:t},c=JSON.stringify(l),d=document.getElementById("WebApplicationFrame");d?null===(u=null==d?void 0:d.contentWindow)||void 0===u||u.postMessage(c,s):null==r||r.ULS.sendTraceTag(541180048,o.W.io,i.G.Warning,"Failed to send post message. Could not find iframe")}(t,n,e,s):null==s||s.ULS.sendTraceTag(541180045,o.W.io,i.G.Warning,"Failed to send post message. appUrl is null")})).catch((function(n){return null==s?void 0:s.ULS.sendTraceTag(512337543,o.W.io,i.G.Warning,"Failed to send post message. appUrlPromise failed to resolve with error: ".concat(n))})):null==s||s.ULS.sendTraceTag(541180046,o.W.io,i.G.Warning,"Failed to send post message. Both documentSession and appUrlPromise are null")}},7125:function(n,e,t){"use strict";var o;function i(n){var e=n.toUpperCase();return"CHC"===e||"DEC"===e||"EUC"===e||"EURPPC"===e||"FRC"===e||"SEC"===e||"NOC"===e?o.EuropeanUnion:o.RestOfWorld}t.d(e,{U:function(){return o},g:function(){return i}}),function(n){n[n.RestOfWorld=0]="RestOfWorld",n[n.EuropeanUnion=1]="EuropeanUnion"}(o||(o={}))},2022:function(n,e,t){"use strict";t.d(e,{A8:function(){return s},PO:function(){return l},S$:function(){return u},XQ:function(){return a},Y6:function(){return d},fy:function(){return r},tf:function(){return f},w8:function(){return c},wl:function(){return i}});var o=t(7125);function i(n,e){switch(n){case"FASTFOOD":return"https://ffc-common.online.office.com/suite/";case"MSIT":return"https://ppc-common.online.office.com/suite/";case"PRODUCTION":default:return e===o.U.EuropeanUnion?"https://euc-common.online.office.com/suite/":"https://common.online.office.com/suite/";case"GALLATIN":return"https://common.partner.officewebapps.cn/suite/";case"USGOV":return"https://gbc-common.online.office.com/suite/";case"TRAILBLAZER":return"https://common.gov.online.office365.us/suite/";case"PATHFINDER":return"https://common.dod.online.office365.us/suite/";case"AIRGAP08":return"https://common.wac.online.office.eaglex.ic.gov/suite/";case"AIRGAP09":return"https://common.wac.online.office.microsoft.scloud/suite/"}}function r(n,e){return i(n,e)+"RemoteUls.ashx"}function u(n,e,t){var o=i(n,t)+"RemoteTelemetry.ashx";return e&&(o+="?usid="+e),o}function a(n,e){return"".concat(i(n),"OpenDocument.ashx").concat(e?"?corrid=".concat(e,"&usid=").concat(e):"")}function s(n){switch(n){case"GALLATIN":return"https://microsoftgraph.chinacloudapi.cn";case"TRAILBLAZER":return"https://graph.microsoft.us";case"PATHFINDER":return"https://dod-graph.microsoft.us";case"AIRGAP08":return"https://graph.eaglex.ic.gov";case"AIRGAP09":return"https://graph.microsoft.scloud";default:return"https://graph.microsoft.com"}}function l(n){switch(n){case"TRAILBLAZER":return"https://admin.onedrive.us/share";case"PATHFINDER":return"https://od.apps.mil/share";case"AIRGAP08":return"https://odweba.svc.ms.eaglex.ic.gov";case"AIRGAP09":return"https://odweba.svc.ms.microsoft.scloud";default:return"https://www.odwebp.svc.ms/share"}}function c(){return"res.cdn.office.net/officehub"}function d(){return"https://microsoft-my.sharepoint.com"}function f(){return"https://microsoft.sharepoint.com"}},7971:function(n,e,t){"use strict";var o;t.d(e,{W:function(){return o}}),function(n){n[n.Unknown=0]="Unknown",n[n.OK=200]="OK",n[n.Created=201]="Created",n[n.NoContent=204]="NoContent",n[n.Unauthorized=401]="Unauthorized",n[n.Forbidden=403]="Forbidden",n[n.NotFound=404]="NotFound",n[n.RequestTimeout=408]="RequestTimeout",n[n.RequestEntityTooLarge=413]="RequestEntityTooLarge",n[n.UnsupportedMediaType=415]="UnsupportedMediaType",n[n.RangeNotSatisfiable=416]="RangeNotSatisfiable",n[n.Locked=423]="Locked",n[n.Throttled=429]="Throttled",n[n.InternalServiceError=500]="InternalServiceError",n[n.NotImplemented=501]="NotImplemented",n[n.ServiceUnavailable=503]="ServiceUnavailable",n[n.GatewayTimeout=504]="GatewayTimeout",n[n.InsufficientStorage=507]="InsufficientStorage",n[n.UnexpectedResponse=700]="UnexpectedResponse",n[n.TokenRefreshFailed=701]="TokenRefreshFailed",n[n.TokenUnavailable=702]="TokenUnavailable",n[n.RetryFailed=703]="RetryFailed",n[n.AlternateResponse=704]="AlternateResponse",n[n.Cancelled=705]="Cancelled",n[n.Offline=706]="Offline",n[n.Timeout=707]="Timeout",n[n.DecryptionError=708]="DecryptionError",n[n.CacheMiss=709]="CacheMiss"}(o||(o={}))},807:function(n,e,t){"use strict";var o,i,r,u,a,s;t.d(e,{Bn:function(){return a},Dm:function(){return i},E_:function(){return o},KX:function(){return u}}),function(n){n.Event_DocumentReboot="DocReboot",n.Event_SetOverlayContent="SetOverlayContent",n.Event_GetWopiInfoFromUrl="WopiInfoFromUrl",n.Event_Unloaded="Unloaded",n.Event_MoveToFolder="MoveToFolder",n.Event_SharedFilePicker="FilePicker",n.Event_GetCustomAuthConfig="GetCustomAuthConfig",n.Event_GetDavUrlFromIds="DavUrlFromIds"}(o||(o={})),function(n){n.PostMessage_FileRenamed="File_Rename",n.PostMessage_Close="UI_Close",n.PostMessage_EditModeSwitch="UI_Edit",n.PostMessage_FileVersion="UI_FileVersions",n.PostMessage_SaveStatus="UI_SaveStatus",n.PostMessage_Share="UI_Sharing",n.PostMessage_Workflow="UI_Workflow",n.PostMessage_UserActivity="User_Activity",n.PostMessage_EditNotification="Edit_Notification",n.PostMessage_CheckUserAccess="UI_CheckUserAccessAndGrantPermissions",n.PostMessage_PostMessageDocReboot="App_DocReboot",n.PostMessage_AppRefreshSessionInfo="App_RefreshSessionInfo",n.PostMessage_AppCreateNewDocument="App_CreateNewDocument",n.PostMessage_GetAuthToken="App_GetAuthToken",n.PostMessage_NavigateBackToHost="NavigateBackToHost",n.PostMessage_SendConversationId="App_SendConversationId",n.PostMessage_CloseTeamsConversation="CloseTeamsConversation",n.PostMessage_AccessibilityLoopComplete="App_AccessibilityLoopComplete",n.PostMessage_GetClientUrlComplete="App_GetClientUrlComplete",n.PostMessage_GetWebUrlComplete="App_GetWebUrlComplete",n.PostMessage_LoadingStatus="App_LoadingStatus",n.PostMessage_ActionComplete="Wac_ActionComplete",n.PostMessage_OpenInBrowser="UI_OpenInBrowser",n.PostMessage_AppGetCustomAuthConfig="App_GetCustomAuthConfig",n.PostMessage_AppPushState="App_PushState",n.PostMessage_CAAEMessage="CAAEMessage",n.PostMessage_FileEmbed="UI_FileEmbed"}(i||(i={})),function(n){n.Nav="actnavid"}(r||(r={})),function(n){n.PostMessage_RefreshSessionInfo="Host_RefreshSessionInfo",n.PostMessage_GrantPermissions="CheckUserAccessAndGrantPermissions_Result",n.PostMessage_SetOverlayContent="SetOverlayContent",n.PostMessage_SetAuthToken="Host_SetAuthToken",n.PostMessage_SetHostWopiInfoFromUrl="Host_WopiInfoFromUrl",n.PostMessage_HostAccessibilityLoopComplete="Host_AccessibilityLoopComplete",n.PostMessage_HostGetClientUrl="Host_GetClientUrl",n.PostMessage_HostGetWebUrl="Host_GetWebUrl",n.PostMessage_MoveToFolderCompleted="Host_MoveToFolder",n.PostMessage_CompleteFilePicker="Host_FilePicker",n.PostMessage_SendCustomAuthConfig="Host_SetCustomAuthConfig",n.PostMessage_SetDavUrlFromIds="Host_DavUrlFromIds",n.PostMessage_BlurFocus="Blur_Focus",n.PostMessage_PopState="App_PopState",n.PostMessage_GrabFocus="Grab_Focus",n.PostMessage_OwlFrameDiagnostics="OwlFrameDiagnostics",n.PostMessage_HostSendChannelId="Host_SendChannelId",n.PostMessage_HostBackButtonPressed="Host_BackButtonPressed",n.PostMessage_HostSendConversationId="Host_SendConversationId",n.PostMessage_PostWacToken="Host_PostWacToken"}(u||(u={})),function(n){n.SameDocument="0",n.NewDocument="1"}(a||(a={})),function(n){n.AccessToken="AccessToken",n.FileGetUrl="FileGetUrl"}(s||(s={}))},8389:function(n,e,t){"use strict";t.d(e,{G2:function(){return a},pb:function(){return l},vb:function(){return c},zP:function(){return s}});var o=t(533),i=t(2818),r=t(8404),u=t(2022),a=function(){function n(n,e){var t;"string"==typeof n?this.sessionId=n:(t=(0,o.CR)(n,1),this.sessionId=t[0]),this.environment=e,this.logger=this.setUlsLogger(this.sessionId)}return n.prototype.setUlsLogger=function(n){var e=(0,u.fy)(this.environment);return(0,i.L8)({remoteUlsEndpoint:e,sessionId:n})},n}(),s=function(n,e,t,o,i,a){var s,l=(0,u.S$)(t,n),c={application:e.toString(),applicationMode:"UnifiedUiHost",applicationModeExtended:"UNIFIEDUIHOST",session_id:n,clientVersion:null!=o?o:"n/a",isSynthetic:a};this.health=r.S9.getInstance(),this.health.initialize({isHealthEnabled:!0,isOfflineEnabled:!1,remoteTelemetryUrl:l,dimensions:c}),this.health.addOrUpdatePartCDimension("UUIHTargetApp",e.toString()),this.health.addOrUpdatePartCDimension("HealthSourceComponent","UnifiedUiHost"),this.health.addOrUpdatePartCDimension("WiseEnvironment",t.toString()),this.health.addOrUpdatePartCDimension("Exposure",null!==(s=null==i?void 0:i.toString())&&void 0!==s?s:"n/a")};function l(){var n,e=null===(n=performance.getEntriesByType("navigation")[0])||void 0===n?void 0:n.toJSON();return{connectEnd:e.connectEnd,connectStart:e.connectStart,decodedBodySize:e.decodedBodySize,domainLookupEnd:e.domainLookupEnd,domainLookupStart:e.domainLookupStart,domComplete:e.domComplete,domContentLoadedEventEnd:e.domContentLoadedEventEnd,domContentLoadedEventStart:e.domContentLoadedEventStart,domInteractive:e.domInteractive,duration:e.duration,encodedBodySize:e.encodedBodySize,entryType:e.entryType,fetchStart:e.fetchStart,initiatorType:e.initiatorType,loadEventEnd:e.loadEventEnd,loadEventStart:e.loadEventStart,nextHopProtocol:e.nextHopProtocol,redirectCount:e.redirectCount,redirectEnd:e.redirectEnd,redirectStart:e.redirectStart,requestStart:e.requestStart,responseEnd:e.responseEnd,responseStart:e.responseStart,secureConnectionStart:e.secureConnectionStart,serverTiming:e.serverTiming,startTime:e.startTime,transferSize:e.transferSize,type:e.type,unloadEventEnd:e.unloadEventEnd,unloadEventStart:e.unloadEventStart,workerStart:e.workerStart}}function c(){var n=window.performance.timing,e=window.performance.navigation,t={};return n&&(t.timing={navigationStart:n.navigationStart,redirectStart:n.redirectStart,redirectEnd:n.redirectEnd,fetchStart:n.fetchStart,domainLookupStart:n.domainLookupStart,domainLookupEnd:n.domainLookupEnd,connectStart:n.connectStart,connectEnd:n.connectEnd,secureConnectionStart:n.secureConnectionStart,requestStart:n.requestStart,responseStart:n.responseStart,responseEnd:n.responseEnd,domLoading:n.domLoading,domInteractive:n.domInteractive,domContentLoadedEventStart:n.domContentLoadedEventStart,domContentLoadedEventEnd:n.domContentLoadedEventEnd,domComplete:n.domComplete,loadEventStart:n.loadEventStart,loadEventEnd:n.loadEventEnd}),e&&(t.navigation={type:e.type,redirectCount:e.redirectCount}),t}},274:function(n,e,t){"use strict";var o,i,r,u,a,s;t.d(e,{$c:function(){return o},AU:function(){return a},DG:function(){return u},I$:function(){return s},J4:function(){return l},NF:function(){return c},c:function(){return d},cS:function(){return r},yv:function(){return i}}),function(n){n.DriveId="drive",n.ItemId="item",n.DocUrl="file",n.ContentUri="contenturi",n.Nav="nav"}(o||(o={})),function(n){n.Co="DavUrlFromIds",n.Ao="WopiAuthRefresh",n.To="WopiAuthFetch",n.yo="WopiInfoFromUrl"}(i||(i={})),function(n){n.QosVeto_ShareDialogExperienceDegraded="ShareDialogExperienceDegraded",n.QosVeto_CreateNewExperienceDegraded="CreateNewExperienceDegraded",n.QosVeto_ExternalLinksExperienceDegraded="ExternalLinksExperienceDegraded",n.QosVeto_WopiAuthExperienceDegraded="WopiAuthExperienceDegraded",n.QosVeto_FilePickerFailed="FilePickerFailed",n.QosVeto_OpenInExperienceFailed="OpenInExperienceFailed",n.QosVeto_OwlFrameExperienceFailed="OwlFrameExperienceFailed"}(r||(r={})),function(n){n.QosError_VroomWopiFailure="VroomWopiFailure",n.QosError_OfficeBootstrapperNotLoaded="OfficeBootstrapperNotLoaded",n.QosError_EncounteredJsApiError="EncounteredJsApiError",n.QosError_FailedToLoadDocument="FailedToLoadDocument",n.QosError_AttemptingToBootDocumentFailed="AttemptingToBootDocumentFailed",n.QosError_DavUrlFromIdsFailure="DavUrlFromIdsFailure",n.QosError_ShareDialogHandlerInitFailure="ShareDialogHandlerInitFailure",n.QosError_ShareDialogHandlerHostReportedFailure="ShareDialogHandlerHostReportedFailure",n.QosError_ShareDialogHandlerGenericFailure="ShareDialogHandlerGenericFailure",n.QosError_ShareDialogHandlerPerfFailure="ShareDialogHandlerPerfFailure",n.QosError_CreateNewHandlerRebootSessionFailure="CreateNewHandlerRebootSessionFailure",n.QosError_CreateNewHandlerCreateDocumentFailure="CreateNewHandlerCreateDocumentFailure",n.QosError_CreateNewHandlerEndSessionFailure="CreateNewHandlerEndSessionFailure",n.QosError_CreateNewHandlerGenericFailure="CreateNewHandlerGenericFailure",n.QosError_WopiRefreshAuthTokenFailure="WopiRefreshAuthTokenFailure",n.QosError_WopiFetchAuthTokenFailure="WopiFetchAuthTokenFailure",n.QosError_WopiInfoFromUrlFailure="WopiInfoFromUrlFailure",n.QosError_FilePickerBootFailed="FilePickerBootFailed",n.QosError_RetrievingWopiHostDataFailed="RetrievingWopiHostDataFailed",n.QosError_SelectedItemNotReturned="SelectedItemNotReturned",n.QosError_SelectedItemMissingProperties="SelectedItemMissingProperties",n.QosError_UrlNotProvided="UrlNotProvided",n.QosError_CallbackNotDefined="CallbackNotDefined",n.QosError_OwlFrameCreationFailure="OwlFrameCreationFailure"}(u||(u={})),function(n){n.po="Bootstrapfile_WacDocumentVroomError",n.Io="LoadDocument_WacDocumentVroomError",n.bo="WacDocumentBootstrapperLoadError",n.So="WacInitializeWopiPendingError",n.Ho="WacDocumentGenericBootError",n.wo="WacDocumentJsApiV1Error",n.mo="WacDocumentJsApiV2Error"}(a||(a={})),function(n){n.PermissionError="PermissionError",n.NotFound="NotFound",n.Throttling="Throttling",n.Offline="Offline",n.Other="Other"}(s||(s={}));var l,c,d={};!function(n){n.New="NEW",n.BackstageMru="BACKSTAGE-MRU",n.Reboot="REBOOT"}(l||(l={})),function(n){n.SharePointOnline="sharepoint",n.OneDriveConsumer="onedrive",n.Graph="graph"}(c||(c={}))},5665:function(n,e,t){"use strict";t.d(e,{f:function(){return v},r:function(){return f}});var o=t(533),i=t(3650),r=t(8643),u=t(2597),a=t(8587),s=t(4723),l=t(9527),c=t(5358),d=t(2182),f=function(){function n(){}return Object.defineProperty(n,"isCreateNewFlowExecuting",{get:function(){return!!(n.isTwoStepCreateNew&&n.createNewFlowExecuting&&n.hostSessionId&&n.bootstrapper&&n.bootstrapperLoadPromise&&n.bootstrapperUrl&&n.bootstrapperInfo&&n.application&&n.session)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"isCreateNewFlowExecutingForJsApiBundledWithOwl",{get:function(){return!!(n.isTwoStepCreateNew&&n.createNewFlowExecuting&&n.hostSessionId&&n.bootstrapperUrl&&n.application&&n.session)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"completeCreateNewPromise",{get:function(){return n.Uo},enumerable:!1,configurable:!0}),n.completeCreateNew=function(n){this.Eo.resolve&&this.Eo.resolve(n)},n.failCreateNew=function(n){this.Eo.reject&&this.Eo.reject(n)},n.isTwoStepCreateNew=!1,n.createNewFlowExecuting=!1,n.Eo={},n.Uo=new Promise((function(e,t){n.Eo.resolve=e,n.Eo.reject=t})),n}();function v(n,e){var t,v,h,p;if(f.isTwoStepCreateNew=!!(n.documentBootInfo.isNewFile&&n.documentBootInfo.isTwoStepCreateNew&&n.sessionConfig.createNewParams&&n.sessionConfig.createNewParams.appUrl&&(0,u.ZR)(n.documentBootInfo.fileType,null===(t=n.uiHostConfig)||void 0===t?void 0:t.featureGates,e)&&(null===(v=n.initPackageParams)||void 0===v?void 0:v.jsApiUrlInfos)&&(null===(h=n.initPackageParams)||void 0===h?void 0:h.jsApiUrlInfos.get(n.documentBootInfo.fileType))),f.isTwoStepCreateNew){var m=n.initPackageParams.jsApiUrlInfos.get(n.documentBootInfo.fileType);m?(f.bootstrapperUrl=m.jsApiUrl,f.hostSessionId=(0,a.Zl)(n.sessionConfig.hostCorrelationId),f.bootstrapperLoadPromise=(0,s.g)(m.jsApiUrl,n.sessionConfig.createNewParams.appUrl,n.documentBootInfo.fileType,!0,n.sessionConfig.wiseEnvironment,e).then((function(t){var u=(0,o.CR)((0,s.n)(n.documentBootInfo.fileType),2),a=u[0],v=u[1];if(v||!a||!f.hostSessionId)return null==e||e.ULS.sendTraceTag(507778318,i.W.io,r.G.Warning,"Failed to load bootstrapper for ".concat(n.documentBootInfo.fileType," in 2-step create new flow. Error: ").concat(v)),!1;f.bootstrapper=a,f.bootstrapperInfo=t,f.application=a.createApplication((0,d.Z)(n.documentBootInfo,f.bootstrapperInfo.bootstrapperUrl,n.uiHostConfig,n.sessionConfig)),f.session=f.application.createSession({hostSessionId:f.hostSessionId}),f.createNewFlowExecuting=!0;var h=(0,l.VN)(n.sessionConfig.createNewParams,n.documentBootInfo,n.container,n.uiHostConfig,n.sessionConfig);return f.session.run(c.O.createNew,h).catch((function(n){null==e||e.ULS.sendTraceTag(507778317,i.W.io,r.G.Warning,"Caught error running create new flow: ".concat(n)),f.createNewFlowExecuting=!1})),!0})).catch((function(t){return null==e||e.ULS.sendTraceTag(507778316,i.W.io,r.G.Warning,"Failed to load bootstrapper for ".concat(n.documentBootInfo.fileType," in 2-step create new flow. Error: ").concat(t)),!1}))):null==e||e.ULS.sendTraceTag(507778319,i.W.io,r.G.Warning,"jsapiBootstrapperUrl for ".concat(n.documentBootInfo.fileType," is undefined in ").concat(null===(p=n.uiHostConfig)||void 0===p?void 0:p.uiHostName))}}},43:function(n,e,t){"use strict";t.d(e,{SS:function(){return r},Yf:function(){return u},eE:function(){return i},mN:function(){return a}});var o=t(274);function i(n){return!(!n||!n.failure)&&"TypeError: Failed to fetch"===n.failure}function r(n){switch(n){case o.AU.po:case o.AU.Io:return!1;default:return!0}}function u(n,e){if(e)return!0;if(!n)return!1;switch(n){case 401:case 403:case 404:case 429:return!0;default:return!1}}function a(n,e){if(e)return o.I$.Offline;switch(n){case 401:case 403:return o.I$.PermissionError;case 404:return o.I$.NotFound;case 429:return o.I$.Throttling;default:return o.I$.Other}}},8807:function(n,e,t){"use strict";t.d(e,{Fh:function(){return v},vJ:function(){return w},i0:function(){return g},dt:function(){return m}});var o=t(3650),i=t(8643),r=function(){function n(){}return n.toFeatureGateConfig=function(n,e){if(null==n||""===n||"null"===n)return[];try{return function(n,e,t){return l(n,e,a,t)}(JSON.parse(n),c(d("FeatureGateConfig")),e)}catch(t){return null==e||e.ULS.sendTraceTag(521413921,o.W.io,i.G.Error,'Unable to parse JSON string: "'.concat(n,'", due to expection: ').concat(t)),[]}},n.featureGateConfigToJson=function(n,e){return JSON.stringify(function(n,e,t){return l(n,e,s,t)}(n,c(d("FeatureGateConfig")),e),null,2)},n}();function u(n,e,t,r){if(void 0===r&&(r=""),r?null==t||t.ULS.sendTraceTag(521414033,o.W.io,i.G.Error,'Invalid value for key "'.concat(r,'". Expected type ').concat(JSON.stringify(n)," but got ").concat(JSON.stringify(e))):null==t||t.ULS.sendTraceTag(521414034,o.W.io,i.G.Error,"Invalid value ".concat(JSON.stringify(e)," for type ").concat(JSON.stringify(n))),"boolean"==typeof n){if("string"==typeof e){var u=function(n){try{var e=JSON.parse(n.toLowerCase());return"boolean"==typeof e&&e}catch(n){return!1}}(e);if("boolean"==typeof u)return u}return!1}return"string"==typeof n?"":"number"==typeof n?0:typeof n==typeof[]?[]:"Date"===n?new Date:"array"===n?[]:"object"===n?{}:void 0}function a(n){if(void 0===n.jsonToJS){var e={};n.props.forEach((function(n){return e[n.json]={key:n.js,typ:n.typ}})),n.jsonToJS=e}return n.jsonToJS}function s(n){if(void 0===n.jsToJSON){var e={};n.props.forEach((function(n){return e[n.js]={key:n.json,typ:n.typ}})),n.jsToJSON=e}return n.jsToJSON}function l(n,e,t,o,i){void 0===i&&(i="");var r=e;if("any"===r)return n;if(null===r)return null===n?n:u(r,n,o);if(!1===r)return u(r,n,o);for(;"object"==typeof r&&void 0!==r.ref;)r=h[r.ref];return Array.isArray(r)?function(n,e){return-1!==n.indexOf(e)?e:u(n,e,o)}(r,n):"object"==typeof r?r.hasOwnProperty("unionMembers")?function(n,e){for(var i=n.length,r=0;r<i;r++){var a=n[r];try{return l(e,a,t,o)}catch(n){}}return u(n,e,o)}(r.unionMembers,n):r.hasOwnProperty("arrayItems")?function(n,e){return Array.isArray(e)?e.map((function(e){return l(e,n,t,o)})):u("array",e,o)}(r.arrayItems,n):r.hasOwnProperty("props")?function(n,e,i){if(null===i||"object"!=typeof i||Array.isArray(i))return u("object",i,o);var r={};return Object.getOwnPropertyNames(n).forEach((function(e){var u=n[e],a=Object.prototype.hasOwnProperty.call(i,e)?i[e]:void 0;r[u.key]=l(a,u.typ,t,o,u.key)})),Object.getOwnPropertyNames(i).forEach((function(u){Object.prototype.hasOwnProperty.call(n,u)||(r[u]=l(i[u],e,t,o,u))})),r}(t(r),r.additional,n):u(r,n,o):r===Date&&"number"!=typeof n?function(n){if(null===n)return null;var e=new Date(n);return isNaN(e.valueOf())?u("Date",n,o):e}(n):function(n,e){return typeof n==typeof e?e:u(n,e,o,i)}(r,n)}function c(n){return{arrayItems:n}}function d(n){return{ref:n}}var f,v,h={FeatureGateConfig:(f=[{json:"ConfigId",js:"ConfigId",typ:""},{json:"IsEnabled",js:"IsEnabled",typ:!0},{json:"SettingsRings",js:"SettingsRings",typ:""}],{props:f,additional:!1})},p=t(5160);function m(n,e,t){null==t||t.ULS.sendTraceTag(521164238,o.W.io,i.G.Info,"".concat(n,": ").concat(e?"Enabled":"Disabled"))}function w(n,e){if(!e)return!1;if(!e.has(n))return!1;var t=e.get(n);return null!=t&&"boolean"==typeof t&&t}function g(n,e,t){var u,a=[];null==e||e.ULS.sendTraceTag(522299220,o.W.io,i.G.Verbose,'Attempting to parse Feature Gate Config String: "'.concat(n,'"'));try{a=null!==(u=r.toFeatureGateConfig(n,e))&&void 0!==u?u:[]}catch(t){return null==e||e.ULS.sendTraceTag(524814532,o.W.io,i.G.Error,'Unable to parse Feature Gate Config string: "'.concat(n,'", due to Exception: ').concat(t)),new Map}null==e||e.ULS.sendTraceTag(522299221,o.W.io,i.G.Verbose,"Successfully parsed Feature Gate Config String to JSON: ".concat(JSON.stringify(a)));var s=new Map,l=t;return l=l?null==t?void 0:t.toLocaleLowerCase():"",a.forEach((function(n){var e,t=(null!==(e=n.SettingsRings)&&void 0!==e?e:"").replace(/\s+/g,"").toLocaleLowerCase().split(",");l&&t.includes(l)&&s.set(n.ConfigId,n.IsEnabled)})),null==e||e.ULS.sendTraceTag(522299222,o.W.io,i.G.Info,"Successfully filtered Feature Gate Config JSON: ".concat(JSON.stringify(a),", to ring id: ").concat(l,", with result map: ").concat((0,p.z)(s))),s}!function(n){n.FeatureGate_EcsHootGate="EcsHootGate",n.FeatureGate_VisioJsApiV2Gate="VisioJsApiV2Gate",n.FeatureGate_OneNoteJsApiV2Gate="OneNoteJsApiV2Gate",n.FeatureGate_HideCloseButtonGate="HideCloseButtonGate",n.FeatureGate_StartPageUseOWLGate="StartPageUseOWLGate",n.FeatureGate_GrabFocusOnFilePickerCloseGate="GrabFocusOnFilePickerCloseGate",n.FeatureGate_BlurAndGrabFocusForShareDialogGate="BlurAndGrabFocusForShareDialogGate",n.FeatureGate_Vroom21SupportGate="Vroom21SupportGate",n.FeatureGate_CommandingAshaVetoes="CommandingAshaVetoes",n.FeatureGate_DisableEUDBBrowserULSRouting="DisableEUDBBrowserULSRouting",n.FeatureGate_DisableEUDBHealthTelemetryRouting="DisableEUDBHealthTelemetryRouting",n.FeatureGate_ESSForXLGate="ESSForXL",n.FeatureGate_iOSNullCheckFeatureGate="iOSNullCheckFeatureGate",n.FeatureGate_Locale1JSGate="Locale1JSGate",n.FeatureGate_BypassOPTIONSCall="BypassOPTIONSCall",n.FeatureGate_EnableOwlFrameExperiment="IsOwlIFrameExperimentEnabled",n.FeatureGate_EnableOwlFrameExperimentTreatment="IsOwlIFrameExperimentTreatment",n.FeatureGate_EnableOwlFrameBoot="IsOwlIFrameBootEnabled",n.FeatureGate_EnableOwlFrameBootTreatment="IsOwlIFrameBootTreatment",n.FeatureGate_Vroom21ForWord="Vroom21ForWord",n.FeatureGate_Vroom21ForExcel="Vroom21ForExcel",n.FeatureGate_ManifestCachingGate="ManifestCachingGate",n.FeatureGate_ManualRedirectOnTenantChangeGate="ManualRedirectOnTenantChangeGate",n.FeatureGate_IsOwlWacOAuthExperimentTreatmentEnabled="IsOwlWacOAuthExperimentTreatment",n.FeatureGate_PrefetchWacToken="PrefetchWacToken",n.FeatureGate_UseNewEuplReporting="UseNewEuplReporting",n.FeatureGate_PostWacTokenAsync="PostWacTokenAsync"}(v||(v={}))},5457:function(n,e,t){"use strict";t.d(e,{$$:function(){return u},T4:function(){return l},qj:function(){return s},yB:function(){return a}});var o=t(8807),i=t(5160),r=new RegExp("(^| )".concat("OwlFrameMode","=([^;]+)")),u="/suite/WebLoader.aspx",a="",s=function(){function n(){}return Object.defineProperty(n,"isOwlFrame",{get:function(){return"boolean"==typeof n.ko?n.ko:"https:"===location.protocol&&location.origin.indexOf("common.online.office.com")>-1&&location.pathname===u},enumerable:!1,configurable:!0}),n.isOwlFrameExperimentEnabled=function(e,t){return"boolean"==typeof n.Ro?n.Ro:e?(n.Ro=!n.isOwlFrame&&(0,o.vJ)(o.Fh.FeatureGate_EnableOwlFrameExperiment,e),(0,o.dt)(o.Fh.FeatureGate_EnableOwlFrameExperiment,n.Ro,t),n.Ro):(n.Ro=!1,n.Ro)},n.isOwlFrameBootEnabled=function(e,t){return void 0!==n.Fo?n.Fo:e?(n.Fo=!n.isOwlFrame&&(0,o.vJ)(o.Fh.FeatureGate_EnableOwlFrameBootTreatment,e),(0,o.dt)(o.Fh.FeatureGate_EnableOwlFrameBootTreatment,n.Fo,t),n.Fo):(n.Fo=!1,n.Fo)},n.showOwlFrame=function(e,t){return n.isOwlFrameExperimentEnabled(e,t)&&n.isOwlFrameBootEnabled(e,t)},n.checkOwlFrameCookie=function(n,e){if(e&&"FASTFOOD"===n){var t=document.cookie.match(r);if(t){var i=t[2];"0"===i?(e.delete(o.Fh.FeatureGate_EnableOwlFrameExperiment),e.delete(o.Fh.FeatureGate_EnableOwlFrameExperimentTreatment),e.delete(o.Fh.FeatureGate_EnableOwlFrameBoot),e.delete(o.Fh.FeatureGate_EnableOwlFrameBootTreatment)):"1"===i?(e.delete(o.Fh.FeatureGate_EnableOwlFrameExperimentTreatment),e.delete(o.Fh.FeatureGate_EnableOwlFrameBoot),e.delete(o.Fh.FeatureGate_EnableOwlFrameBootTreatment),e.set(o.Fh.FeatureGate_EnableOwlFrameExperiment,!0)):"2"===i?(e.delete(o.Fh.FeatureGate_EnableOwlFrameExperiment),e.delete(o.Fh.FeatureGate_EnableOwlFrameExperimentTreatment),e.delete(o.Fh.FeatureGate_EnableOwlFrameBoot),e.set(o.Fh.FeatureGate_EnableOwlFrameBootTreatment,!0)):"3"===i&&(e.delete(o.Fh.FeatureGate_EnableOwlFrameExperiment),e.delete(o.Fh.FeatureGate_EnableOwlFrameExperimentTreatment),e.delete(o.Fh.FeatureGate_EnableOwlFrameBoot),e.set(o.Fh.FeatureGate_EnableOwlFrameBootTreatment,!0),e.set(o.Fh.FeatureGate_EcsHootGate,!0),a="https://login.microsoftonline.com/")}}},n}();function l(n,e,t,o,r,u){return"Frame Experiment Status: ".concat(s.isOwlFrameExperimentEnabled(t,u)?"TREATMENT":"CONTROL",", Boot Experiment Status: ").concat(s.isOwlFrameBootEnabled(t,u)?"TREATMENT":"CONTROL",", FileType: ").concat(n,", Environment: ").concat(e,", Feature Gates: ").concat(t?(0,i.d)(t):"{}",", UiHost: ").concat(o,", Integration Type: ").concat(r)}},5416:function(n,e,t){"use strict";t.d(e,{X:function(){return o}}),t(3650),t(8643);var o=function(){var n=void 0;try{n=window.localStorage}catch(n){}return n}()},654:function(n,e,t){"use strict";function o(n){return new Map([["ErrorName","".concat(n.wacErrorName)+(n.errorName?"_".concat(n.errorName):"")],["ErrorMessage",n.errorMessage?n.errorMessage:""],["HttpErrorCode","".concat(n.httpErrorCode)],["NetworkError","".concat(n.networkError)],["error",n.error?i(n.error):""]])}function i(n){if("string"==typeof n)try{return JSON.parse(n),n}catch(n){}return JSON.stringify(n,Object.getOwnPropertyNames(n))}t.d(e,{x:function(){return o}})},1561:function(n,e,t){"use strict";t.d(e,{c:function(){return i}});var o=t(9893);function i(){var n=(0,o.a)();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"===e?t:3&t|8).toString(16)}))}},2182:function(n,e,t){"use strict";t.d(e,{Z:function(){return i}});var o=t(2597);function i(n,e,t,i,r){var u,a,s,l,c,d,f,v;return{host:{storageHostName:(0,o.fG)(null!==(u=n.docUrl)&&void 0!==u?u:""),capabilities:{isFeatureEnabledCallback:(0,o.t1)(i),moveToFolder:null==t?void 0:t.supportsMoveToFolder,commonFilePicker:null==t?void 0:t.supportsCommonFilePicker,rebootDoc:null==t?void 0:t.supportsDocumentReboot,createNewDoc:null==t?void 0:t.supportsCreateNewDocument,authToken:null==t?void 0:t.supportsAuthToken,excelExternalLinks:null==t?void 0:t.supportsExcelExternalLinks,refreshAccessToken:null==t?void 0:t.supportsRefreshAccessToken,atMentions:null==t?void 0:t.supportsAtMentions,accessibilityLoop:null==t?void 0:t.supportsAccessibilityLoop,customAuthConfig:null==t?void 0:t.supportsCustomAuthConfig,directPrint:null===(a=null==t?void 0:t.supportsDirectPrint)||void 0===a||a,directDownload:null==t?void 0:t.supportsDirectDownload},uiHostName:(null==t?void 0:t.uiHostName)||o.N2,requireExplicitUnload:null==t?void 0:t.supportsExplicitUnload,metaUiHostVersion:null==i?void 0:i.metaUiHostVersion,uiHostIntegrationType:null==t?void 0:t.uiHostIntegrationType,owlVersion:null==i?void 0:i.owlVersion,owlRollout:null==i?void 0:i.owlRollout,origin:null==i?void 0:i.origin},user:{id:r?r.wac.userId:n.puid,isSynthetic:null==i?void 0:i.isSynthetic},bootstrapperUrl:e,ui:{uiEmbed:null===(s=null==t?void 0:t.uiEmbed)||void 0===s||s,controls:(null==t?void 0:t.supportsHostUiControls)?[{id:"close",visibility:(null==t?void 0:t.showCloseButton)?1:0},{id:"share",visibility:(null==t?void 0:t.supportsShare)?1:0},{id:"ellipsisOpenInBrowser",visibility:(null==t?void 0:t.openInBrowserEnabled)?1:0},{id:"ellipsisDownload",visibility:(null==t?void 0:t.ellipsisDownloadACopyButtonEnabled)?1:0},{id:"copyLink",visibility:(null==t?void 0:t.copyLinkEnabled)?1:0},{id:"conversation",visibility:(null==t?void 0:t.conversationButtonEnabled)?1:0}]:void 0,language:n.uiCulture,hideHeader:null==t?void 0:t.hideHeader,hideAppLauncherInHeader:null==t?void 0:t.hideAppLauncherInHeader,hideSearchInHeader:null==t?void 0:t.hideSearchInHeader,hideMeInHeader:null==t?void 0:t.hideMeInHeader,hideChatInHeader:null==t?void 0:t.hideChatInHeader,hideWorkflowInHeader:null==t?void 0:t.hideWorkflowInHeader,hideSettingsInHeader:null==t?void 0:t.hideSettingsInHeader,showAppIconInHeader:null==t?void 0:t.showAppIconInHeader,useNeutralColorInHeader:null==t?void 0:t.useNeutralColorInHeader,highContrast:"invert"===(null==i?void 0:i.highContrastMode)?"invert":void 0,openLinksInNewWindow:null==t?void 0:t.openLinksInNewWindow,contentAssemblyMode:null==t?void 0:t.contentAssemblyMode,showNotebookList:"1"===(null===(l=null==i?void 0:i.additionalApplicationParameters)||void 0===l?void 0:l.shownotebooklist),enableMobileViewer:"1"===(null===(c=null==i?void 0:i.additionalApplicationParameters)||void 0===c?void 0:c.wdMobileEmbedOneNoteViewer),mobileEmbedView:"1"===(null===(d=null==i?void 0:i.additionalApplicationParameters)||void 0===d?void 0:d.wdMobileEmbedOneNoteViewer),showBreadcrumbInMobileView:"1"===(null===(f=null==i?void 0:i.additionalApplicationParameters)||void 0===f?void 0:f.wdMobileEmbedOneNoteViewer),showInternalFeedback:"1"===(null===(v=null==i?void 0:i.additionalApplicationParameters)||void 0===v?void 0:v.wdNotesInternalFeedbackEnabled)}}}},3007:function(n,e,t){"use strict";t.d(e,{DS:function(){return c},ME:function(){return p},OV:function(){return h},W8:function(){return v},r_:function(){return o},vY:function(){return f}});var o,i,r=t(533),u=t(8389),a=t(5457);!function(n){n.OwlBootAppMessageSend="owlBootAppMessageSend",n.OwlBootAppMessageReceive="owlBootAppMessageReceive",n.OwlLoadedMessageSend="owlLoadedMessageSend",n.OwlLoadedMessageReceive="owlLoadedMessageReceive",n.OwlBootAppWithCustomFunctionsMessageSend="owlBootAppWithCustomFunctionsMessageSend",n.OwlBootAppWithCustomFunctionsMessageReceive="owlBootAppWithCustomFunctionsMessageReceive",n.OwlWithCustomFunctionsStart="owlWithCustomFunctionsStart",n.OwlWithCustomFunctionsEnd="owlWithCustomFunctionsEnd",n.OwlStart="owlStart",n.OwlEnd="owlEnd",n.OwlHostTimeOrigin="owlHostTimeOrigin",n.OwlFrameTimeOrigin="owlFrameTimeOrigin",n.OwlWacBootStart="owlWacBootStart",n.OwlOnBootComplete="owlOnBootComplete",n.OwlCreateFrameStart="owlCreateFrameStart",n.OwlCreateFrameEnd="owlCreateFrameEnd",n.OwlTokenFetchingExperimentMessageSend="owlTokenFetchingExperimentMessageSend",n.OwlTokenFetchingExperimentMessageReceived="owlTokenFetchingExperimentMessageReceived",n.OwlMsalLoadStart="owlMsalLoadStart",n.OwlMsalLoadEnd="owlMsalLoadEnd",n.OwlMsalInitStart="owlMsalInitStart",n.OwlMsalInitEnd="owlMsalInitEnd",n.OwlMsalSsoSilentStart="owlMsalSsoSilentStart",n.OwlMsalSsoSilentEnd="owlMsalSsoSilentEnd",n.OwlMsalLoginPopupStart="owlMsalLoginPopupStart",n.OwlMsalLoginPopupEnd="owlMsalLoginPopupEnd",n.OwlGetDriveItemWithMsalStart="owlGetDriveItemWithMsalStart",n.OwlGetDriveItemWithMsalEnd="owlGetDriveItemWithMsalEnd",n.OwlTryGetWacTokenStart="owlTryGetWacTokenStart",n.OwlTryGetWacTokenEnd="owlTryGetWacTokenEnd",n.OwlTryGetWacTokenPopupStart="owlTryGetWacTokenPopupStart",n.OwlTryGetWacTokenPopupEnd="owlTryGetWacTokenPopupEnd",n.OwlTryGetWacTokenFromCacheEnd="owlTryGetWacTokenFromCacheEnd",n.OwlGetDriveItemStart="owlGetDriveItemStart",n.OwlGetDriveItemEnd="owlGetDriveItemEnd",n.OwlFrameScriptExecutionStart="owlFrameScriptExecutionStart",n.OwlGetAccountByUsernameStart="owlGetAccountByUsernameStart",n.OwlGetAccountByUsernameEnd="owlGetAccountByUsernameEnd",n.OwlTryGetWacTokenWithClaimsFromCacheEnd="owlTryGetWacTokenWithClaimsFromCacheEnd",n.OwlTryGetWacTokenWithClaimsEnd="owlTryGetWacTokenWithClaimsEnd",n.OwlMsalGetAccessTokenStart="owlMsalGetAccessTokenStart",n.OwlMsalGetAccessTokenEnd="owlMsalGetAccessTokenEnd",n.OwlFetchWebLoaderStart="owlFetchWebLoaderStart",n.OwlFetchWebLoaderEnd="owlFetchWebLoaderEnd"}(o||(o={})),function(n){n.OwlCreateFrame="OwlCreateFrame",n.OwlTokenFetchingExperimentMessage="OwlTokenFetchingExperimentMessage",n.OwlMsalInit="OwlMsalInit",n.OwlMsalSsoSilent="OwlMsalSsoSilent",n.OwlGetDriveItemWithMsal="OwlGetDriveItemWithMsal",n.OwlTryGetWacToken="OwlTryGetWacToken",n.OwlTryGetWacTokenFromCache="OwlTryGetWacTokenFromCache",n.OwlGetDriveItem="OwlGetDriveItem",n.OwlGetAccountByUsername="OwlGetAccountByUsername",n.OwlTryGetWacTokenWithClaims="OwlTryGetWacTokenWithClaims",n.OwlTryGetWacTokenWithClaimsFromCache="OwlTryGetWacTokenWithClaimsFromCache",n.OwlMsalGetAccessToken="OwlMsalGetAccessToken",n.OwlFetchWebLoader="OwlFetchWebLoader"}(i||(i={}));var s=[{measureName:i.OwlCreateFrame,measureStart:o.OwlCreateFrameStart,measureEnd:o.OwlCreateFrameEnd}],l=[{measureName:i.OwlTokenFetchingExperimentMessage,measureStart:o.OwlTokenFetchingExperimentMessageSend,measureEnd:o.OwlTokenFetchingExperimentMessageReceived},{measureName:i.OwlMsalInit,measureStart:o.OwlMsalInitStart,measureEnd:o.OwlMsalInitEnd},{measureName:i.OwlMsalSsoSilent,measureStart:o.OwlMsalSsoSilentStart,measureEnd:o.OwlMsalSsoSilentEnd},{measureName:i.OwlGetDriveItemWithMsal,measureStart:o.OwlGetDriveItemWithMsalStart,measureEnd:o.OwlGetDriveItemWithMsalEnd},{measureName:i.OwlTryGetWacToken,measureStart:o.OwlTryGetWacTokenStart,measureEnd:o.OwlTryGetWacTokenEnd},{measureName:i.OwlGetDriveItem,measureStart:o.OwlGetDriveItemStart,measureEnd:o.OwlGetDriveItemEnd},{measureName:i.OwlTryGetWacTokenFromCache,measureStart:o.OwlTryGetWacTokenStart,measureEnd:o.OwlTryGetWacTokenFromCacheEnd},{measureName:i.OwlGetAccountByUsername,measureStart:o.OwlGetAccountByUsernameStart,measureEnd:o.OwlGetAccountByUsernameEnd},{measureName:i.OwlTryGetWacTokenWithClaims,measureStart:o.OwlTryGetWacTokenStart,measureEnd:o.OwlTryGetWacTokenWithClaimsEnd},{measureName:i.OwlTryGetWacTokenWithClaimsFromCache,measureStart:o.OwlTryGetWacTokenStart,measureEnd:o.OwlTryGetWacTokenWithClaimsFromCacheEnd},{measureName:i.OwlMsalGetAccessToken,measureStart:o.OwlMsalGetAccessTokenStart,measureEnd:o.OwlMsalGetAccessTokenEnd},{measureName:i.OwlFetchWebLoader,measureStart:o.OwlFetchWebLoaderStart,measureEnd:o.OwlFetchWebLoaderEnd}];function c(){var n,e,t=a.qj.isOwlFrame?l:s;try{for(var o=(0,r.XA)(t),i=o.next();!i.done;i=o.next()){var u=i.value;d(u.measureName,u.measureStart,u.measureEnd)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(n)throw n.error}}}function d(n,e,t){var o,i,r;(null===(o=null===performance||void 0===performance?void 0:performance.getEntriesByName)||void 0===o?void 0:o.call(performance,e).length)>0&&(null===(i=null===performance||void 0===performance?void 0:performance.getEntriesByName)||void 0===i?void 0:i.call(performance,t).length)>0&&(null===(r=performance.measure)||void 0===r||r.call(performance,n,e,t))}function f(n){var e,t,i,r,u,s,l,c;void 0===n&&(n="");var d=a.qj.isOwlFrame?null===(i=null===(t=null===(e=null===window||void 0===window?void 0:window.performance)||void 0===e?void 0:e.getEntriesByName)||void 0===t?void 0:t.call(e,o.OwlFrameTimeOrigin)[0])||void 0===i?void 0:i.detail:null===(s=null===(u=null===(r=null===window||void 0===window?void 0:window.performance)||void 0===r?void 0:r.getEntriesByName)||void 0===u?void 0:u.call(r,o.OwlHostTimeOrigin)[0])||void 0===s?void 0:s.detail;return null===(c=null===(l=null===window||void 0===window?void 0:window.performance)||void 0===l?void 0:l.getEntriesByType)||void 0===c?void 0:c.call(l,"mark").filter((function(e){return e.name.startsWith(n)})).reduce((function(n,e){return e.name!==o.OwlFrameTimeOrigin&&e.name!==o.OwlHostTimeOrigin?n[e.name]=d+e.startTime:n[e.name]=d,n}),{})}function v(n,e){var t,i=n[o.OwlStart]||n[o.OwlWithCustomFunctionsStart],u=(n[o.OwlBootAppMessageSend]||n[o.OwlBootAppWithCustomFunctionsMessageSend])-i,a=e[o.OwlBootAppMessageReceive]||e[o.OwlBootAppWithCustomFunctionsMessageReceive],s=e[o.OwlOnBootComplete];return{hostTime:u,frameTime:s-a,totalTime:s-i,owlPerformanceTimeline:(0,r.pi)((0,r.pi)((0,r.pi)({},n),e),((t={})[o.OwlStart]=i,t[o.OwlEnd]=s,t))}}function h(n){var e,t=n[o.OwlStart]||n[o.OwlWithCustomFunctionsStart],i=n[o.OwlOnBootComplete];return{totalTime:i-t,owlPerformanceTimeline:(0,r.pi)((0,r.pi)({},n),((e={})[o.OwlStart]=t,e[o.OwlEnd]=i,e))}}function p(n){var e;try{e=JSON.stringify((0,u.pb)())}catch(n){e="[]"}var t=(0,r.pi)({},f("owl"));return n&&(n.owlVersion&&(t.version=n.owlVersion),n.wiseEnvironment&&(t.environment=n.wiseEnvironment),n.exposure&&(t.exposure=n.exposure)),{bootTelemetryData:e,owlTelemetryData:JSON.stringify(t)}}},5160:function(n,e,t){"use strict";t.d(e,{d:function(){return r},z:function(){return i}});var o=t(533);function i(n){var e,t,i="{ ";try{for(var r=(0,o.XA)(n.entries()),u=r.next();!u.done;u=r.next()){var a=u.value;i+="{ key: ".concat(a[0],", value: ").concat(a[1]," },")}}catch(n){e={error:n}}finally{try{u&&!u.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i.substring(0,i.length-1)+" }"}function r(n){var e,t,i={};try{for(var r=(0,o.XA)(n.entries()),u=r.next();!u.done;u=r.next()){var a=(0,o.CR)(u.value,2),s=a[0],l=a[1];i[String(s)]=l}}catch(n){e={error:n}}finally{try{u&&!u.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return JSON.stringify(i)}},2685:function(n,e,t){"use strict";t.d(e,{J:function(){return s}});var o,i,r,u=t(2022),a=function(n){var e=document.getElementById("unified-ui-host-config"),t=e&&e.textContent;if(t)return JSON.parse(t)}(),s={version:"v1",officeHomeCdnDomain:null!==(o=null==a?void 0:a.officeHomeCdnDomain)&&void 0!==o?o:(0,u.w8)(),genericFeatureGates:null!==(i=null==a?void 0:a.genericFeatureGates)&&void 0!==i?i:null,deploymentEnvironment:null!==(r=null==a?void 0:a.deploymentEnvironment)&&void 0!==r?r:"Not_specified"}},394:function(n,e,t){"use strict";t.d(e,{JK:function(){return s},Th:function(){return w},VJ:function(){return r},XU:function(){return a},Y$:function(){return p},aE:function(){return m},bM:function(){return d},gG:function(){return h},k$:function(){return v},o4:function(){return o},pK:function(){return u},sj:function(){return f}});var o,i=t(533),r=/http[s]?:\/\/[\S]*?\.sharepoint[\S]*?\.com/,u=/http[s]?:\/\/[\S]*?-my\.sharepoint[\S]*?\.com/,a=/http[s]?:\/\/d\.docs\.live\.net/,s=/https:\/\/[\S]*?graph\.[\S]/,l="https://graph.microsoft.com",c=new RegExp(["^(https?:)//","(([^:/?#]*)(?::([0-9]+))?)","(/{0,1}[^?#]*)","(\\?[^#]*|)","(#.*|)$"].join(""));function d(n){if(!n)return"";try{return decodeURIComponent(n)}catch(n){return""}}function f(n){return n?n.substring(0,n.lastIndexOf("/")):""}function v(n){if(n&&n.length){var e=n.match(c);if(e)return{href:n,protocol:e[1],host:e[2],hostname:e[3],port:e[4],path:e[5],search:e[6],hash:e[7]}}}function h(n){if(n&&n.length){if(n.match(u)||n.match(a))return"OneDrive";if(n.match(r))return"SharePoint";if(n.startsWith(l))return"Graph"}}function p(n,e,t){var o=n,r="",u=!0;for(var a in e&&(o=(0,i.pi)((0,i.pi)({},e),o)),o){var s,l=o[a];if(!t||"object"!=typeof l&&l||"object"==typeof l&&l&&l.uriValue||"number"==typeof l||"boolean"==typeof l)u?u=!1:r+="&",s="object"==typeof l&&l&&l.uriValue?l.uriValue:encodeURIComponent("".concat(l)),r+="".concat(a,"=").concat(s)}return r}function m(n){if(n&&n.length){if(n.match(u)||n.match(a))return o.OneDrive;if(n.match(r))return o.SharePoint}}function w(n,e){var t=n.toLowerCase(),o=function(n){var e=v(n);return e&&e.hostname||""}(e),i=function(n){var e=n.toLowerCase();return!e||e.startsWith("http:")||e.startsWith("https:")||e.startsWith("mailto:")||e.startsWith("sip:")||e.startsWith("tel:")||e.startsWith("im:")?e:"https://"+e}(o),r=f(e);return 0===t.indexOf("https://")||0===t.indexOf("http://")?t:"/"===t.charAt(0)?"".concat(i).concat(t):"".concat(r,"/").concat(t)}!function(n){n.OneDrive="Documents",n.SharePoint="Sites"}(o||(o={}))},2473:function(n,e,t){"use strict";var o,i,r,u,a;t.d(e,{J7:function(){return o},L5:function(){return r},hx:function(){return i},iz:function(){return u}}),function(n){n.CacheOnly="cache-only",n.NetworkFirst="network-first",n.NetworkOnly="network-only"}(o||(o={})),function(n){n.Delete="DELETE",n.Get="GET",n.Head="HEAD",n.Options="OPTIONS",n.Post="POST",n.Put="PUT",n.Patch="PATCH"}(i||(i={})),function(n){n.CorrelationId="X-OfficeHome-CorrelationId",n.Mock="ohp-mock",n.TestTraffic="X-OfficeHome-TestTraffic"}(r||(r={})),function(n){n.TestTraffic="testtraffic"}(u||(u={})),function(n){n.Json="json",n.Text="text",n.ArrayBuffer="arraybuffer",n.Blob="blob"}(a||(a={}))},3956:function(n,e,t){"use strict";t.d(e,{Ko:function(){return h},sm:function(){return p}});var o=t(533),i=t(3650),r=t(8643),u=t(2227),a=t.n(u),s=t(7971),l=t(2473),c=3e5,d=-1,f=a().create(),v=function(n,e){return e===l.J7.CacheOnly?Promise.reject("Cache unsupported"):Promise.resolve(n)};function h(n,e,t,u,h,p,S,b,I,C,A){void 0===I&&(I={});var T=b;return C===l.J7.CacheOnly&&(T="None"),function(n,e,t,o,u,a,c,d,f,v,h,p){return new Promise((function(w,S){var b=u||"None",I="None"===b||"OfficeHome"===b&&!t,C=f||new Set;C.add(401);var A=function(n){var e=n.status,t=Number.NaN;!I&&C.has(e)?t=s.W.TokenRefreshFailed:v&&v(e)&&(t=s.W.RetryFailed),t!==Number.NaN&&(null==p||p.ULS.sendTraceTag(509723938,i.W.io,r.G.Error,"requestWithAuthAndRetry failed with status ".concat(e," and customErrorCode ").concat(t))),S({httpResponse:n})};if(a){var T=g(a);T&&(e.headers||(e.headers={}),e.headers[l.L5.Mock]=T)}(I?Promise.resolve(void 0):o(b,!1,c)).then((function(t){if(!I){if(!t||!t.success){var u=t?t.error:"";return null==p||p.ULS.sendTraceTag(509723937,i.W.io,r.G.Error,"requestWithAuthAndRetry failed on get token with error ".concat(u)),void S({httpResponse:{data:"CAP_Error"===u?u:null,status:s.W.TokenUnavailable,headers:{},ok:!1,statusText:"Failed to fetch access token",fromCache:!1}})}m(e,t,d,h)}n(e).then(w,(function(t){var u,a;!I&&C.has(t.status)?o(b,!0,c).then((function(o){o.success?(m(e,o,d,h),n(e).then(w,A)):A(t)})).catch((function(n){null==p||p.ULS.sendTraceTag(509723936,i.W.io,r.G.Error,"getAccessToken failed with error ".concat(n))})):v&&v(t.status)?(u=e,setTimeout((function(){n(u).then(w,A)}),(a=[0,11,22,33])[Math.floor(1e3*Math.random())%a.length])):S({httpResponse:t})}))})).catch((function(n){null==p||p.ULS.sendTraceTag(509723935,i.W.io,r.G.Error,"getAccessToken failed with error ".concat(n))}))}))}((function(n){return function(n,e,t,u,h,p,m,S,b){var I="".concat(e,"/");return n.url.startsWith("http")&&!I.startsWith("http")&&(I="".concat(window.location.origin,"/").concat(I)),0===n.url.lastIndexOf(I,0)&&function(n,e){n.headers||(n.headers={}),n.headers[l.L5.CorrelationId]=e;var t=g(l.iz.TestTraffic);t&&(n.headers[l.L5.TestTraffic]=t)}(n,t),function(n,e,t,u,h,p,m){var g=e===l.J7.CacheOnly,S=function(n,e,t,u,c,h,p){var m=this;return new Promise((function(g,S){return(0,o.mG)(m,void 0,void 0,(function(){var m,b,I,C,A;return(0,o.Jh)(this,(function(o){switch(o.label){case 0:if(m=t===l.J7.CacheOnly,b={url:n.url,method:n.method,headers:n.headers,params:n.params,data:n.body,timeout:e,responseType:n.responseType,onUploadProgress:u,onDownloadProgress:c},h&&(I=a().CancelToken,C=I.source(),b.cancelToken=C.token,h.onCancel((function(){return C.cancel()})).catch((function(n){null==p||p.ULS.sendTraceTag(509723933,i.W.io,r.G.Error,"getResponse failed with error ".concat(n))}))),!v)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,v(b,t||l.J7.NetworkOnly)];case 2:return o.sent(),[3,4];case 3:return A=o.sent(),S(w(s.W.NotImplemented,m,A)),[2];case 4:return f.request(b).then((function(n){g({data:n.data,status:n.status,headers:n.headers,ok:!0,statusText:n.statusText,fromCache:m})}),(function(n){a().isCancel(n)?S(w(s.W.Cancelled,m)):"ECONNABORTED"===n.code?S(w(s.W.Timeout,m)):n.response?S({data:n.response.data,status:n.response.status,headers:n.response.headers,ok:!1,statusText:n.response.statusText,fromCache:!1}):window.navigator&&"boolean"==typeof window.navigator.onLine&&!window.navigator.onLine?S(w(s.W.Offline,m)):S(w(d,m))})),[2]}}))}))}))}(n,p||c,e,t,u,h,m),b=h?h.onCancel((function(){return Promise.resolve(w(s.W.Cancelled,g))})):new Promise((function(){}));return Promise.race([S,b]).catch((function(n){null==m||m.ULS.sendTraceTag(509723934,i.W.io,r.G.Error,"requestWithInstrumentation failed with error ".concat(n))})),S}(n,u,h,p,m,S,b)}(n,p,S,C,I.onUploadProgress,I.onDownloadProgress,I.cancellationToken,I.timeoutInMs,A)}),(0,o.pi)((0,o.pi)({},t),{url:n,method:l.hx.Post,body:e}),u,h,T,I.mockParam,I.resourceUrl,I.rpsHeaderPrefix,I.additionalAuthErrors,I.isRetriableError,I.updateRequestWithAuth,A)}function p(n,e,t){var o=e;if(!n||!n.success)return null!=o?o:{};o||(o={});var i="RPSCompact"===n.format?t||"":"Bearer ";return o.Authorization="".concat(i).concat(n.token).trim(),o}function m(n,e,t,o){n&&(n.headers=p(e,n.headers,t),o&&o(n,e))}function w(n,e,t){return{data:void 0,status:n,headers:{},ok:!1,statusText:t&&"string"==typeof t?t:n.toString(),fromCache:e}}function g(n){return new URLSearchParams(window.location.search).get(n)}},6652:function(n,e,t){"use strict";var o;t.d(e,{T:function(){return o}}),function(n){n.Excel="Excel",n.None="None",n.OneNote="OneNote",n.PowerPoint="PowerPoint",n.Visio="Visio",n.Word="Word"}(o||(o={}))},9893:function(n,e,t){"use strict";function o(n){window.performance&&window.performance.mark&&(Array.isArray(n)?n.forEach((function(n){window.performance.mark(n)})):window.performance.mark(n))}function i(){var n,e,t;return(null===(e=null===(n=window.performance)||void 0===n?void 0:n.now)||void 0===e?void 0:e.call(n))+(null===(t=window.performance)||void 0===t?void 0:t.timeOrigin)||Date.now()}t.d(e,{a:function(){return i},l:function(){return o}})}},r={};function u(n){var e=r[n];if(void 0!==e)return e.exports;var t=r[n]={id:n,exports:{}};return i[n](t,t.exports,u),t.exports}u.m=i,u.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return u.d(e,{a:e}),e},e=Object.getPrototypeOf?function(n){return Object.getPrototypeOf(n)}:function(n){return n.__proto__},u.t=function(t,o){if(1&o&&(t=this(t)),8&o)return t;if("object"==typeof t&&t){if(4&o&&t.__esModule)return t;if(16&o&&"function"==typeof t.then)return t}var i=Object.create(null);u.r(i);var r={};n=n||[null,e({}),e([]),e(e)];for(var a=2&o&&t;"object"==typeof a&&!~n.indexOf(a);a=e(a))Object.getOwnPropertyNames(a).forEach((function(n){r[n]=function(){return t[n]}}));return r.default=function(){return t},u.d(i,r),i},u.d=function(n,e){for(var t in e)u.o(e,t)&&!u.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},u.f={},u.e=function(n){return Promise.all(Object.keys(u.f).reduce((function(e,t){return u.f[t](n,e),e}),[]))},u.u=function(n){return"owl."+({36:"hi-in-owl-strings-json",98:"sd-arab-pk-owl-strings-json",399:"lb-lu-owl-strings-json",666:"sr-cyrl-ba-owl-strings-json",712:"ga-ie-owl-strings-json",856:"gd-gb-owl-strings-json",921:"zh-tw-owl-strings-json",1e3:"el-gr-owl-strings-json",1029:"sl-si-owl-strings-json",1102:"ms-my-owl-strings-json",1105:"ca-es-owl-strings-json",1133:"be-by-owl-strings-json",1350:"bn-in-owl-strings-json",1406:"ca-es-valencia-owl-strings-json",1489:"et-ee-owl-strings-json",1532:"uk-ua-owl-strings-json",1608:"nl-nl-owl-strings-json",1635:"es-mx-owl-strings-json",1771:"ne-np-owl-strings-json",1791:"ar-sa-owl-strings-json",1825:"kk-kz-owl-strings-json",1993:"kok-in-owl-strings-json",2046:"ta-in-owl-strings-json",2129:"quz-pe-owl-strings-json",2281:"ur-pk-owl-strings-json",2289:"ha-latn-ng-owl-strings-json",2394:"te-in-owl-strings-json",2468:"msal",2772:"ro-ro-owl-strings-json",2792:"pt-br-owl-strings-json",2811:"km-kh-owl-strings-json",2855:"pa-in-owl-strings-json",2902:"lt-lt-owl-strings-json",3041:"fr-fr-owl-strings-json",3075:"en-gb-owl-strings-json",3102:"cy-gb-owl-strings-json",3247:"da-dk-owl-strings-json",3268:"id-id-owl-strings-json",3395:"tt-ru-owl-strings-json",3622:"lo-la-owl-strings-json",3648:"handlers",3787:"qps-ploc-owl-strings-json",3872:"ky-kg-owl-strings-json",4051:"fi-fi-owl-strings-json",4144:"ja-jp-owl-strings-json",4335:"it-it-owl-strings-json",4525:"kn-in-owl-strings-json",4628:"mk-mk-owl-strings-json",4654:"fr-ca-owl-strings-json",4809:"tk-tm-owl-strings-json",5167:"af-za-owl-strings-json",5383:"as-in-owl-strings-json",5467:"nn-no-owl-strings-json",5760:"fa-ir-owl-strings-json",5848:"mi-nz-owl-strings-json",5874:"am-et-owl-strings-json",6099:"si-lk-owl-strings-json",6233:"vi-vn-owl-strings-json",6251:"sq-al-owl-strings-json",6338:"bn-bd-owl-strings-json",6664:"cs-cz-owl-strings-json",6727:"hr-hr-owl-strings-json",6774:"nb-no-owl-strings-json",6795:"hy-am-owl-strings-json",6798:"bs-latn-ba-owl-strings-json",6832:"tr-tr-owl-strings-json",6974:"pl-pl-owl-strings-json",7e3:"sw-ke-owl-strings-json",7027:"chr-cher-us-owl-strings-json",7332:"or-in-owl-strings-json",7335:"mt-mt-owl-strings-json",7447:"zh-cn-owl-strings-json",7610:"ml-in-owl-strings-json",7681:"ka-ge-owl-strings-json",7805:"az-latn-az-owl-strings-json",7986:"sv-se-owl-strings-json",8102:"es-es-owl-strings-json",8217:"gl-es-owl-strings-json",8225:"bg-bg-owl-strings-json",8253:"hu-hu-owl-strings-json",8294:"prs-af-owl-strings-json",8342:"ko-kr-owl-strings-json",8361:"fil-ph-owl-strings-json",8438:"en-us-owl-strings-json",8507:"ru-ru-owl-strings-json",8530:"sr-latn-rs-owl-strings-json",8660:"gu-in-owl-strings-json",8692:"ug-cn-owl-strings-json",8793:"pt-pt-owl-strings-json",8904:"eu-es-owl-strings-json",9054:"lv-lv-owl-strings-json",9173:"th-th-owl-strings-json",9264:"mr-in-owl-strings-json",9275:"de-de-owl-strings-json",9355:"qps-plocm-owl-strings-json",9545:"he-il-owl-strings-json",9660:"mn-mn-owl-strings-json",9729:"sr-cyrl-rs-owl-strings-json",9743:"sk-sk-owl-strings-json",9754:"is-is-owl-strings-json",9779:"uz-latn-uz-owl-strings-json",9894:"qps-ploca-owl-strings-json"}[n]||n)+"."+{36:"08015b9d7f44c1be93fc",98:"d0b93bea6a8eb17fbd8b",399:"d212938cacf4f576c30f",666:"cb4dbd481a4cbb987514",712:"44bb4588b563a46c1eda",856:"1503371adb35fd81b50c",921:"67a09fd49c5b99d67dfd",1e3:"6e83c2551d69d4d08c0b",1029:"86433ec45bdaf889e19e",1102:"be1c5c1a4adefb27f10d",1105:"8b39233745df58383158",1133:"428efd42b709ef29c676",1350:"e2fc5c021337dbfdb099",1406:"a4850d2c3155701d2034",1489:"c3c364f9de413bf12c6f",1532:"47449b80079f0b4404eb",1608:"4134a840fd435fd34e02",1635:"d262eaed8ac980ce7434",1771:"793fa1b22ec0ad76d915",1791:"c02f202fc344d20f31c5",1825:"6169dfcc9f17040ab4f2",1993:"bee7e57e4e45096691b9",2046:"1543fb82b2c5fc1e8011",2129:"e9d8fea6379518c2f0a4",2281:"923f4280168eb2602550",2289:"4242de05354517bcf62a",2394:"bc6e2550ae04e7977b79",2468:"37ee0a508d35774181cc",2772:"f3a0162eced55cf4f89b",2792:"dfde60888bb68e420067",2811:"0f2ba27f011079e78e7f",2855:"ddf5d92f2402823c1037",2902:"24f3cb678548f376eaba",3041:"33d6454d96402c1f9813",3075:"9c61073d8fb53737ea7f",3102:"2b6c402d6bf619fa61cb",3247:"2cb48e460c2344218cc9",3268:"37ae6f1e73d51ba44230",3395:"a90ec0965f1e008a73c6",3622:"fdbe5579bb07d819ac15",3648:"e96de895d44e59111405",3787:"582722f8917ba2b78ef9",3872:"71a658b43a2593fd0ecf",4051:"430b237acfd06f0747e9",4144:"0c26c67b68418b37db31",4335:"d49e799346a931037751",4525:"ebd08896ddcc5bad6411",4628:"7737188a1bb62a0275b0",4654:"6362e6e34af21d5bd113",4809:"bd187472756827a87c16",5167:"e6a7c5d8c8088009060b",5383:"2308c97046b2063f82e0",5467:"a3a1f888855abfc0c2a0",5760:"0cb2c123d32008c09131",5848:"9545fad683f1074f8604",5874:"e8b3f13180fb1b31d1be",5911:"6f827e2e3b6ea75ea285",6099:"80acc693991e953851b2",6233:"b69a4cac13ee0576ecf1",6251:"1a4ff5e48af69f848b98",6338:"3c29c3612a3175383492",6664:"67dd01e5ac16f9d18cd2",6727:"65dbebd7b04b318a1f1d",6774:"b0011ca7e6cecab630e2",6795:"6b57fb8c6dd6a77fbc08",6798:"ff9fd6787aa68a0e89ed",6832:"bcc9f8ef2080be8d16c8",6974:"40dae672e0c157fd3d6d",7e3:"bfa049a6f97e0e3ae034",7027:"0d119198d7ea531d0d58",7332:"fc41f3cdfb2a6a28217e",7335:"3bbb362f9a55a60601e6",7447:"b96634c440cddb51190e",7610:"2994eea54657f0493099",7681:"645ccfc5c76f930a67f3",7805:"18462b30bfac58b71c95",7986:"d5fae7f0076ed073adb5",8102:"3fa32582f01c89b00fff",8217:"4e75c299f19ab8c32a44",8225:"0abff3acc5812b257c95",8253:"6137dbd913df212f0976",8294:"0ab112e12780893b836d",8342:"332cde542bac01e533af",8361:"e3c33d8e93482ac985cd",8438:"461814452c05e3c97926",8507:"440d5eb78bafca0b6481",8530:"735336668185330e7bf5",8660:"1e98dead4a2f92d040a7",8692:"71650365ba8b969d2c6a",8793:"733447c36e36b1eca85d",8904:"f792f9cfcb0d9a267db0",9054:"b9a2be87b92f217c6cc6",9173:"25fa950b93edbe0d7f4e",9264:"904dc006039c6313e064",9275:"d40783546a3e580c6e44",9355:"9e1089daf90ce15ea94e",9545:"4b454b29d3e0e5ae1a42",9660:"102fe2e09c7ce1512dfa",9729:"5d8e21b3bb672ed0cb57",9743:"a49bd6ec8428a6d440fa",9754:"a3e0fb99f67e0dbf3867",9779:"438f85ccddd0158e4777",9894:"f05387399bca7bb09148"}[n]+".js"},u.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(n){if("object"==typeof window)return window}}(),u.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t={},o="Microsoft.Office.OWL:",u.l=function(n,e,i,r){if(t[n])t[n].push(e);else{var a,s;if(void 0!==i)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var d=l[c];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==o+i){a=d;break}}a||(s=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,u.nc&&a.setAttribute("nonce",u.nc),a.setAttribute("data-webpack",o+i),a.src=n,0!==a.src.indexOf(window.location.origin+"/")&&(a.crossOrigin="anonymous"),a.integrity=u.sriHashes[r],a.crossOrigin="anonymous"),t[n]=[e];var f=function(e,o){a.onerror=a.onload=null,clearTimeout(v);var i=t[n];if(delete t[n],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((function(n){return n(o)})),e)return e(o)},v=setTimeout(f.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=f.bind(null,a.onerror),a.onload=f.bind(null,a.onload),s&&document.head.appendChild(a)}},u.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},function(){var n;u.g.importScripts&&(n=u.g.location+"");var e=u.g.document;if(!n&&e&&(e.currentScript&&(n=e.currentScript.src),!n)){var t=e.getElementsByTagName("script");if(t.length)for(var o=t.length-1;o>-1&&!n;)n=t[o--].src}if(!n)throw new Error("Automatic publicPath is not supported in this browser");n=n.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),u.p=n}(),u.sriHashes={36:"sha384-AkpUJvJCOd2vByq1HU40gFA0BTEc06bh28PhZH9rDQ2UILdLNbDafnUnoHLPRfZq",98:"sha384-qYGotODNWImNHfo9DDU7Tz9OKfJajxPD/bwDD1I1snWUkYRnb8o1XfxQ2B77wHE3",399:"sha384-DiKOhlWh67ZoiG25qEzF+T1GurQwAJxvuw5vZ0vG6Wy5XTO7K1RNFJocc3HXAblt",666:"sha384-SmqMUavtZfgeh/bxZDZHaKq1Y5gkO26spXR+oUTRPPkowwHmhR0WrSWQrP0zLnCp",712:"sha384-N9InZN4WuJbU+ekpiPr7jWwse7IPf2uB7U+vYPDg2AK6/SdlDBAfidqDKH1if/e/",856:"sha384-PtMvQVdsR3mp26Gu/+N+Xfa69knjeGGeMau4S/JRZVbNOZ2pQf6XLrYI54TpV/zm",921:"sha384-6K1hINAK34TjCD3om3QtEZoOLTLalwKf+FacHI4N3YlVpJS8pla7o+fkrKitLjy+",1e3:"sha384-XOOWDEaJiPXZS6GHG9+AQWas7vPas2bx2IUWCy3+XpC5u9HkTkjTtDaGqgGMzbwD",1029:"sha384-IEWalH+pfv99rBO3EotMMYG/2eGsn99ZvBjOQKQ5Zi6cslsov+M7+P2Pdkcvb8B5",1102:"sha384-bxUri3l0J3FWcUZtG5p7xS2LfpJ0mzidHrLz0hhkjPyDSGSa4vBq4whCkofj+8nZ",1105:"sha384-vn3wXMlwh62KyUGLQ4G2FYKUevCTlkaxbcJfJmyfmQ6jTn6OvWYZIBMda2g7wXZW",1133:"sha384-cuMKZKzg4aJ4/TEI3uE4N6hqcXNz32lUfCS6PXdMuqEr/9rpSmWNXl8WZVt89zb2",1350:"sha384-siBOb8w8EhzMsXw139h5HBgI1/nnrjDKEMUWOJMJeE1qd7M699aMG1g7e6Zqrt5E",1406:"sha384-jSPtO42PS1E7m6aMMYNYd0nwLDjEJ9U54CKiwpQYyKjbNJ+10YJJXBXDTBCS9cqZ",1489:"sha384-XqT+dd3TYb3EMC6TTdjZxWcjw561M0DqzBnmY0oi39AP0qNwVx0qHa+H1w7pM0+9",1532:"sha384-y/01sCtAMLMvlePN1brHCobKnOIxQndIGC23W+CVudcNRLMRkPRbIiNunF4djhci",1608:"sha384-I8RbPhWQbU/7jxAmDHjEJGps8DxfIzGt2PsJ389zCggOiQbGqblFYfMj8hvfEvXc",1635:"sha384-4yDVKeKcoWXiCdYs5UJviNjpOeYtAOj9GhlxIdSo90HEUaDq7oWlphRDd07VdJvX",1771:"sha384-Gg9CM3A4Hl+00IrBN4ZqQOeZkqIJtokrMnooaeVnPfDn9/qHJJMbne6gykFFNcPM",1791:"sha384-9H1GI0OHpso5MoaxcaO+/MmRlgGAkyAP1JEf/4mRAq63Ut4Mzo4pbvILt+vTJqwY",1825:"sha384-faAlBNbif7V0FVsQmoKUxOdjCLbxOK6lafuEBD2sEdKISuPLLJGFjv2PHxRKO/Bv",1993:"sha384-BXEnIp3URoWcIA2GVBss9h/FzOYaKxRH+0CpUERoPetmPNyputEe8w3AgNcjGc3J",2046:"sha384-zi7whRpqgEPKBzC5A9gp46qPTot1Ynms6ecmTXBh0QvFvVv+RpaGp8/PQ+ssXc0r",2129:"sha384-MkIjYR7v2d6s1Lzs5yknQS1X0Jixq2MCBvEr+O+ALnjyucDZk+Ek8cEZpPodtAF6",2281:"sha384-nw0KNs+kgcuLG/c89iTaOVt+2mKV1k+OooELGGQdKH766LgZBwtfWWIet8kH/e4I",2289:"sha384-oms2kO1HePM+PTLM7iHvMpO1EJLmEqGl6M9yjfaVmFiqjRMHmQv9SrtFTOSgQTvM",2394:"sha384-E5YtPTv2qhQO8HAjBjmWAcMEgojSppyR0JsYACFK4YO8Tya1OHmfQeSRAJraEmWJ",2468:"sha384-K/pTUADvaiXqmjuQCzuRV0isXQrzM5lvUiuM50F+uQG7mUFKB34HnR2MU7M27jt6",2772:"sha384-ZAcvPolsywRK5RZ1VIZ4KqHETc2HzPqxLA/tYzD7PUoHMDm+iBAnqN2C5A12b3v/",2792:"sha384-DKDKCJKrdS5dxDkQ0r5JEot0p4k+Jn21xZHo03gpP4MEbhweIhtjSytFG89Rr4fX",2811:"sha384-r8qFT6VKXeF7c3fuVrwZhIV1qmPJxeF9q2h5hgwL/G7v1+vhjYvra9hbPfQ7+l1Y",2855:"sha384-ev1Zf8pmosOO3NklYv+lq2eBOc3k3P0PjgtmrJgXD3XB49ivqZlYIbLYciXWWI7B",2902:"sha384-2SVZhhb/Hjwp+wK0u3KdovNviTcIdAZipIaNA4IdoGE5TA0nuMpkdaYrTjF9BDRt",3041:"sha384-Umqw59aC8s81wZUmjhuRZeE1pTgS2eR4u1PGFN3IvkdcXFo0mJ2xkRPn910y00iJ",3075:"sha384-ZoPOG6QDh3vwGWurHX/4QvBYAtNm2O3vYf58W+cT25H0/mPkSC5+7xLTAFxYNUza",3102:"sha384-bhIxGbPfYPS7H/lzrQ3f8ncM/Yc0Y70y4Vb4PmmdH9mrWCGsPBpejmgmlfYUlGVK",3247:"sha384-NsXLvIZ7w6xtpXCriCnA4km8HHQ4RmHdkT+WBnypDy7GIEFxyfa/NxLs0jj+9urM",3268:"sha384-M2i9oTbHxUAtIiWpwRdTe3izVyAR8nX6j/7uZqDlRiCuFmkQC4L4DwWx54z1n5EU",3395:"sha384-6ZuoXQ+XqFCbGwtDcLMmdjPVYuL5OXb6H4KEKp1SomwZIrsE7v/HacdzFHnWKvci",3622:"sha384-dn2N1P+4rEbfrRNeiAqOB3SJKOH/nWh39z/6CAgSi78pMhJDS+hHpV4y88njNqez",3648:"sha384-7Q1/Efa8FC2C6sEz0+2edYlbIPaBS8X5qN65rfh7fHxsscfp66yku9iFU3pi98ob",3787:"sha384-86C9OcOE3ivI633lPY2jhvRmv7RaMWHCRRUtH4VTRvQ21mx5sa4/BEM3n+P1f4Qi",3872:"sha384-l9rsphJxfyFGPJNFbG/vXRE64MIXpwF7FWKNM3UZVEb/jipob+PPuoojShW1s4Q0",4051:"sha384-T7WWzdKMteSaIYLDxJt2VpAxLbgY1dP65Gc5KQuFdWKqVY0U1UPafy9T1DddhAsC",4144:"sha384-MTEV5C/OrcjKB104BMyDPCwS5QwmPaRNCKhosQRTUx1U8RmTufXLWxOSE0jxFwza",4335:"sha384-w5JfAWzJwfzkqZrP8vyuhF53YuQylvpVvPWnN6Nc9HzwFPQ3A+7mpCSRDyQm7ni8",4525:"sha384-4KAVvUDjNf2E2oD1rgXSEEYMzJ7bFud9drRXyNT7zJMNXtH0p3/mbQGh+R6G3hus",4628:"sha384-UmfyeuXGVv8yQ/XNnuQwO88gHbh7ax6XZ8JPrNoF6F7xhwkSDD1gm+SEePN97NZk",4654:"sha384-RQ2Alp663KSWN8eyWiFBHvsO6PGKOvJKWlelLwYriYpViSG7ZZattmRNcSJaGAjg",4809:"sha384-mEIEdX4/W84kO66eCieg/SBL+AGE31BkIwxy0AE3lZV8wbPpohR8z24iaz0D6x2b",5167:"sha384-7/4xK8Ipib+nnezLLBed2XVanMESFIt5akGEdty+8KyG2DNGKjDkCC+tj3AIIAns",5383:"sha384-6PhEEaAG5Jfrx3KC/nizXLQFlbE+e3uas6rZnrvlRvTM7XTBYVRWNIe5UdYof1eP",5467:"sha384-0HsKhiwCWTG1f1uRs7yT24XIQMZnPyxju4Oisqxl2sCh65HDh8rOAd31H3u7elLc",5760:"sha384-xBtP6jk0qR3LPxz2lIwa/zmm9iWqyjAiHwONDTJY/y3nDseSVtj1ucI0WxDWkQa1",5848:"sha384-OKHGyx1twxV1A7isNehnXID5TjLMUwSwQ7xDQjQ1uruVFkffBUVCylrrENZhQOpt",5874:"sha384-SVOz9rljFWq66ZqnBTOJzJeO181+dGMt98KwS+kxlswwnXVHrSKZyFQX37/kqK8x",5911:"sha384-IKMsxH2zdrGPZo2AC+SP9VLLkYLrsivn5eHmIgTiXjLb8G24/DmGpuKbVuxvQasl",6099:"sha384-JLdXOmALO6VWnrVTqNYtq8G0yD8k0wo8f7aOKkv1uWB+/oWg1WcVCYvkG8uqCAtN",6233:"sha384-cmPoRK9m2BBlb1rp/3chkvuXjJtyRdjHqilK0ZYfGbBFdG2f+ORcRxCrGV64zdup",6251:"sha384-aYF9uX0KzSl7cgZ5F8voZYYIONiDFJnTLMPlgO+WvvQNDFl+GppdlJuNJjyQ652p",6338:"sha384-VyobKxh6ii2+5h2as1+Zw6xLFCO+Na5r6FIk46xgq+ZgainFxiZG6mBtu4a5V0x0",6664:"sha384-c+U3e+FSn5Vfx2EQSLH8Ddovq857rJwW/4fJdPdupQIRQdPDEoTUED/fgCss1bXi",6727:"sha384-5bVHw+dM3esMCfS6U6idBSucAeVqoBgGVQx2eGJ2HNd1jPFK4wLAC6RjginCMqdq",6774:"sha384-B4NCNrfOrwZXOHMifS8YaREheH6e7OD9VhDl/UrUaR67LWk7sRbL+n+rAvFqTbnS",6795:"sha384-39ZCsRJwiZbAQ9VdCVcXXiRlfgN0mQcFJ8oqcW6dMox1R20LTM9z+iTgeSrAnxGv",6798:"sha384-o88JAnCoMMqJDoITSwt5rZspnWXc8piCev0VDWvCo5Be6IyHY7cqqN0QQyOHB8Hs",6832:"sha384-/dVahuZ5II582hH/ii6RvsV/MxQ/0mJk/Oi5eUMC+aSPhjcQO/mZGnnM78bznScs",6974:"sha384-yL3XfpS9rykRwsJypeXGKG0K8YH8WEWpffSUYs2COF9b9RDnoj8t1zCwXXsvInTe",7e3:"sha384-b+JHbzGrb2P/AQhP667o8rCExPcXJ50oJyiWLKC4HTYYnLyT4odRLMUWEAira5Bw",7027:"sha384-RvqGitxinuXyguMpnskdqNbL1u8SmeqXzHY3uyVWSLt3DQKDIPsh3Nvj8kCqMYcH",7332:"sha384-sgYYCKtcMSKaWCfpw2Preu+kxOhIuR0BRMTib71D1zLoyPYncTDp+fbVbxjgbrHO",7335:"sha384-9r1AgOXdHEkW8cMSJMcL8C9n74mO0dipLI3rRBHW9jaZFxlPS92Ede3Xgz8uuM5a",7447:"sha384-TegfJc/cTV1fM3lhiIX501cO1XcFmT8b9u2MjxREcfPZeTrqdEn9Xfptfr8IOqdu",7610:"sha384-ow9Qp+hQng3sD6awqFsJTlwtfOHo4/vz/9qiyE+lp6QyhVxoOGwjjYp8bCMbth52",7681:"sha384-H2mDdteN0+uS9RlNx8ckfV/RfxR1/y6bR72DHxEq5lje46tAnFlz8im1/tW/6poF",7805:"sha384-JX9xoy39V5HXC2jp1mc6wv2aUnni5uCmSUX1YW5K0+jCohW6nBZ2z22as6HzNeZ5",7986:"sha384-O6xBy9Gp/Dt0BydUR1W9F8+JIlqaIleIzwpeOLJrwBWeig/iobo9NZXigFQHIGSV",8102:"sha384-w/wFvAQ4FmsUwKjHwCQ1Gim4d5zSyLxn2rXZodV450QNGLurJj1Sio5rhiZfOHTg",8217:"sha384-mprAq7iizmv4bC74jqkR+42wNAja83SyZixuCXjHTDz+0jjuDLkmsHZmUdd23puV",8225:"sha384-ya7K7g7pIbCgcjSxLA+FOzc22mWfDbXafJRmzNKeBjAsile/ocBG0L0FWrQJfI3g",8253:"sha384-fogANTUdq79m5FtzmWGE3QylRZpZ+B2HzvTdy/wDLuSWX6K4EAtFq328blmZveeq",8294:"sha384-Ynup7uXCGgFWy36hFBbD60ArtuTqyZ/qaS9+NzgrEe3mnUrTtWSuoKmmwO5RtR7I",8342:"sha384-5cSRatX2EiNqlNiTgApcAewlCjAV0NIqTbacdhT6r5FjUFbmenXHmSxUzVWq0Coe",8361:"sha384-+AcBxJzSrpxcqqLpU7st5n/gqGViA2/X98wH9JmQYP9G/wW0ucP3i/6pXZtlCTfz",8438:"sha384-Z4qT4hMNKkObzLXqtNf8W/e2NBLxku8ynDqGLEI1ocW/TjudP0YKBShCp/cxpesj",8507:"sha384-3bxyyutB7DmVfznIA/2erllnPVf4J8Q0KTXKJXl48j8+glmB/s65R2x/wj9ouMhC",8530:"sha384-3gwsr/vYJMlMc9B5C6CbnYs423WprRmVbVqzEVg+z5FbukeBxKzccptEYg9H8D2e",8660:"sha384-aY2pBw1DhqCi+nW9aSTLMFWZOCI59/raxs1u0CHUA2+Y7/CQb4FiF2ywNXmTFOFW",8692:"sha384-50tyC1o9j5mheCVK39YoRrohcHEHx2ckPxZ5YMwhVC2cz+6Dvg4K3Rk087jdPNQc",8793:"sha384-pgCDeWpiUdXQW5L9srxjv7pz0SXdpMLm7asyX1aO0MI2CZLC00xQKRhSbbOVJyiY",8904:"sha384-XAeGQ3n113BiJLqVSCHsU8s00cdFCm2pEJls9BOV4Sl5CcMYtQ3yfuAns+85S+oE",9054:"sha384-HEUb+Y4EZab8JY88WcgE+uf6Z50Ik5ttJJ89jiFGV28E1vL55xpwAEX8KHqU4KjK",9173:"sha384-QKp39RjM51kEJiQrPczbBzTHbiRvi8w1Q2vcgC4m5zFqEqKGDRQncg2M7k6mzjFq",9264:"sha384-HZh8doWPeDvoahT7ESilejLEqPQ9GeiupkLA0hdmFghlNN3YmSKPXiGBxCNKDB+1",9275:"sha384-0WqIYX7kofzdZz65mtgk/jBhwiHJx/8XVQXpZyD7F2jrHhmziy5l/LrS8+7L/V/V",9355:"sha384-HOa3k+prwS9oODIforoUinZgRZNGCX1OgF09WHGQ0Nd36Je3LR+0FRzM6rIx+oY6",9545:"sha384-V4GNWh9Meu94G7OGu7GNu5SdetB2t+hntzHLezzl7jns4qZ3iZXKspCBp2hRZqn3",9660:"sha384-DuU4GTc4fDwcYWCG64FtYh31sIeYb4Toy29PSF+QY66UdlSDEuIJvD0FelucPFzJ",9729:"sha384-vU+837Ecq9pCTqTQmik9CXTT9w6FWnR1e4HUbDn6OlhTNtO7koKyLhXcl9YWijb7",9743:"sha384-ppf9z/DUa7o3Cze1DpM7vxcbiqfNEh29ZFnHgHchMTW5dcsOCwfWPVloNIsR7XhU",9754:"sha384-8SsnWHyFPk9cgJE7vyScRM9dnL7/UGOLheTOnzrXmSiPUwsSm8DsBMEErVfGrrcv",9779:"sha384-tdAzkkRHlHHIJ+cg3WKELQVWQU9/KXCcVVZNfqsSOGWvy+7BTYAmauVdyL8rOQmc",9894:"sha384-/vP3HEdgcHjD7saE2UYcZlT/WgcwxHR7gOh68OG3TAvGQ+ts6VQu3HEWsFSGun6r"},function(){if(void 0!==u){var n=u.u,e=u.e,t={},o={};u.u=function(e){return n(e)+(t.hasOwnProperty(e)?"?"+t[e]:"")},u.e=function(i){return e(i).catch((function(e){var r=o.hasOwnProperty(i)?o[i]:5;if(r<1){var a=n(i);throw e.message="Loading chunk "+i+" failed after 5 retries.\n("+a+")",e.request=a,e}return new Promise((function(n){var e=5-r+1;setTimeout((function(){var a="cache-bust=true&retry-attempt="+e;t[i]=a,o[i]=r-1,n(u.e(i))}),0)}))}))}}}(),function(){var n={9520:0};u.f.j=function(e,t){var o=u.o(n,e)?n[e]:void 0;if(0!==o)if(o)t.push(o[2]);else{var i=new Promise((function(t,i){o=n[e]=[t,i]}));t.push(o[2]=i);var r=u.p+u.u(e),a=new Error;u.l(r,(function(t){if(u.o(n,e)&&(0!==(o=n[e])&&(n[e]=void 0),o)){var i=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;a.message="Loading chunk "+e+" failed.\n("+i+": "+r+")",a.name="ChunkLoadError",a.type=i,a.request=r,o[1](a)}}),"chunk-"+e,e)}};var e=function(e,t){var o,i,r=t[0],a=t[1],s=t[2],l=0;if(r.some((function(e){return 0!==n[e]}))){for(o in a)u.o(a,o)&&(u.m[o]=a[o]);s&&s(u)}for(e&&e(t);l<r.length;l++)i=r[l],u.o(n,i)&&n[i]&&n[i][0](),n[i]=0},t=self.webpackChunkMicrosoft_Office_OWL=self.webpackChunkMicrosoft_Office_OWL||[];t.forEach(e.bind(null,0)),t.push=e.bind(null,t.push.bind(t))}(),u.nc=void 0;var a={};!function(){"use strict";u.r(a),u.d(a,{DocRebootSupportMode:function(){return Mo},ExpectedFailureReason:function(){return m.I$},FeatureGateConstants:function(){return Se.Fh},FileType:function(){return T.T},Health:function(){return Bo.S9},HealthLogger:function(){return E.zP},KpiType:function(){return A.o},LogCategory:function(){return v.W},QosErrorName:function(){return m.DG},TraceLevel:function(){return h.G},UlsLogger:function(){return E.G2},WacErrorName:function(){return m.AU},bootDiagnostics:function(){return m.c},bootDocument:function(){return go},bootDocumentWithCustomFunctions:function(){return So},completeCreateNew:function(){return wo},createNewGuid:function(){return g.n},forceEndSession:function(){return fo},getClientUrlForOpenInMobileApp:function(){return po},getDefaultResourceString:function(){return so},getDocumentInfoFromWindow:function(){return Lo},getExpectedFailureReason:function(){return Xe.mN},getFeatureGateConfigByName:function(){return Se.vJ},getFeatureGatesFromString:function(){return Se.i0},getFetchAccessToken:function(){return bo},getFetchItemFromNetwork:function(){return Io},getFileTypeFromExtension:function(){return Vo},getFileTypeFromPath:function(){return Ko},getHootEndpoint:function(){return w.XQ},getOwlVersion:function(){return ao},getPrebootSessionId:function(){return mn},getShareEndpoint:function(){return w.PO},getWebUrlForCopyLinkToPage:function(){return mo},getWiseEnvironmentFromTeamsRing:function(){return cn},initPackage:function(){return ro},isExpectedError:function(){return Xe.Yf},isMobilePhone:function(){return xo},isNetworkError:function(){return Xe.eE},localStorage:function(){return ln.X},logFeatureGateUsage:function(){return Se.dt},notifyHostAccessibilityLoopComplete:function(){return vo},notifyHostBackButtonPressed:function(){return ho},prebootApplication:function(){return hn},prebootDocument:function(){return pn},removePrebootSessionId:function(){return wn},setWacDataCenterValueToCache:function(){return Je},unifiedUiHostConfigs:function(){return Be.J}});var n,e,t=u(533);!function(n){n.Po="App_AccessibilityLoopComplete",n.No="Wac_ActionComplete",n.Oo="WacInitialize_Ready",n.Do="Wac_AppFailed",n._o="Wac_AppBootState",n.Wo="Wac_AppCompleted",n.xo="BrowserEvent",n.Mo="UI_Close",n.jo="App_CloseTab",n.Go="UI_Conversation",n.Bo="UI_CopyAndEdit",n.Lo="App_CreateNewDocument",n.Vo="Wac_AppDataSavedStatus",n.Jo="UI_Download",n.qo="UI_Edit",n.zo="Error",n.Qo="UI_FileEmbed",n.Xo="UI_FileProperties",n.Zo="File_Rename",n.Yo="File_RenameFailed",n.$o="UI_FileVersions",n.ni="StateChanged",n.ei="App_IsFrameTrusted",n.ti="GetAccessToken",n.oi="App_GetAuthToken",n.ii="App_GetCustomAuthConfig",n.ri="App_GetHostKeyValue",n.si="App_WopiInfoFromUrl",n.li="App_DavUrlFromIds",n.ci="App_LoadingStatus",n.di="App_SwitchMode",n.fi="App_MoveToFolder",n.vi="UI_OpenInMobileApp",n.hi="UI_OpenInBrowser",n.mi="UI_OpenInClient",n.wi="PageChanged",n.gi="App_PushCommentContext",n.Si="App_PushState",n.bi="App_DocReboot",n.Ii="UI_RedeemForCommenting",n.Ci="App_RefreshSessionInfo",n.Ai="UI_ReplyWithChanges",n.Ti="UI_ReportAbuse",n.yi="App_FilePicker",n.Hi="UI_SaveStatus",n.Ui="WopiSession_Complete_Ack",n.Ei="SetOverlayContent",n.ki="UI_Sharing",n.Ri="UI_ShareForm",n.Fi="UI_SignIn",n.Pi="App_StoreHostKeyValue",n.Ni="App_Unloaded",n.Oi="App_UlsLog",n.Di="Wac_UnloadingApp",n._i="App_UpdateBootComplete",n.Wi="PageCount",n.xi="UI_CheckUserAccessAndGrantPermissions",n.Mi="User_Activity",n.ji="Edit_Notification",n.Gi="UI_Workflow",n.Bi="ZoomChanged",n.Li="CAAEMessage",n.Vi="Excel_HostFrameCacheSave",n.Ki="Excel_HostFrameCacheEvict",n.Ji="Excel_RegenerateFileBundle",n.qi="App_SwitchToWacFrame",n.zi="App_SaveSSRData",n.Qi="App_PurgeDataInHostCache",n.Xi="App_SaveHostRenderingV2Data",n.Zi="App_SaveHostUtilsData",n.Yi="AcquireOAuthTokenTeams",n.$i="App_SwitchNotebook",n.nr="FailedBoot_CheckFileInfo",n.er="GetTeamsUsers",n.tr="SendTeamsUserMention",n.ir="NavigateBackToHost",n.rr="App_GetClientUrlComplete",n.ur="App_GetWebUrlComplete",n.ar="App_CopyLinkComplete",n.sr="App_SendConversationId",n.lr="CloseTeamsConversation",n.cr="PageLoaded",n.dr="Visio_BRS",n.vr="Visio_SendLicenseInfo",n.hr="Visio_Consumption_CLTComplete",n.pr="Visio_SwitchMode_FromViewFrame",n.mr="Visio_ModeSwitch_ToHost_Ack",n.wr="Visio_UpdateEditUrl",n.gr="Visio_PageViewLoaded",n.Sr="Visio_ActiveAppFrameLoadFailed",n.br="Visio_DisposeBkgFrame",n.Ir="Visio_ReadyToReceiveDocData",n.Cr="Visio_DocReboot_HostNav",n.Ar="Visio_SwitchToVisioFrame",n.Tr="WacAppPerfMetric",n.yr="App_ModifyURLState",n.Hr="App_WacTokenAck"}(n||(n={})),function(n){n.Ur="Ack",n.Er="WacInitialize_Ready_Ack",n.kr="Wac_BeforeUnloadApp",n.Rr="Blur_Focus",n.Fr="Wac_AppFailed_Ack",n.Pr="Wac_AppCompleted_Ack",n.Nr="WopiStartSession_Complete",n.Or="WopiPendingSession_Complete",n.Dr="Host_AccessibilityLoopComplete",n.ei="Host_IsFrameTrusted",n._r="Grab_Focus",n.Wr="HostCacheDiagnostic",n.Mr="Host_KeyValue",n.jr="JsApiDiagnostics",n.fi="Host_MoveToFolder",n.Gr="PageChanged_Ack",n.Br="App_PopState",n.Lr="Host_SendChannelId",n.Vr="Host_SendConversationId",n.Kr="GetTeamsUsers_Reply",n.Jr="SendTeamsUserMention_Reply",n.qr="Host_BackButtonPressed",n.zr="Host_GetClientUrl",n.Qr="Host_GetWebUrl",n.Xr="OwlFrameDiagnostics",n.Zr="File_Rename",n.yi="Host_FilePicker",n.Yr="PostAccessToken",n.$r="Host_SetAuthToken",n.nu="Host_SetCustomAuthConfig",n.eu="App_PushCommentContext",n.tu="CanEmbed",n.ou="Host_RefreshSessionInfo",n.iu="CheckUserAccessAndGrantPermissions_Result",n.ru="Host_WopiInfoFromUrl",n.uu="Host_DavUrlFromIds",n.au="SetCurrentPage",n.su="SetZoomLevel",n.lu="WopiPendingSession_Fail",n.cu="SetOverlayContent",n.du="WopiPendingApplicationComplete_Received",n.fu="Host_SwitchMode",n.vu="Host_Unload",n.hu="PageCount_Ack",n.pu="ZoomChanged_Ack",n.mu="Host_ShareUI",n.wu="Host_Telemetry",n.gu="Visio_ConsumptionCLTComplete_Ack",n.Su="Visio_SwitchMode_FromHF_Ack",n.bu="Visio_SwitchMode_FromHostFrame",n.Iu="Visio_FallbackToLegacySwitch",n.Cu="Visio_DocumentData",n.Au="Host_PostWacToken"}(e||(e={}));var o,i,r,s,l,c,d=function(){function o(o,i,r,u){void 0===u&&(u=!1),this.Tu=new Map,this.yu=o,this.Hu=i,this.Uu=new Set(this.enumValues(n)),this.Eu=new Set(this.enumValues(e)),this.ku=u,this.Ru="",r?"string"==typeof r?this.Fu=new Set([i,r]):Array.isArray(r)?this.Fu=new Set((0,t.ev)([i],r,!0)):"function"==typeof r?(this.Fu=new Set([this.Hu]),this.Pu=r):("string"==typeof r.validOrigins?this.Fu=new Set([i,r.validOrigins]):this.Fu=new Set((0,t.ev)([i],r.validOrigins,!0)),this.Pu=r.validateOrigin):this.Fu=new Set([i]),this.Nu=this.receiveMessage.bind(this),window.addEventListener("message",this.Nu)}return o.prototype.registerHandler=function(n,e){var t=this.Tu.get(n);t?t.push(e):this.Tu.set(n,[e])},o.prototype.sendMessage=function(n,e){var o,i,r=null!==(o=null==e?void 0:e.window)&&void 0!==o?o:this.yu,u=null!==(i=null==e?void 0:e.origin)&&void 0!==i?i:this.Hu;if(this.validateOrigin(u)){var a=void 0;try{a=crypto.randomUUID()}catch(n){a=crypto.getRandomValues(new Uint8Array(16)).join("")}var s=(0,t.pi)((0,t.pi)({},n),{correlationId:a,sendTime:Date.now()});return r.postMessage(JSON.stringify(s),u),a}return!1},o.prototype.dispose=function(){window.removeEventListener("message",this.Nu)},o.prototype.receiveMessage=function(n){if(n.data&&"string"==typeof n.data&&this.validateOrigin(n.origin))try{var e=JSON.parse(n.data);if("MessageId"in e&&"SendTime"in e&&"CorrelationId"in e&&"Values"in e)this.ku&&this.handleCrossDocumentMessage(n.data,e,n.origin);else if(e.id){var t=this.Tu.get(e.id);null==t||t.forEach((function(n){return n(e)}))}}catch(n){}},o.prototype.validateOrigin=function(n){var e,t=!1;return this.Fu.has(n)?t=!0:(null===(e=this.Pu)||void 0===e?void 0:e.call(this,n))&&(this.Fu.add(n),t=!0),t},o.prototype.handleCrossDocumentMessage=function(n,e,t){if(e.MessageId){if(t===this.Hu&&this.Eu.has(e.MessageId))return window.parent.postMessage(n,this.Ru),!0;if(t.endsWith("officeapps.live.com")&&this.Uu.has(e.MessageId))return this.Ru||(this.Ru=t),this.yu.postMessage(n,this.Hu),!0}return!1},o.prototype.enumValues=function(n){return Object.keys(n).map((function(e){return n[e]}))},o}(),f=u(2818),v=u(3650),h=u(8643),p=u(9893),m=u(274),w=u(2022),g=u(4730);!function(n){n[n.external=0]="external",n[n.msa=1]="msa",n[n.aad=2]="aad"}(o||(o={})),function(n){n.init="SharedAuth_Init",n.showSignInCancelButtons="SharedAuth_ShowSignInCancelButtons",n.tryGetToken="SharedAuth_TryGetToken",n.tryLogin="SharedAuth_TryLogin"}(i||(i={})),function(n){n.closeDialog="SharedAuth_CloseDialog",n.getTokenResponse="SharedAuth_GetTokenResponse",n.hideDialog="SharedAuth_HideDialog",n.interactiveFlowReady="SharedAuth_InteractiveFlowReady",n.loginResponse="SharedAuth_LoginResponse",n.scriptInitialized="SharedAuth_ScriptInitialized",n.scriptLoaded="SharedAuth_ScriptLoaded"}(r||(r={})),function(n){n.registerPrimary="SharedAuthWorker_RegisterPrimary",n.unregisterPrimary="SharedAuthWorker_UnregisterPrimary",n.getToken="SharedAuthWorker_GetToken",n.postToken="SharedAuthWorker_PostToken"}(s||(s={})),function(n){n.registrationResponse="SharedAuthWorker_RegistrationResponse",n.brokerToken="SharedAuthWorker_BrokerToken",n.tokenReady="SharedAuthWorker_TokenReady",n.noPrimaryReady="SharedAuthWorker_NoPrimaryReady"}(l||(l={})),function(n){n.timeout="Timeout",n.general="Token Renewal Failed",n.renewal="token_renewal_error"}(c||(c={}));var S=new URL(window.location.href),b=function(){function n(){var n=this;this.startTime=0,this.Ou=function(){},this.Du=function(){},this.promise=new Promise((function(e,t){n.Ou=e,n.Du=t}))}return n.prototype.resolve=function(n){this.Ou(n)},n.prototype.reject=function(n){this.Du(n)},n}();!function(){function n(n,e){var o=this;this._u=0,this.Wu=0,this.initAuthLibrary=function(n){return(0,t.mG)(o,void 0,void 0,(function(){var e,o;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:e=this.storePromiseWrapper("initAuthLibrary"),t.label=1;case 1:return t.trys.push([1,3,,4]),this.xu=n,[4,this.Mu];case 2:return t.sent(),this.ju.contentWindow&&this.ju.contentWindow.postMessage(JSON.stringify({MessageId:i.init,Values:{upn:this.xu.upn,authority:this.xu.authority,interactive:this.xu.interactive,authorityType:this.xu.authorityType,appIds:this.xu.appIds,enableConsoleLogging:this.xu.enableConsoleLogging,enablePopupFlash:this.xu.enablePopupFlash,skipUpnCheck:this.xu.skipUpnCheck,correlationId:this.Gu.getUserSessionId()}}),"*"),[3,4];case 3:throw o=t.sent(),this.Gu.ULS.sendTraceTag(508929187,v.W.Zt,h.G.Error,"[AUTH-BOOTSTRAPPER] Error when initializing authLibrary: ".concat(o)),o;case 4:return[2,e]}}))}))},this.tryGetToken=function(n){return(0,t.mG)(o,void 0,void 0,(function(){var e;return(0,t.Jh)(this,(function(t){e=this.storePromiseWrapper("tryGetToken");try{this.Bu=n,this.ju.contentWindow&&this.ju.contentWindow.postMessage(JSON.stringify({MessageId:i.tryGetToken,Values:{appId:this.Bu.appId,target:this.Bu.target,claims:this.Bu.claims,withPopup:this.Bu.withPopup,messageCorrelationId:this.Bu.messageCorrelationId}}),"*")}catch(n){this.Gu.ULS.sendTraceTag(508929186,v.W.Zt,h.G.Error,"[AUTH-BOOTSTRAPPER] Error when trying to get token")}return[2,e]}))}))},this.receiveMessage=function(n){return(0,t.mG)(o,void 0,void 0,(function(){var e,o,i,u;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:if(n.origin!==this.Lu)return[2];e=JSON.parse(n.data),t.label=1;case 1:switch(t.trys.push([1,9,,10]),e.MessageId){case r.scriptLoaded:return[3,2];case r.scriptInitialized:return[3,3];case r.getTokenResponse:return[3,5]}return[3,7];case 2:return o=e.Values,i=performance.now()-this.Vu,this.Ku.scriptLoaded.resolve(),this.Gu.ULS.sendTraceTag(508934364,v.W.Zt,h.G.Info,"[AUTH-BOOTSTRAPPER] WacOAuth.aspx loaded in ".concat(i," [success: ").concat(o.Success,"] [authLibrary: ").concat(o.AuthLibrary,"]")),[3,8];case 3:return[4,this.libraryInit(e.Values)];case 4:return t.sent(),this.Gu.ULS.sendTraceTag(508859403,v.W.Zt,h.G.Info,"[AUTH-BOOTSTRAPPER] Script initialized"),[3,8];case 5:return[4,this.handleTokenResponse(e.Values)];case 6:return t.sent(),this.Gu.ULS.sendTraceTag(508859402,v.W.Zt,h.G.Info,"[AUTH-BOOTSTRAPPER] getToken response received"),[3,8];case 7:this.Gu.ULS.sendTraceTag(508934362,v.W.Zt,h.G.Info,"[AUTH-BOOTSTRAPPER] Unsupported Message ID, ".concat(e.MessageId)),t.label=8;case 8:return[3,10];case 9:return u=t.sent(),this.Gu.ULS.sendTraceTag(508934361,v.W.Zt,h.G.Error,"[AUTH-BOOTSTRAPPER] Caught error trying to process PostMessage, ".concat(e.MessageId,": ").concat((a=u)instanceof Error?"".concat(a.name,": ").concat(a.message):"string"==typeof a?a:JSON.stringify(a))),[3,10];case 10:return[2]}var a}))}))},this.Gu=null!=e?e:this.createLogger(n),this.Ku={},this.Mu=this.storePromiseWrapper("scriptLoaded");var u="".concat(this.getAuthUrlForEnvironment(n),"?replyUrl=&webworker=1&standalone=1&usid=").concat(this.Gu.getUserSessionId());if(this.ju=document.createElement("iframe"),this.Lu=new URL(u).origin,this.ju.src=u,this.ju.style.cssText="height:0; width:0; display:none;",window.addEventListener("message",this.receiveMessage),this.Vu=performance.now(),document.body.appendChild(this.ju),!this.ju.contentWindow)throw this.Gu.ULS.sendTraceTag(508934363,v.W.Zt,h.G.Error,"[AUTH-BOOTSTRAPPER] The shared auth iframe has no contentWindow"),new Error("iframe has no contentWindow")}n.prototype.createLogger=function(n){var e,t={remoteUlsEndpoint:this.getLogUrlForEnvironment(n),sessionId:null!==(e=S.searchParams.get("usid"))&&void 0!==e?e:void 0};return(0,f.L8)(t)},n.prototype.libraryInit=function(n){return(0,t.mG)(this,void 0,void 0,(function(){var e;return(0,t.Jh)(this,(function(t){return e=this.Ku.initAuthLibrary,n.isSuccess?(e.resolve(!0),this._u=performance.now()-e.startTime,this.Gu.ULS.sendTraceTag(508569551,v.W.Zt,h.G.Info,"[AUTH-BOOTSTRAPPER] Auth library init succeeded, ".concat(this._u)),[2,n.response]):(e.reject(!1),this.Gu.ULS.sendTraceTag(508934360,v.W.Zt,h.G.Error,"[AUTH-BOOTSTRAPPER] Auth library init failed"),[2])}))}))},n.prototype.handleTokenResponse=function(n){return(0,t.mG)(this,void 0,void 0,(function(){var e;return(0,t.Jh)(this,(function(t){if(e=this.Ku.tryGetToken,n.isSuccess){if(e.resolve(!0),this.Wu=performance.now()-e.startTime,this.Gu.ULS.sendTraceTag(508569550,v.W.Zt,h.G.Info,"[AUTH-BOOTSTRAPPER] Get token time, ".concat(this.Wu)),o=window.location.href,new Array("https://www.office.com").includes(o))return[2,n.response];this.Gu.ULS.sendTraceTag(508934359,v.W.Zt,h.G.Warning,"[AUTH-BOOTSTRAPPER] Untrusted frame, cannot send token back")}else e.reject(!1),this.Gu.ULS.sendTraceTag(508934358,v.W.Zt,h.G.Error,"[AUTH-BOOTSTRAPPER] Get token failed");var o;return[2]}))}))},n.prototype.storePromiseWrapper=function(n){var e=new b;return e.startTime=performance.now(),this.Ku[n]=e,e.promise},n.prototype.getAuthUrlForEnvironment=function(n){switch(n){case"FASTFOOD":return"https://ffc-oauth.online.office.com/oa/WacOAuth.aspx";case"MSIT":return"https://ppc-oauth.online.office.com/oa/WacOAuth.aspx";case"PRODUCTION":return"https://oauth.online.office.com/oa/WacOAuth.aspx";case"GALLATIN":return"https://oauth.partner.officewebapps.cn/oa/WacOAuth.aspx";case"USGOV":return"https://gbc-oauth.online.office.com/oa/WacOauth.aspx";case"TRAILBLAZER":return"https://oauth.gov.online.office365.us/oa/WacOauth.aspx";case"PATHFINDER":return"https://oauth.dod.online.office365.us/oa/WacOAuth.aspx";case"AIRGAP08":return"https://oauth.wac.online.office.eaglex.ic.gov/oa/WacOAuth.aspx";case"AIRGAP09":return"https://oauth.wac.online.office.microsoft.scloud/oa/WacOAuth.aspx"}},n.prototype.getLogUrlForEnvironment=function(n){switch(n){case"FASTFOOD":return"https://ffc-oauth.online.office.com/oa/RemoteUls.ashx";case"MSIT":return"https://ppc-oauth.online.office.com/oa/RemoteUls.ashx";case"PRODUCTION":return"https://oauth.online.office.com/oa/RemoteUls.ashx";case"GALLATIN":return"https://oauth.partner.officewebapps.cn/oa/RemoteUls.ashx";case"USGOV":return"https://gbc-oauth.online.office.com/oa/RemoteUls.ashx";case"TRAILBLAZER":return"https://oauth.gov.online.office365.us/oa/RemoteUls.ashx";case"PATHFINDER":return"https://oauth.dod.online.office365.us/oa/RemoteUls.ashx";case"AIRGAP08":return"https://oauth.wac.online.office.eaglex.ic.gov/oa/RemoteUls.ashx";case"AIRGAP09":return"https://oauth.wac.online.office.microsoft.scloud/oa/RemoteUls.ashx"}}}();var I,C,A=u(7430),T=u(6652),y=u(3007),H=u(5457);function U(){var n,e;window.performance&&!((null===(n=window.performance.getEntriesByName(y.r_.OwlHostTimeOrigin))||void 0===n?void 0:n.length)>0||(null===(e=window.performance.getEntriesByName(y.r_.OwlFrameTimeOrigin))||void 0===e?void 0:e.length)>0)&&window.performance.mark("".concat(H.qj.isOwlFrame?y.r_.OwlFrameTimeOrigin:y.r_.OwlHostTimeOrigin),{startTime:0,detail:window.performance.timeOrigin})}!function(n){n.FrameLoaded="Frame_FrameLoaded",n.GetAuthToken="Frame_GetAuthToken",n.BootComplete="Frame_BootComplete",n.SuccessNotification="Frame_OnSuccessNotification",n.BootFailure="Frame_BootFailure",n.ReturnFocus="Frame_ReturnFocus",n.ConversationClose="Frame_ConversationClose",n.NavigateBack="Frame_BackButtonPressed",n.OpenPageLevelConversation="Frame_OpenPageLevelConversation",n.DocumentClose="Frame_DocumentClose",n.OpenInMobileApp="Frame_OpenInMobileApp",n.FetchItemFromNetwork="Frame_FetchItemFromNetwork",n.FetchAccessToken="Frame_FetchAccessToken",n.OpenShareControl="Frame_OpenShareControl",n.CreateDocument="Frame_CreateDocument",n.SetTitle="Frame_SetTitle",n.UserActivity="Frame_UserActivity",n.CAAEMessage="Frame_CAAEMessage",n.UserAccess="Frame_UserAccess",n.MoveToFolder="Frame_MoveToFolder",n.SharedFilePicker="Frame_SharedFilePicker",n.Rename="Frame_Rename",n.FrameChange="Frame_FrameChange",n.InvokeSessionRefreshInfoPopupBlockedDialog="Frame_InvokeSessionRefreshInfoPopupBlockedDialog",n.FileEmbed="Frame_FileEmbed",n.EndSessionResponse="Frame_EndSessionResponse",n.EndSessionObservable="Frame_EndSessionObservable",n.TelemetryData="Frame_TelemetryData"}(I||(I={})),function(n){n.BootApplication="Host_BootApplication",n.BootApplicationWithCustomFunctions="Host_BootApplicationWithCustomFunctions",n.GetAuthTokenResponse="Host_GetAuthTokenResponse",n.EndSession="Host_EndSession",n.HostAccessibilityLoopComplete="Host_AccessibilityLoopComplete",n.GetClientUrl="Host_GetClientUrl",n.GetWebUrl="Host_GetWebUrl",n.BackButtonPressed="Host_BackButtonPressed",n.SendConversationId="Host_SendConversationId",n.PostWacToken="Host_PostWacToken",n.FetchItemFromNetworkResponse="Host_FetchItemFromNetworkResponse",n.FetchAccessTokenResponse="Host_FetchAccessTokenResponse",n.OpenShareControlResponse="Host_OpenShareControlResponse",n.CreateDocumentResponse="Host_CreateDocumentResponse",n.SessionRefreshInfoDialogHandleRefresh="Host_SessionRefreshInfoDialogHandleRefresh",n.SessionRefreshInfoDialogHandleCancel="Host_SessionRefreshInfoDialogHandleCancel",n.SessionRefreshInfoDialogOnDismiss="Host_SessionRefreshInfoDialogOnDismiss",n.SharingLinkTokenProvider="Host_SharingLinkTokenProvider",n.TelemetryData="Host_TelemetryData",n.TokenFetchingExperiment="Host_TokenFetchingExperiment"}(C||(C={}));var E=u(8389);function k(n){var e,o,i,r,u,a,s,l,c,d,f,v,h,p,m,w,g,S,b,I,C,A,T,y,H,U,k,R,F,P,N,O,D,_,W,x,M,j,G,B,L;return{documentIdentifier:n.documentIdentifier,sessionConfig:{hostCorrelationId:n.sessionConfig.hostCorrelationId,isMsa:n.sessionConfig.isMsa,tenantId:n.sessionConfig.tenantId,organizationName:n.sessionConfig.organizationName,sessionId:n.sessionConfig.sessionId,isESSEnabled:n.sessionConfig.isESSEnabled,experiments:n.sessionConfig.experiments,highContrastMode:n.sessionConfig.highContrastMode,additionalApplicationParameters:n.sessionConfig.additionalApplicationParameters,bootDiagnostics:{tabsCacheHit:null===(e=n.sessionConfig.bootDiagnostics)||void 0===e?void 0:e.tabsCacheHit,packageEntryTime:null===(o=n.sessionConfig.bootDiagnostics)||void 0===o?void 0:o.packageEntryTime,isTestMode:null===(i=n.sessionConfig.bootDiagnostics)||void 0===i?void 0:i.isTestMode,isManifestCachingEnabled:null===(r=n.sessionConfig.bootDiagnostics)||void 0===r?void 0:r.isManifestCachingEnabled,isOwlBootstrapperEnabled:null===(u=n.sessionConfig.bootDiagnostics)||void 0===u?void 0:u.isOwlBootstrapperEnabled,isPrebooted:null===(a=n.sessionConfig.bootDiagnostics)||void 0===a?void 0:a.isPrebooted,isVroom21:null===(s=n.sessionConfig.bootDiagnostics)||void 0===s?void 0:s.isVroom21,ringId:null===(l=n.sessionConfig.bootDiagnostics)||void 0===l?void 0:l.ringId,teamsContextStartTime:null===(c=n.sessionConfig.bootDiagnostics)||void 0===c?void 0:c.teamsContextStartTime,teamsContextEndTime:null===(d=n.sessionConfig.bootDiagnostics)||void 0===d?void 0:d.teamsContextEndTime,wopiDataStartTime:null===(f=n.sessionConfig.bootDiagnostics)||void 0===f?void 0:f.wopiDataStartTime,wopiDataEndTime:null===(v=n.sessionConfig.bootDiagnostics)||void 0===v?void 0:v.wopiDataEndTime,bootStrapStartTime:null===(h=n.sessionConfig.bootDiagnostics)||void 0===h?void 0:h.bootStrapStartTime,bootStrapEndTime:null===(p=n.sessionConfig.bootDiagnostics)||void 0===p?void 0:p.bootStrapEndTime,driveItemStartTime:null===(m=n.sessionConfig.bootDiagnostics)||void 0===m?void 0:m.driveItemStartTime,driveItemEndTime:null===(w=n.sessionConfig.bootDiagnostics)||void 0===w?void 0:w.driveItemEndTime,driveItemFromWacStartTime:null===(g=n.sessionConfig.bootDiagnostics)||void 0===g?void 0:g.driveItemFromWacStartTime,driveItemFromWacEndTime:null===(S=n.sessionConfig.bootDiagnostics)||void 0===S?void 0:S.driveItemFromWacEndTime,accessTokenStartTime:null===(b=n.sessionConfig.bootDiagnostics)||void 0===b?void 0:b.accessTokenStartTime,accessTokenEndTime:null===(I=n.sessionConfig.bootDiagnostics)||void 0===I?void 0:I.accessTokenEndTime,isCookieBlocked:null===(C=n.sessionConfig.bootDiagnostics)||void 0===C?void 0:C.isCookieBlocked,meetingLiveDiagnostics:null===(A=n.sessionConfig.bootDiagnostics)||void 0===A?void 0:A.meetingLiveDiagnostics,spRequestGuid:null===(T=n.sessionConfig.bootDiagnostics)||void 0===T?void 0:T.spRequestGuid,createNewStartTime:null===(y=n.sessionConfig.bootDiagnostics)||void 0===y?void 0:y.createNewStartTime,createNewEndTime:null===(H=n.sessionConfig.bootDiagnostics)||void 0===H?void 0:H.createNewEndTime,loadManifestStartTime:null===(U=n.sessionConfig.bootDiagnostics)||void 0===U?void 0:U.loadManifestStartTime,loadManifestEndTime:null===(k=n.sessionConfig.bootDiagnostics)||void 0===k?void 0:k.loadManifestEndTime,getManifestFromRemoteTimeElapsed:null===(R=n.sessionConfig.bootDiagnostics)||void 0===R?void 0:R.getManifestFromRemoteTimeElapsed,loadManifestServerTimeElapsed:null===(F=n.sessionConfig.bootDiagnostics)||void 0===F?void 0:F.loadManifestServerTimeElapsed,loadOwlStartTime:null===(P=n.sessionConfig.bootDiagnostics)||void 0===P?void 0:P.loadOwlStartTime,loadOwlEndTime:null===(N=n.sessionConfig.bootDiagnostics)||void 0===N?void 0:N.loadOwlEndTime,owlBootstrapperStartTime:null===(O=n.sessionConfig.bootDiagnostics)||void 0===O?void 0:O.owlBootstrapperStartTime,owlBootstrapperEndTime:null===(D=n.sessionConfig.bootDiagnostics)||void 0===D?void 0:D.owlBootstrapperEndTime,isOdcMigrated:null===(_=n.sessionConfig.bootDiagnostics)||void 0===_?void 0:_.isOdcMigrated,perfNavigationTiming:(null===(W=n.sessionConfig.bootDiagnostics)||void 0===W?void 0:W.perfNavigationTiming)||(0,E.pb)(),legacyPerformanceData:{host:(null===(M=null===(x=n.sessionConfig.bootDiagnostics)||void 0===x?void 0:x.legacyPerformanceData)||void 0===M?void 0:M.host)||(0,E.vb)()},wacTokenFetchStartTime:null===(j=n.sessionConfig.bootDiagnostics)||void 0===j?void 0:j.wacTokenFetchStartTime,wacTokenFetchEndTime:null===(G=n.sessionConfig.bootDiagnostics)||void 0===G?void 0:G.wacTokenFetchEndTime},uiHostTabId:n.sessionConfig.uiHostTabId,upn:n.sessionConfig.upn,meeting:n.sessionConfig.meeting,customAuthConfigValue:n.sessionConfig.customAuthConfigValue,wiseEnvironment:n.sessionConfig.wiseEnvironment,isSynthetic:n.sessionConfig.isSynthetic,hostUrl:n.sessionConfig.hostUrl,owlVersion:n.sessionConfig.owlVersion,owlRollout:n.sessionConfig.owlRollout,fileType:n.sessionConfig.fileType,clickTime:n.sessionConfig.clickTime,uiCulture:n.sessionConfig.uiCulture,dataCulture:n.sessionConfig.dataCulture,puid:n.sessionConfig.puid,isNewFile:n.sessionConfig.isNewFile,wdValue:n.sessionConfig.wdValue,sessionOrigin:n.sessionConfig.sessionOrigin,intent:n.sessionConfig.intent,hostClientType:n.sessionConfig.hostClientType,isPopOut:n.sessionConfig.isPopOut,teamType:n.sessionConfig.teamType,initPackageParams:n.sessionConfig.initPackageParams&&(0,t.pi)((0,t.pi)({},n.sessionConfig.initPackageParams),{jsApiUrlInfos:(null===(B=n.sessionConfig.initPackageParams)||void 0===B?void 0:B.jsApiUrlInfos)&&nn(null===(L=n.sessionConfig.initPackageParams)||void 0===L?void 0:L.jsApiUrlInfos)}),origin:n.sessionConfig.origin},uiHostConfig:(0,t.pi)((0,t.pi)({},n.uiHostConfig),{featureGates:n.uiHostConfig.featureGates&&nn(n.uiHostConfig.featureGates)})}}function R(n){var e,o,i,r,u,a,s,l;return(0,t.mG)(this,void 0,void 0,(function(){var c,d,f,v,h,p,m;return(0,t.Jh)(this,(function(w){switch(w.label){case 0:return null===(i=null===(o=null===(e=n.sharingLinkTokenProvider)||void 0===e?void 0:e.TokenPromise)||void 0===o?void 0:o.then)||void 0===i||i.call(o,(function(n){c=n})).catch((function(n){d=n})).finally((function(){return null==yo?void 0:yo.sendMessage({id:C.SharingLinkTokenProvider,data:{token:c,error:d}})})),p={documentBootInfo:n.documentBootInfo},f=[(0,t.pi)({},n.sessionConfig)],m={},"string"!=typeof n.sessionConfig.customAuthConfigValue?[3,1]:(v=n.sessionConfig.customAuthConfigValue,[3,3]);case 1:return[4,n.sessionConfig.customAuthConfigValue];case 2:v=w.sent(),w.label=3;case 3:return m.customAuthConfigValue=v,"string"!=typeof n.sessionConfig.hostUrl?[3,4]:(h=n.sessionConfig.hostUrl,[3,6]);case 4:return[4,n.sessionConfig.hostUrl];case 5:h=w.sent(),w.label=6;case 6:return[2,(p.sessionConfig=t.pi.apply(void 0,f.concat([(m.hostUrl=h,m.bootDiagnostics=(0,t.pi)((0,t.pi)({},n.sessionConfig.bootDiagnostics),{perfNavigationTiming:(null===(r=n.sessionConfig.bootDiagnostics)||void 0===r?void 0:r.perfNavigationTiming)||(0,E.pb)(),legacyPerformanceData:(null===(u=n.sessionConfig.bootDiagnostics)||void 0===u?void 0:u.legacyPerformanceData)||{host:(0,E.vb)()}}),m.logger=void 0,m.health=void 0,m)])),p.uiHostConfig=(0,t.pi)((0,t.pi)({},n.uiHostConfig),{featureGates:(null===(a=n.uiHostConfig)||void 0===a?void 0:a.featureGates)&&nn(n.uiHostConfig.featureGates)}),p.additionalApplicationParameters=n.additionalApplicationParameters,p.sharingLinkTokenProvider=!!n.sharingLinkTokenProvider,p.initPackageParams=n.initPackageParams&&(0,t.pi)((0,t.pi)({},n.initPackageParams),{jsApiUrlInfos:(null===(s=n.initPackageParams)||void 0===s?void 0:s.jsApiUrlInfos)&&nn(null===(l=n.initPackageParams)||void 0===l?void 0:l.jsApiUrlInfos)}),p)]}}))}))}function F(n,e){(0,p.l)(y.r_.OwlOnBootComplete),null==Ho||Ho.sendMessage({id:I.BootComplete,data:{docInfo:n,wacBootDiagnostics:e}}),function(){var n=(0,y.ME)(),e=n.bootTelemetryData,t=n.owlTelemetryData;null==Ho||Ho.sendMessage({id:I.TelemetryData,data:{bootTelemetryData:e,owlTelemetryData:t}})}()}function P(n,e){null==Ho||Ho.sendMessage({id:I.BootFailure,data:{errorInfo:n,docInfo:e}})}function N(n){null==Ho||Ho.sendMessage({id:I.ReturnFocus,data:{navigateForward:n}})}function O(){null==Ho||Ho.sendMessage({id:I.ConversationClose,data:{}})}function D(){null==Ho||Ho.sendMessage({id:I.NavigateBack,data:{}})}function _(n,e,t){null==Ho||Ho.sendMessage({id:I.OpenPageLevelConversation,data:{conversationId:n,pageUrl:e,hostSendConversationId:t}})}function W(){null==Ho||Ho.sendMessage({id:I.DocumentClose,data:{}})}function x(){null==Ho||Ho.sendMessage({id:I.SuccessNotification,data:{}})}function M(n,e){null==Ho||Ho.sendMessage({id:I.OpenInMobileApp,data:{openInAppUrl:n,storeUrl:e}})}function j(n,e,o,i){return(0,t.mG)(this,void 0,void 0,(function(){return(0,t.Jh)(this,(function(t){return[2,Uo.getMessagePromise(C.FetchItemFromNetworkResponse,{id:I.FetchItemFromNetwork,data:{docBootInfo:n,forceRefresh:e,zeroByte:o}})]}))}))}function G(n,e,o,i,r,u,a){return(0,t.mG)(this,void 0,void 0,(function(){return(0,t.Jh)(this,(function(t){return[2,Uo.getMessagePromise(C.FetchAccessTokenResponse,{id:I.FetchAccessToken,data:{tokenConsumer:n,forceFetch:e,resourceUrl:o,scope:i,isBoot:r,claims:u,silent:a}})]}))}))}function B(n,e){return(0,t.mG)(this,void 0,void 0,(function(){return(0,t.Jh)(this,(function(t){return[2,Uo.getMessagePromise(C.OpenShareControlResponse,{id:I.OpenShareControl,data:{shareProps:n,isShareDialogueZoomEnabled:e}})]}))}))}function L(n,e){return(0,t.mG)(this,void 0,void 0,(function(){return(0,t.Jh)(this,(function(t){return[2,Uo.getMessagePromise(C.CreateDocumentResponse,{id:I.CreateDocument,data:{createNewInfo:n,template:e}})]}))}))}function V(n){null==Ho||Ho.sendMessage({id:I.SetTitle,data:{title:n}})}function K(){null==Ho||Ho.sendMessage({id:I.UserActivity,data:{}})}function J(){var n=document.createElement("div");return n.id="owl-container",n}function q(n){null==Ho||Ho.sendMessage({id:I.UserActivity,data:n})}function z(n){null==Ho||Ho.sendMessage({id:I.UserAccess,data:n})}function Q(n){null==Ho||Ho.sendMessage({id:I.MoveToFolder,data:n})}function X(n){null==Ho||Ho.sendMessage({id:I.SharedFilePicker,data:n})}function Z(n){null==Ho||Ho.sendMessage({id:I.Rename,data:{newName:n}})}function Y(n){null==Ho||Ho.sendMessage({id:I.FrameChange,data:n})}function $(){null==Ho||Ho.sendMessage({id:I.FileEmbed,data:{}})}function nn(n){return JSON.stringify(Array.from(n.entries()))}function en(n){if(n)try{return new Map(JSON.parse(n))}catch(n){return}}var tn,on=u(5089);function rn(n,e,t,o,i){var r=n.onBootComplete,u=n.onBootFailure,a=n.onSuccessNotification,s=n.onReturnFocus,l=n.onConversationClose,c=n.onNavigateBack,d=n.onOpenPageLevelConversation,f=n.onDocumentClose,v=n.onOpenInMobileApp,h=new on.xQ;return null==yo||yo.registerHandler(I.EndSessionObservable,(function(n){h.next(n.data.rebootInfo),h.complete()})),null==yo||yo.registerHandler(I.BootComplete,(function(n){var e=n.data,t=e.docInfo,o=e.wacBootDiagnostics;null==r||r(t,o)})),null==yo||yo.registerHandler(I.BootFailure,(function(n){return null==u?void 0:u(n.data.errorInfo,n.data.docInfo)})),null==yo||yo.registerHandler(I.ReturnFocus,(function(n){return null==s?void 0:s(n.data.navigateForward)})),null==yo||yo.registerHandler(I.ConversationClose,(function(n){return null==l?void 0:l()})),null==yo||yo.registerHandler(I.NavigateBack,(function(n){return null==c?void 0:c()})),null==yo||yo.registerHandler(I.OpenPageLevelConversation,(function(n){return null==d?void 0:d(n.data.conversationId,n.data.pageUrl,n.data.hostSendConversationId)})),null==yo||yo.registerHandler(I.SuccessNotification,(function(n){return null==a?void 0:a()})),null==yo||yo.registerHandler(I.DocumentClose,(function(n){return null==f?void 0:f()})),null==yo||yo.registerHandler(I.OpenInMobileApp,(function(n){var e;return null==v?void 0:v(n.data.openInAppUrl,null!==(e=n.data.storeUrl)&&void 0!==e?e:"")})),null==yo||yo.registerHandler(I.EndSessionResponse,(function(n){Eo.getHandler(I.EndSessionResponse,tn.Result)(n),Do()})),null==yo||yo.registerHandler(I.TelemetryData,(function(n){!function(n,e,t,o,i){var r=(0,y.ME)(),u=r.bootTelemetryData,a=r.owlTelemetryData;null==yo||yo.sendMessage({id:C.TelemetryData,data:{context:(0,H.T4)(e,t,null==o?void 0:o.featureGates,null==o?void 0:o.uiHostName,null==o?void 0:o.uiHostIntegrationType,i),hostData:{bootTelemetryData:u,owlTelemetryData:a},frameData:n}})}(n.data,e.fileType,t,o,i)})),h.asObservable()}!function(n){n.Item="item",n.Response="response",n.Result="result",n.Token="token",n.URL="url"}(tn||(tn={}));var un=u(9527),an=u(1753),sn=u(2597),ln=u(5416);function cn(n){switch(n){case"ring0":case"ring1":case"ring2":return"FASTFOOD";case"ring3_9":return"MSIT";case"general_gcc":return"USGOV";case"gcchigh":return"TRAILBLAZER";case"dod":return"PATHFINDER";case"ag08":return"AIRGAP08";case"ag09":return"AIRGAP09";case"gallatin":return"GALLATIN";default:return"PRODUCTION"}}var dn=u(394),fn="PrebootDocument",vn="owlfc";function hn(n,e,t){var o=(0,p.a)(),i=(0,f.L8)(),r=(0,un.q_)(n);if(r)if(ln.X){var u=ln.X.getItem(r);if(u)null==i||i.ULS.sendTraceTag(545036514,v.W.io,h.G.Verbose,"prebootDocument: Session is already prebooted with sessionid: "+u);else{var a=(0,g.n)()[0];ln.X.setItem(r,a);var s=new E.zP(a,n.fileType,t).health;null==s||s.updatePartADimensions({applicationLcid:n.uiCulture,loggableUserId:n.puid,sessionOrigin:n.wdOrigin}),null==s||s.addOrUpdatePartCDimension("IsNewFile",(!!n.isNewFile).toString());var l=new Map;l.set("StartTime",(new Date).toUTCString()),null==s||s.recordKpiUsage(fn,A.o.FailureBased,vn,l),l.delete("StartTime"),(0,an.o)(n,e,i).then((function(n){null==i||i.ULS.sendTraceTag(558158863,v.W.io,h.G.Info,"prebootDocument: Attempting to preboot document with sessionid: "+a),function(n,e){var t;if(!n||!e)return!1;var o="access_token="+encodeURIComponent(e.wac.accessToken)+"&access_token_ttl="+encodeURIComponent(e.wac.accessTokenExpiry)+"&bundleSrc="+encodeURIComponent(null!==(t=e.bundleUrl)&&void 0!==t?t:"")+"&user_id="+encodeURIComponent(e.wac.userId),i=function(n){if(!n)return null;var e=(0,dn.k$)(n);if(!e)return null;var t=e.path.substring(0,e.path.lastIndexOf("/"))+"/preboot.ashx";return e.protocol+"//"+e.hostname+t}(e.wac.applicationUrl);if(!i)return!1;var r=encodeURIComponent(e.wac.wopiSrc),u=(0,sn.l_)(),a=new XMLHttpRequest;return a.open("POST",i+"?op=preboot&usid="+encodeURI(n)+"&wopisrc="+r+"&sc="+u),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(o),!0}(a,n.wopiHostData)?i.ULS.sendTraceTag(558158864,v.W.io,h.G.Info,"prebootDocument: Preboot request sent successfully with sessionid: "+a):(null===ln.X||void 0===ln.X||ln.X.removeItem(r),i.ULS.sendTraceTag(545036515,v.W.io,h.G.Info,"prebootDocument: Preboot request cannot be made with sessionid: "+a),l.set("FailureTime",(new Date).toUTCString()),null==s||s.recordKpiFailure(fn,"PrebootRequestFailed",!1,!0,{durationMs:(0,p.a)()-o,extendedProperties:l}))})).catch((function(n){i.ULS.sendTraceTag(558158865,v.W.io,h.G.Warning,"prebootDocument: Failed to send Preboot request with WacDocumentVroomError:"+JSON.stringify(n)),l.set("DriveItemError",JSON.stringify(n)),l.set("FailureTime",(new Date).toUTCString()),null==s||s.recordKpiFailure(fn,"PrebootDriveItemRequestFailed",!1,!1,{durationMs:(0,p.a)()-o,extendedProperties:l}),null===ln.X||void 0===ln.X||ln.X.removeItem(r)}))}}else null==i||i.ULS.sendTraceTag(527471828,v.W.io,h.G.Warning,"prebootDocument: 3rd Party Cookie is blocked! Cannot perform preboot. Bail out.");else null==i||i.ULS.sendTraceTag(558158862,v.W.io,h.G.Verbose,"prebootDocument: Not enough document information was provided. Cannot get unique identifier.")}function pn(n,e,t){hn(n,e,cn(t))}function mn(n){var e=(0,un.q_)(n);return e&&ln.X?ln.X.getItem(e):null}function wn(n,e){if(e){var t=(0,un.q_)(n);if(t)return null===ln.X||void 0===ln.X||ln.X.removeItem(t),!0}return!1}var gn=function(){function n(n){var e=this;this.Ju=!1,this.qu="",this.zu=[],this.Qu=function(n){e.Ju||(e.Ju=!0,e.qu=n?"timeout":"cancelled",e.zu.map((function(n){return n()})),e.zu=[])},this.Xu=n,window.setTimeout((function(){return e.Qu(!0)}),n)}return Object.defineProperty(n.prototype,"isCancelled",{get:function(){return this.Ju},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"timeoutInMs",{get:function(){return this.Xu},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"reason",{get:function(){return this.qu},enumerable:!1,configurable:!0}),n.prototype.cancel=function(){this.Qu(!1)},n.prototype.subscribe=function(n){this.Ju?n():this.zu.push(n)},n}(),Sn=u(5358),bn=u(9697),In=u(1917),Cn=u(6464),An=u(4319),Tn=u(6578),yn=u(1448);function Hn(n,e){return function(t){if("function"!=typeof n)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return t.lift(new Un(n,e))}}var Un=function(){function n(n,e){this.project=n,this.thisArg=e}return n.prototype.call=function(n,e){return e.subscribe(new En(n,this.project,this.thisArg))},n}(),En=function(n){function e(e,t,o){var i=n.call(this,e)||this;return i.project=t,i.count=0,i.thisArg=o||i,i}return Tn.ZT(e,n),e.prototype.B=function(n){var e;try{e=this.project.call(this.thisArg,n,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)},e}(yn.L);function kn(n,e,t,o){return(0,An.m)(t)&&(o=t,t=void 0),o?kn(n,e,t).pipe(Hn((function(n){return(0,Cn.k)(n)?o.apply(void 0,n):o(n)}))):new In.y((function(o){Rn(n,e,(function(n){arguments.length>1?o.next(Array.prototype.slice.call(arguments)):o.next(n)}),o,t)}))}function Rn(n,e,t,o,i){var r;if(function(n){return n&&"function"==typeof n.addEventListener&&"function"==typeof n.removeEventListener}(n)){var u=n;n.addEventListener(e,t,i),r=function(){return u.removeEventListener(e,t,i)}}else if(function(n){return n&&"function"==typeof n.on&&"function"==typeof n.off}(n)){var a=n;n.on(e,t),r=function(){return a.off(e,t)}}else if(function(n){return n&&"function"==typeof n.addListener&&"function"==typeof n.removeListener}(n)){var s=n;n.addListener(e,t),r=function(){return s.removeListener(e,t)}}else{if(!n||!n.length)throw new TypeError("Invalid event target");for(var l=0,c=n.length;l<c;l++)Rn(n[l],e,t,o,i)}o.add(r)}var Fn=u(6387);function Pn(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var Nn=Pn(),On=u(3754);var Dn=u(6519),_n=function(n){if(n&&"function"==typeof n[On.L])return r=n,function(n){var e=r[On.L]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(n)};if((e=n)&&"number"==typeof e.length&&"function"!=typeof e)return i=n,function(n){for(var e=0,t=i.length;e<t&&!n.closed;e++)n.next(i[e]);n.complete()};var e;if(function(n){return!!n&&"function"!=typeof n.subscribe&&"function"==typeof n.then}(n))return o=n,function(n){return o.then((function(e){n.closed||(n.next(e),n.complete())}),(function(e){return n.error(e)})).then(null,Fn.z),n};if(n&&"function"==typeof n[Nn])return t=n,function(n){for(var e=t[Nn]();;){var o=void 0;try{o=e.next()}catch(e){return n.error(e),n}if(o.done){n.complete();break}if(n.next(o.value),n.closed)break}return"function"==typeof e.return&&n.add((function(){e.return&&e.return()})),n};var t,o,i,r,u=(0,Dn.K)(n)?"an invalid object":"'"+n+"'";throw new TypeError("You provided "+u+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};u(4461);var Wn=function(n){function e(e){var t=n.call(this)||this;return t.parent=e,t}return Tn.ZT(e,n),e.prototype.B=function(n){this.parent.notifyNext(n)},e.prototype.Y=function(n){this.parent.notifyError(n),this.unsubscribe()},e.prototype.$=function(){this.parent.notifyComplete(),this.unsubscribe()},e}(yn.L),xn=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return Tn.ZT(e,n),e.prototype.notifyNext=function(n){this.destination.next(n)},e.prototype.notifyError=function(n){this.destination.error(n)},e.prototype.notifyComplete=function(){this.destination.complete()},e}(yn.L);function Mn(n,e,t){return void 0===t&&(t=Number.POSITIVE_INFINITY),"function"==typeof e?function(o){return o.pipe(Mn((function(t,o){return(i=n(t,o),i instanceof In.y?i:new In.y(_n(i))).pipe(Hn((function(n,i){return e(t,n,o,i)})));var i}),t))}:("number"==typeof e&&(t=e),function(e){return e.lift(new jn(n,t))})}var jn=function(){function n(n,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=n,this.concurrent=e}return n.prototype.call=function(n,e){return e.subscribe(new Gn(n,this.project,this.concurrent))},n}(),Gn=function(n){function e(e,t,o){void 0===o&&(o=Number.POSITIVE_INFINITY);var i=n.call(this,e)||this;return i.project=t,i.concurrent=o,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return Tn.ZT(e,n),e.prototype.B=function(n){this.active<this.concurrent?this.Zu(n):this.buffer.push(n)},e.prototype.Zu=function(n){var e,t=this.index++;try{e=this.project(n,t)}catch(n){return void this.destination.error(n)}this.active++,this.Yu(e)},e.prototype.Yu=function(n){var e=new Wn(this),t=this.destination;t.add(e);var o=function(n,e){if(!e.closed){if(n instanceof In.y)return n.subscribe(e);var t;try{t=_n(n)(e)}catch(n){e.error(n)}return t}}(n,e);o!==e&&t.add(o)},e.prototype.$=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(n){this.destination.next(n)},e.prototype.notifyComplete=function(){var n=this.buffer;this.active--,n.length>0?this.B(n.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(xn),Bn=function(){function n(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return n.prototype=Object.create(Error.prototype),n}(),Ln=function(){function n(n){if(this.total=n,this.total<0)throw new Bn}return n.prototype.call=function(n,e){return e.subscribe(new Vn(n,this.total))},n}(),Vn=function(n){function e(e,t){var o=n.call(this,e)||this;return o.total=t,o.count=0,o}return Tn.ZT(e,n),e.prototype.B=function(n){var e=this.total,t=++this.count;t<=e&&(this.destination.next(n),t===e&&(this.destination.complete(),this.unsubscribe()))},e}(yn.L);function Kn(n,e){return function(t){return t.lift(new qn(n,e))}}var Jn,qn=function(){function n(n,e){this.predicate=n,this.thisArg=e}return n.prototype.call=function(n,e){return e.subscribe(new zn(n,this.predicate,this.thisArg))},n}(),zn=function(n){function e(e,t,o){var i=n.call(this,e)||this;return i.predicate=t,i.thisArg=o,i.count=0,i}return Tn.ZT(e,n),e.prototype.B=function(n){var e;try{e=this.predicate.call(this.thisArg,n,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(n)},e}(yn.L),Qn=u(8587),Xn=u(807);!function(n){n.Unavailable="Service Unavailable",n.UnableToConnect="Unable to connect to service",n.NoData="No data retrieved",n.ManyRequest="Too many requests",n.FailToFetchToken="Failed to fetch access token",n.UrlIsNull="Url is null",n.ItemIdOrDriveIdIsNull="ItemId or DriveId is null"}(Jn||(Jn={}));var Zn=u(7971);function Yn(n){var e={Id:"",Details:""},t=Zn.W.InternalServiceError,o=Zn.W.ServiceUnavailable,i=Zn.W.Unknown,r=n.status,u=n.errorCode,a=n.message;switch(r){case Zn.W.OK:e="MissingProperty"===u?{Id:t.toString(),Details:Jn.NoData}:"ParsingResponseFailed"===u?{Id:t.toString(),Details:a.toString()}:{Id:null!=u?u:t.toString(),Details:a.toString()};break;case Zn.W.Unknown:e={Id:i.toString(),Details:Jn.UnableToConnect};break;case Zn.W.ServiceUnavailable:e={Id:o.toString(),Details:Jn.Unavailable};break;default:e={Id:r.toString(),Details:a.toString()}}return e}var $n,ne=u(1877);!function(n){n[n.GetWopiInfoFromUrl=0]="GetWopiInfoFromUrl",n[n.GetDavUrlFromIds=1]="GetDavUrlFromIds"}($n||($n={}));var ee=[],te=!1;function oe(n){switch(n){case $n.GetWopiInfoFromUrl:return Xn.KX.PostMessage_SetHostWopiInfoFromUrl;case $n.GetDavUrlFromIds:return Xn.KX.PostMessage_SetDavUrlFromIds}}function ie(n){switch(n){case $n.GetWopiInfoFromUrl:return m.yv.yo;case $n.GetDavUrlFromIds:return m.yv.Co}}function re(n){switch(n){case $n.GetWopiInfoFromUrl:return m.DG.QosError_WopiInfoFromUrlFailure;case $n.GetDavUrlFromIds:return m.DG.QosError_DavUrlFromIdsFailure}}function ue(n,e,t,o,i,r,u){var a,s,l,c,d,f=ie(n),v=re(n),h=oe(n),p={Url:e.Url,ItemId:e.ItemId,DriveId:e.DriveId,Error:t};try{d=JSON.parse(t.Details)}catch(n){d=void 0}null==u||u.recordKpiFailure(f),null==u||u.recordQosError(v,[m.cS.QosVeto_ExternalLinksExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorName",null!==(s=null===(a=null==d?void 0:d.error)||void 0===a?void 0:a.code)&&void 0!==s?s:t.Id],["ErrorMessage",null!==(c=null===(l=null==d?void 0:d.error)||void 0===l?void 0:l.message)&&void 0!==c?c:t.Details],["HttpErrorCode",t.Id]])}),(0,ne.R)(h,p,i,o,r)}function ae(n,e,t,o,i,r){var u;te=!0;var a=ee.shift();if(a){var s={docUrl:(0,dn.Th)(null!==(u=a.eventArgs.Url)&&void 0!==u?u:"",n.docUrl),docId:a.eventArgs.ItemId,driveId:a.eventArgs.DriveId,fileType:n.fileType,wdOrigin:n.wdOrigin,wdValue:n.wdValue,uiCulture:n.uiCulture,dataCulture:n.dataCulture,puid:n.puid,clickTime:n.clickTime};(0,an.o)(s,e).then((function(n){!function(n,e,t,o,i,r,u){var a=ie(n),s=re(n),l=oe(n);t.fetchedDocumentIdentifier.then((function(s){var c,d,f,v,h,p,m,w,g,S={DriveId:null!==(c=e.DriveId)&&void 0!==c?c:s.driveId,ItemId:null!==(d=e.ItemId)&&void 0!==d?d:s.docId,Url:n===$n.GetWopiInfoFromUrl?e.Url:null===(f=t.wopiHostData)||void 0===f?void 0:f.webDavUrl,WopiSrc:null===(h=null===(v=t.wopiHostData)||void 0===v?void 0:v.wac)||void 0===h?void 0:h.wopiSrc,AccessToken:null===(m=null===(p=t.wopiHostData)||void 0===p?void 0:p.wac)||void 0===m?void 0:m.accessToken,AccessTokenExpiry:null===(g=null===(w=t.wopiHostData)||void 0===w?void 0:w.wac)||void 0===g?void 0:g.accessTokenExpiry};null==u||u.recordKpiSuccess(a),(0,ne.R)(l,S,i,o,r)})).catch((function(n){var e;null==u||u.recordKpiFailure(a),null==u||u.recordQosError(s,[m.cS.QosVeto_ExternalLinksExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorName","Failed to fetch document identifier"],["ErrorMessage",n instanceof Error?"".concat(n.name,": ").concat(n.message):"string"==typeof n?n:JSON.stringify(n)],["HttpErrorCode",null!==(e=n.errorCode)&&void 0!==e?e:"0"]])}),null==r||r.ULS.sendTraceTag(512337542,v.W.io,h.G.Warning,"Failed to fetch document identifier with error: ".concat(n))}))}(a.eventType,a.eventArgs,n,t,o,i,r)})).catch((function(n){var e={status:(null==n?void 0:n.status)||0,errorCode:(null==n?void 0:n.errorCode)||"",message:(null==n?void 0:n.message)||""};ue(a.eventType,a.eventArgs,Yn(e),t,o,i,r)})).finally((function(){te=!1,ee.length>0&&ae(n,e,t)}))}}function se(n,e,o,i,r,u,a,s){return(0,t.mG)(this,void 0,void 0,(function(){var l,c,d,f,v,h;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:null==s||s.addQosPillar("ContentConsumption"),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,o()];case 2:return l=t.sent(),[3,4];case 3:return c=t.sent(),d={Id:"Failed to get current document info",Details:c instanceof Error?"".concat(c.name,": ").concat(c.message):"string"==typeof c?c:JSON.stringify(c)},[2,ue(n,e,d,u,r,a,s)];case 4:return n===$n.GetWopiInfoFromUrl?e.Url||(f={Id:"Url is null",Details:Jn.UrlIsNull.toString()}):n===$n.GetDavUrlFromIds&&(e.ItemId&&e.DriveId||(f={Id:"ItemId or DriveId is null",Details:Jn.ItemIdOrDriveIdIsNull.toString()})),f?[2,ue(n,e,f,u,r,a,s)]:ee.length>=100?(v=Zn.W.Throttled,f={Id:v.toString(),Details:Jn.ManyRequest.toString()},[2,ue(n,e,f,u,r,a,s)]):(h={eventType:n,eventArgs:e},ee.push(h),te||ae(l,i,u,r,a,s),[2])}}))}))}var le,ce,de=700,fe=525,ve=2;function he(n,e,t){var o,i,r=Yn({status:e,errorCode:null!==(o=t.errorCode)&&void 0!==o?o:"",message:null!==(i=t.message)&&void 0!==i?i:""});return n.map((function(n){return{Name:n,Errors:[{Id:r.Id.toString(),Details:r.Details}],SPCorrelationId:t.SPRequestGuid}}))}function pe(n){var e;e=n?"MobileViewer.Label.LinkCopied":"MobileViewer.Label.ErrorCopyingLink";var t=document.createElement("div");t.style.visibility="visible",t.style.position="fixed",t.style.bottom="5px",t.style.backgroundColor="#000000",t.style.color="#fff",t.style.padding="16px",t.style.borderRadius="4px",t.style.height="16px",t.style.left="6px",t.style.right="6px",t.style.fontSize="14px",t.style.fontFamily="-apple-system, Roboto",t.style.display="flex",t.style.alignItems="center",t.textContent=e,document.body.appendChild(t),setTimeout((function(){t.style.visibility="hidden"}),3e3)}!function(n){n[n.Unattempted=0]="Unattempted",n[n.InProgress=1]="InProgress",n[n.NotHandled=2]="NotHandled",n[n.HandleExternally=4]="HandleExternally",n[n.Failed=8]="Failed",n[n.Error=16]="Error",n[n.Succeeded=32]="Succeeded",n[n.Delayed=64]="Delayed"}(le||(le={})),function(n){n.android="android",n.ios="ios",n.ipados="ipados"}(ce||(ce={}));var me,we="PushStateHandler";function ge(n){window.history.pushState(n.State,window.document.title,n.Url)}!function(n){n.AccessibilityLoopCompleted="AccessibilityLoopCompleted",n.ActionCompleted="ActionCompleted",n.BrowserEvent="BrowserEvent",n.CAAEMessage="CAAEMessage",n.Close="Close",n.ContentDisplayed="ContentDisplayed",n.Conversation="Conversation",n.CopyAndEdit="CopyAndEdit",n.CreateNewDocument="CreateNewDocument",n.Download="Download",n.Edit="Edit",n.Error="Error",n.FileEmbed="FileEmbed",n.FileProperties="FileProperties",n.FileRenamed="FileRenamed",n.FileVersions="FileVersions",n.FrameStateChanged="FrameStateChanged",n.FrameTrust="FrameTrust",n.GetAccessToken="GetAccessToken",n.GetAuthToken="GetAuthToken",n.GetCustomAuthConfig="GetCustomAuthConfig",n.GetWopiInfoFromUrl="GetWopiInfoFromUrl",n.GetDavUrlFromIds="GetDavUrlFromIds",n.ModeSwitched="ModeSwitched",n.MoveToFolder="MoveToFolder",n.OpenInMobileApp="OpenInMobileApp",n.OpenInBrowser="OpenInBrowser",n.OpenInClient="OpenInClient",n.PageChanged="PageChanged",n.PushState="PushState",n.Reboot="Reboot",n.RedeemForCommenting="RedeemForCommenting",n.RefreshSessionInfo="RefreshSessionInfo",n.ReplyWithChanges="ReplyWithChanges",n.ReportAbuse="ReportAbuse",n.SessionStarted="SessionStarted",n.SharedFilePicker="SharedFilePicker",n.SaveStatus="SaveStatus",n.Share="Share",n.ShareForm="ShareForm",n.SignIn="SignIn",n.SplashScreenShown="SplashScreenShown",n.UserAccessAndPermissions="UserAccessAndPermissions",n.UserActivity="UserActivity",n.UserEditActivity="UserEditActivity",n.Workflow="Workflow",n.ZoomChanged="ZoomChanged",n.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",n.LoadingStatus="LoadingStatus",n.SwitchNotebook="SwitchNotebook",n.FailedBootCheckFileInfo="FailedBootCheckFileInfo",n.GetTeamsUsers="GetTeamsUsers",n.SendTeamsUserMention="SendTeamsUserMention",n.NavigateBackToHost="NavigateBackToHost",n.GetClientUrlComplete="GetClientUrlComplete",n.GetWebUrlComplete="GetWebUrlComplete",n.CopyLinkComplete="CopyLinkComplete",n.SendConversationId="SendConversationId",n.CloseTeamsConversation="CloseTeamsConversation",n.PageLoaded="PageLoaded",n.FrameChanged="FrameChanged"}(me||(me={}));var Se=u(8807),be=u(5665),Ie="officeapps.live.com",Ce=2e3,Ae=9e3,Te=9500,ye=6e5,He=100,Ue=1e4;function Ee(n){var e,o,i,r,a=(null===(e=n.sessionConfig.bootDiagnostics)||void 0===e?void 0:e.hostPageFirstFlushTime)||(0,p.a)(),s=n.documentBootInfo,l=n.fetchItemFromNetwork,c=n.fetchAccessToken,d=n.sessionConfig,w=n.container,g=n.setTitle,S=n.onBootComplete,b=n.onBootFailure,I=n.onReturnFocus,C=n.onConversationClose,A=n.onNavigateBack,U=n.onOpenPageLevelConversation,E=n.onDocumentClose,k=n.onSuccessNotification,R=n.onDismissHostSpinner,F=n.uiHostConfig,P=n.createDocument,N=n.openShareControl,O=n.onOpenInMobileApp,D=n.sharingLinkTokenProvider,_=n.onUserActivity,W=n.onCAAEMessage,x=n.onUserAccess,M=n.onMoveToFolder,j=n.onSharedFilePicker,G=n.onRename,B=n.initPackageParams,L=n.onFrameChange,V=n.invokeSessionRefreshInfoPopupBlockedDialog,K=n.onFileEmbed,J=n.bootstrapFile,q=null==F?void 0:F.supportsExplicitUnload;d.logger||(d.logger=(0,f.L8)());var z=d.hostCorrelationId,Q=d.isMsa,X=d.tenantId,Z=d.shareApiEndpoint,Y=d.organizationName,$=d.logger,nn=d.hostClientType,en=d.channelId,tn=d.health,rn=(0,sn.ZR)(s.fileType,null==F?void 0:F.featureGates,$);null==$||$.ULS.sendTraceTag(576578584,v.W.io,h.G.Info,"Lean Ui Host: bootApp");var un,ln=new gn(ye),cn=[],fn=function(n){return new Promise((function(e){rn&&!ln&&e("No active session to close. Return from here.");var o=function(n){null==$||$.ULS.sendTraceTag(575411776,v.W.io,h.G.Info,"Dispose the WAC frame. And reboot: ".concat(n?"true":"false")),Fn.next(n),Fn.complete(),Do(),e("WAC frame disposed")},i=function(){s.fileType===T.T.Excel&&(ee=[]),null==En||En.unsubscribe(),null==Rn||Rn.unsubscribe()};if(!pn)return null==$||$.ULS.sendTraceTag(529093076,v.W.io,h.G.Warning,"No active session exists, when endSession is called!! Bail out endSession"),void o(n);if(rn)null==pn||pn.removeEventListener(un),null==ln||ln.cancel(),null==pn||pn.dispose().catch((function(n){null==$||$.ULS.sendTraceTag(527257879,v.W.io,h.G.Error,"Error waiting for Unloaded event from WAC. Force to dispose session if app is not unloaded. appUnloaded: ".concat(Tn,", Error: ").concat(n))})).finally((function(){i(),o(n)}));else if(cn.forEach((function(n){var e=(0,t.CR)(n,2),o=e[0],i=e[1];pn.RemoveEventHandler(o,i)})),null==pn||pn.Dispose(q,function(n){if(n===T.T.OneNote)return Ae}(s.fileType)),i(),q){pn.RegisterEventHandler(Xn.E_.Event_Unloaded,(function(){null==$||$.ULS.sendTraceTag(575411777,v.W.io,h.G.Info,"Receive Unloaded Event from WAC"),Tn=!0,clearTimeout(r),o(n)}));var r=window.setTimeout((function(){null==$||$.ULS.sendTraceTag(575411778,v.W.io,h.G.Info,"Time out on waiting for Unloaded event from WAC. Force to dispose session if app is not unloaded. appUnloaded: ".concat(Tn)),Tn||o(n)}),s.fileType===T.T.OneNote?Te:Ce)}else null==$||$.ULS.sendTraceTag(575271647,v.W.io,h.G.Info,"No Explicit Unload. Tear down the WAC frame to end session."),o(n)}))},vn=function(n,e,o){var i,r,a,f,g=Promise.resolve(null===(i=null==n?void 0:n.wac)||void 0===i?void 0:i.applicationUrl),S=function(){return e.asObservable().pipe((function(n){return n.lift(new Ln(1))})).toPromise()},b=null!==(r=null==F?void 0:F.sessionOriginPrefix)&&void 0!==r?r:"TEAMS.UNIFIEDUIHOST.",y=function(n){var e=this,o=n.getCurrentDocumentInfo,i=n.getWdOrigin,r=n.reboot;return function(n){return(0,t.mG)(e,void 0,void 0,(function(){var e,u,a,s,l,c;return(0,t.Jh)(this,(function(d){switch(d.label){case 0:return[4,o()];case 1:if(e=d.sent(),u=n.previousSessionId,a=n.mode,s={},n.queryOverrides&&"string"==typeof n.queryOverrides)try{s=JSON.parse(n.queryOverrides)}catch(n){s={}}else s=n.queryOverrides||{};return l=n.isNewSession,c={previousSessionId:u,mode:a,queryOverrides:s,isNewSession:l},n.rebootMode===Xn.Bn.NewDocument?r({docUrl:n.documentUrl,fileType:e.fileType,wdOrigin:i(m.J4.BackstageMru),uiCulture:e.uiCulture,dataCulture:e.dataCulture,puid:e.puid,rebootOverrideData:c,clickTime:(0,p.a)()},!1):r((0,t.pi)((0,t.pi)({},e),{wdOrigin:i(m.J4.Reboot),rebootOverrideData:c,clickTime:(0,p.a)()}),!0),[2]}}))}))}}({getCurrentDocumentInfo:S,health:tn,getWdOrigin:function(n){return"".concat(b).concat(n)},reboot:function(n,e){fn({documentBootInfo:n,navigationRequired:!e}).catch((function(){null==$||$.ULS.sendTraceTag(512296464,v.W.io,h.G.Error,"endSession: endSession error in DocumentReboot")}))}}),H=function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,u.e(3648).then(u.bind(u,1820))];case 1:return[4,e.sent().renameHandler(n,o)];case 2:return e.sent(),[2]}}))}))}}({bootedDocumentInfo:e,getCurrentDocumentInfo:S,hostRenameCallback:G,health:tn}),k=function(n){var e=this,o=n.supportsRefreshTokenReauthPopUp,i=n.hostUrl,r=n.documentBootInfo,u=n.fetchItemFromNetwork,a=n.officeDocumentSession,s=n.appUrlPromise,l=n.invokePopupBlockedDialog,c=n.logger,d=n.health,f=0,p=!1,w=!1;return function(n){return(0,t.mG)(e,void 0,void 0,(function(){var e,g,S,b,I,C,A,T,y,H,U,E,k,R,F,P,N,O;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,11]),null==d||d.addQosPillar("Interruptions"),null==c||c.ULS.sendTraceTag(512247693,v.W.io,h.G.Info,"Start token refresh: Application : ".concat(r.fileType,", Origin: ").concat(r.wdOrigin)),[4,(0,an.o)(r,u,c,!0,!1,0)];case 1:return e=t.sent(),g=null==e?void 0:e.wopiHostData.wac,S=n.Tokens.map((function(n){return e=n,o=(t=g).accessTokenExpiry,(i=t[e.charAt(0).toLowerCase()+e.slice(1)])?{Name:e,Expiry:o,Value:i.toString()}:{Name:e,Errors:[{Id:"404",Details:"Could not find this token"}]};var e,t,o,i})),null==d||d.recordKpiSuccess(m.yv.Ao),(0,ne.R)(Xn.KX.PostMessage_RefreshSessionInfo,{Tokens:S},s,a,c),f>0&&(null==c||c.ULS.sendTraceTag(509441036,v.W.io,h.G.Info,"Resetting popup retry count to 0 from ".concat(f," after successful token acquistion")),f=0),[3,11];case 2:b=t.sent(),(I=null!==(R=b.status)&&void 0!==R?R:(null===(F=b.httpResponse)||void 0===F?void 0:F.status)===Zn.W.TokenUnavailable?Zn.W.Unauthorized:null===(P=b.httpResponse)||void 0===P?void 0:P.status)||(null==c||c.ULS.sendTraceTag(508913162,v.W.io,h.G.Warning,"Unable to parse status from error: ".concat(JSON.stringify(b,Object.getOwnPropertyNames(b)),"; status: ").concat(I)),I=0),C=Yn({status:I,errorCode:null!==(N=b.errorCode)&&void 0!==N?N:"",message:null!==(O=b.message)&&void 0!==O?O:""}),t.label=3;case 3:return t.trys.push([3,9,,10]),void 0===I?[3,7]:(null==c||c.ULS.sendTraceTag(512549194,v.W.io,h.G.Warning,"Error while refreshing token - "+b.status),"string"!=typeof i?[3,4]:(T=i,[3,6]));case 4:return[4,i];case 5:T=t.sent(),t.label=6;case 6:return A=T,o&&n.AllowAADPopup&&A&&function(n,e,t){return e<ve&&(n===Zn.W.Unauthorized||n===Zn.W.Forbidden&&t.indexOf("aadInteractionRequired")>-1)}(I,f,C.Details)?(y=function(){var e=n.Tokens.map((function(n){return{Name:n,Errors:[{Id:"202",Details:"AAD Interaction Required"}],SPCorrelationId:b.SPRequestGuid}}));(0,ne.R)(Xn.KX.PostMessage_RefreshSessionInfo,{Tokens:e},s,a,c)},H=function(){if(document.hidden&&f>0||w)y();else{var e=f;f++;var t=function(n,e,t){var o=n.concat("?wacreauth=1"),i=void 0!==window.screenLeft?window.screenLeft:screen.left,r=void 0!==window.screenTop?window.screenTop:screen.top,u=(window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-e/2+i,a=(window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-t/2+r,s=window.open(o,"","scrollbars=yes, width="+e+", height="+t+", top="+a+", left="+u);try{null==s||s.focus()}catch(n){return null}return s}(A,de,fe);if(t)w=!0,setTimeout((function(){t.close(),w=!1}),2e4),y();else{null==c||c.ULS.sendTraceTag(509646289,v.W.io,h.G.Warning,"401 - Popup blocked [retry: ".concat(e,"]"));var o=function(){var e=he(n.Tokens,I,b);null==d||d.recordKpiFailure(m.yv.Ao),null==d||d.recordQosError(m.DG.QosError_WopiRefreshAuthTokenFailure,[m.cS.QosVeto_WopiAuthExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorMessage","Background Auth refresh failure. Supported pop-up did not open."],["AuthError","".concat(C.Details)],["HttpErrorCode","".concat(C.Id.toString())]])}),(0,ne.R)(Xn.KX.PostMessage_RefreshSessionInfo,{Tokens:e},s,a,c)};!l||p||document.hidden?document.hidden?(null==c||c.ULS.sendTraceTag(509084357,v.W.io,h.G.Warning,"Document is hidden"),y()):o():(p=!0,null==c||c.ULS.sendTraceTag(509136921,v.W.io,h.G.Info,"Popup blocked dialog invoked"),l({visible:!0,handleRefresh:function(){null==c||c.ULS.sendTraceTag(509136920,v.W.io,h.G.Info,"Retry button clicked. Resetting retry from ".concat(f," to 0.")),f=0,H()},handleCancel:function(){null==c||c.ULS.sendTraceTag(509136919,v.W.io,h.G.Info,"Continue button clicked"),o()},onDismiss:function(){null==c||c.ULS.sendTraceTag(509136918,v.W.io,h.G.Info,"Dialog was dismissed"),o()}}))}}},H()):(U=he(n.Tokens,I,b),E="",f>=ve?E="Exceeded maximum 401 reauth retry attempts at ".concat(f):I!==Zn.W.Unauthorized||o?I!==Zn.W.Unauthorized||n.AllowAADPopup?I!==Zn.W.Unauthorized&&(E="Do not retry on status codes other than 401"):E="No reauth pop-up support from the application":E="No reauth pop-up support from the host",null==d||d.recordKpiFailure(m.yv.Ao),null==d||d.recordQosError(m.DG.QosError_WopiRefreshAuthTokenFailure,[m.cS.QosVeto_WopiAuthExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorMessage","Background Auth refresh failure.".concat(E?" ".concat(E,"."):"")],["AuthError","".concat(C.Details)],["HttpErrorCode","".concat(C.Id.toString())]])}),(0,ne.R)(Xn.KX.PostMessage_RefreshSessionInfo,{Tokens:U},s,a,c)),[3,8];case 7:null==d||d.recordKpiFailure(m.yv.Ao),null==d||d.recordQosError(m.DG.QosError_WopiRefreshAuthTokenFailure,[m.cS.QosVeto_WopiAuthExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorMessage","Background Auth refresh failure. Status is undefined. This should not happen."],["AuthError","".concat(C.Details)],["HttpErrorCode","".concat(C.Id.toString())]])}),null==c||c.ULS.sendTraceTag(512549195,v.W.io,h.G.Error,"Unexpected error refreshing token ("+JSON.stringify(b)+")"),t.label=8;case 8:return[3,10];case 9:return k=t.sent(),null==d||d.recordKpiFailure(m.yv.Ao),null==d||d.recordQosError(m.DG.QosError_WopiRefreshAuthTokenFailure,[m.cS.QosVeto_WopiAuthExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorMessage","Background Auth refresh failure. Failed to parse error response."],["AuthError","".concat(C.Details)],["HttpErrorCode","".concat(C.Id.toString())]])}),null==c||c.ULS.sendTraceTag(510248914,v.W.io,h.G.Error,"Unexpected error when parsing error ("+k+")"),[3,10];case 10:return[3,11];case 11:return[2]}}))}))}}({hostUrl:null==d?void 0:d.hostUrl,supportsRefreshTokenReauthPopUp:null==F?void 0:F.supportsRefreshTokenReauthPopUp,getCurrentDocumentInfo:S,documentBootInfo:s,fetchItemFromNetwork:l,officeDocumentSession:o,appUrlPromise:g,invokePopupBlockedDialog:V,logger:$,health:tn}),R=function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,u.e(3648).then(u.bind(u,1820))];case 1:return[4,e.sent().shareHandler(n,o)];case 2:return e.sent(),[2]}}))}))}}({getCurrentDocumentInfo:S,sharePointInfo:n.sharePointInfo,shareApiEndPointBase:Z,fetchAccessToken:c,openShareControl:N,correlationId:wn,isMsa:Q,tenantId:X,organizationName:Y,onOpen:function(){(0,ne.R)(Xn.KX.PostMessage_BlurFocus,void 0,An,yn,$)},onClose:function(){(0,ne.R)(Xn.KX.PostMessage_GrabFocus,void 0,An,yn,$)},health:tn,featureGates:null==F?void 0:F.featureGates,logger:$}),J=null!=x?x:function(n){var e=this,o=n.shareHandler,i=n.officeDocumentSession,r=n.appUrlPromise,u=n.logger;return function(n){return(0,t.mG)(e,void 0,void 0,(function(){var e;return(0,t.Jh)(this,(function(t){return e=function(e,t){(0,ne.R)(Xn.KX.PostMessage_GrantPermissions,{Persons:n.Persons.map((function(n){return{Id:n.Id,Provider:n.Provider,Status:e?0:3,Reason:""}})),DialogCanceled:null!=t&&t,Id:n.Id},r,i,u)},o({wdUserSession:n.wdUserSession,mode:"atMention",onGrantAccessComplete:e,defaultRecipients:n.Persons.map((function(n){return n.Id}))}),[2]}))}))}}({getCurrentDocumentInfo:S,shareHandler:R,officeDocumentSession:o,appUrlPromise:g,logger:$,health:tn}),q=function(n){var e=this,o=n.onUserActivity;return function(){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){return o&&o(),[2]}))}))}}({getCurrentDocumentInfo:S,onUserActivity:_,health:tn}),z=function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,u.e(3648).then(u.bind(u,1820))];case 1:return[4,e.sent().createNewHandler(n,o)];case 2:return e.sent(),[2]}}))}))}}({getCurrentDocumentInfo:S,createDocument:P,getWdOrigin:function(n){return"".concat(b).concat(n)},reboot:function(n,e){fn({documentBootInfo:n,navigationRequired:!e}).catch((function(n){var e=(0,Se.vJ)(Se.Fh.FeatureGate_CommandingAshaVetoes,null==F?void 0:F.featureGates);(0,Se.dt)(Se.Fh.FeatureGate_CommandingAshaVetoes,e,$),e&&(null==tn||tn.recordQosError(m.DG.QosError_CreateNewHandlerEndSessionFailure,[m.cS.QosVeto_CreateNewExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorName",m.DG.QosError_CreateNewHandlerEndSessionFailure],["CorrelationId","".concat(wn)],["Reason",n]])})),null==$||$.ULS.sendTraceTag(512296463,v.W.io,h.G.Error,"endSession: endSession error in DocumentCreate")}))},logger:$,health:tn,correlationId:wn}),on=function(n){var e=this,o=n.getCurrentDocumentInfo,i=n.fetchAccessToken,r=n.officeDocumentSession,u=n.appUrlPromise,a=n.logger,s=n.health,l=n.correlationId;return function(n){return(0,t.mG)(e,void 0,void 0,(function(){var e,c,d,f,v;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return[4,o()];case 1:e=t.sent(),t.label=2;case 2:return t.trys.push([2,4,,5]),h=null!==(v=e.docUrl)&&void 0!==v?v:"",c=(0,dn.aE)(h)===dn.o4.OneDrive?"OneDrive":"SharePoint",[4,i(c,!1,n.Resource)];case 3:return d=t.sent(),null==s||s.recordKpiSuccess(m.yv.To),(0,ne.R)(Xn.KX.PostMessage_SetAuthToken,{RequestId:n.RequestId,AuthToken:d.token,TokenExpiration:d.expiryMs?new Date(d.expiryMs):void 0},u,r,a),[3,5];case 4:return f=t.sent(),null==s||s.recordKpiFailure(m.yv.To),null==s||s.recordQosError(m.DG.QosError_WopiFetchAuthTokenFailure,[m.cS.QosVeto_WopiAuthExperienceDegraded],!1,!1,!1,!1,{extendedProperties:new Map([["ErrorName",m.DG.QosError_WopiFetchAuthTokenFailure],["CorrelationId","".concat(l)],["AuthError","".concat(null==f?void 0:f.error)],["ErrorCategory","".concat(null==f?void 0:f.errorCategory)]])}),(0,ne.R)(Xn.KX.PostMessage_SetAuthToken,{RequestId:n.RequestId,Error:"string"==typeof f?f:JSON.stringify(f)},u,r,a),[3,5];case 5:return[2]}var h}))}))}}({getCurrentDocumentInfo:S,fetchAccessToken:c,officeDocumentSession:o,appUrlPromise:g,logger:$,health:tn}),rn=function(n){var e=this,o=n.onOpenPageLevelConversation,i=n.hostSendConversationId,r=n.logger;return function(n){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){return null==r||r.ULS.sendTraceTag(508150792,v.W.io,h.G.Info,"Trying to open the page level conversation"),n?o?(o(n.conversationId,n.pageUrl,i),[2]):(null==r||r.ULS.sendTraceTag(508150790,v.W.io,h.G.Error,"Receiving getSendConversationId message, but no onOpenPageLevelConversation callback is defined!"),[2]):(null==r||r.ULS.sendTraceTag(508150791,v.W.io,h.G.Error,"SendConversationId Response not present"),[2])}))}))}}({getCurrentDocumentInfo:S,onOpenPageLevelConversation:U,hostSendConversationId:Pn,health:tn}),un=function(n){var e=this,o=n.onConversationClose,i=n.logger;return function(){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){return o?(o(),[2]):(null==i||i.ULS.sendTraceTag(508150794,v.W.io,h.G.Error,"Receiving closeTeamsConversation message, but no onConversationClose callback is defined!"),[2])}))}))}}({getCurrentDocumentInfo:S,onConversationClose:C,health:tn}),sn=function(n){var e=this,o=n.onNavigateBack,i=n.logger;return function(){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){return o?(o(),[2]):(null==i||i.ULS.sendTraceTag(508150793,v.W.io,h.G.Error,"Receiving NavigateBackToHostHandler message, but no onNavigateBack callback is defined!"),[2])}))}))}}({getCurrentDocumentInfo:S,onNavigateBack:A,health:tn}),ln=function(n){var e=this,o=n.onReturnFocus,i=n.logger;return function(n){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){if(!o)return null==i||i.ULS.sendTraceTag(576217558,v.W.io,h.G.Error,"Receiving AccessibilityLoopComplete message, but no OnReturnFocus callback is defined!"),[2];switch(n.Direction){case"forward":o(!0);break;case"backward":o(!1);break;default:o()}return[2]}))}))}}({getCurrentDocumentInfo:S,onReturnFocus:I,health:tn}),cn=function(n){var e=this,o=n.getCurrentDocumentInfo,i=n.hostClientType,r=n.logger,u=n.openInMobileAppCallback;return function(n){return(0,t.mG)(e,void 0,void 0,(function(){var e,a;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return null==r||r.ULS.sendTraceTag(526242818,v.W.io,h.G.Info,"Trying to open the ClientUrl}"),n?n.Status!==le.Succeeded.toString()?(null==r||r.ULS.sendTraceTag(526242820,v.W.io,h.G.Error,"Host_GetClientUrl failed with status code ".concat(n.Status)),[2]):(e=n.Url,[4,o()]):(null==r||r.ULS.sendTraceTag(526242819,v.W.io,h.G.Info,"Response not present"),[2]);case 1:return t.sent().fileType!==T.T.OneNote?(null==r||r.ULS.sendTraceTag(525682274,v.W.io,h.G.Info,"This handler is not supported for fileType: ".concat(T.T)),[2]):(i===ce.android?a="market://details?id=com.microsoft.office.onenote":i===ce.ios||i===ce.ipados?a="https://itunes.apple.com/us/app/appname/id410395246":(null==r||r.ULS.sendTraceTag(526242821,v.W.io,h.G.Info,"HostClientType: ".concat(i," not supported.")),a=""),u?(u(e,a),[2]):(null==r||r.ULS.sendTraceTag(512337545,v.W.io,h.G.Error,"openInMobileApp callback is not defined"),[2]))}}))}))}}({getCurrentDocumentInfo:S,hostClientType:nn,logger:$,openInMobileAppCallback:O,health:tn}),vn=function(n){var e=this,o=n.getCurrentDocumentInfo,i=n.logger,r=n.channelId,u=n.officeDocumentSession,a=n.appUrlPromise;return function(){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){switch(n.label){case 0:return[4,o()];case 1:if(n.sent().fileType===T.T.OneNote){if(null==i||i.ULS.sendTraceTag(508036748,v.W.io,h.G.Info,"Sending channel id to WAC after document has been loaded"),!r)return null==i||i.ULS.sendTraceTag(508036747,v.W.io,h.G.Info,"sendChannelIdToWAC: Could not find channel id"),[2];(0,ne.R)(Xn.KX.PostMessage_HostSendChannelId,{channelId:r},a,u,i)}return[2]}}))}))}}({getCurrentDocumentInfo:S,channelId:en,officeDocumentSession:o,appUrlPromise:g,health:tn}),hn=function(n){var e=this,o=n.getCurrentDocumentInfo,i=n.hostClientType,r=n.logger;return function(n){return(0,t.mG)(e,void 0,void 0,(function(){var e,u;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return null==r||r.ULS.sendTraceTag(508352280,v.W.io,h.G.Info,"Trying to copy the WebUrl to clipboard for HostClientType: ".concat(i)),n?n.Status!==le.Succeeded.toString()?(null==r||r.ULS.sendTraceTag(508352279,v.W.io,h.G.Error,"Host_GetWebUrl failed with status code ".concat(n.Status," for HostClientType: ").concat(i)),[2]):n.Url?[4,o()]:(null==r||r.ULS.sendTraceTag(508352277,v.W.io,h.G.Info,"Web Url not present in the response for HostClientType: ".concat(i)),[2]):(null==r||r.ULS.sendTraceTag(508352278,v.W.io,h.G.Info,"Response not present"),[2]);case 1:return t.sent().fileType!==T.T.OneNote?[3,5]:((e=document.createElement("textarea")).style.position="absolute",e.style.opacity="0",e.value=n.Url,document.body.appendChild(e),document.execCommand("RemoveFormat"),u=document.execCommand("copy"),document.body.removeChild(e),u?[3,3]:[4,navigator.clipboard.writeText(n.Url).then((function(){null==r||r.ULS.sendTraceTag(508352276,v.W.io,h.G.Info,"navigator.clipboard command succeeded for HostClientType: ".concat(i,"!")),pe(!0)})).catch((function(n){null==r||r.ULS.sendTraceTag(508352275,v.W.io,h.G.Error,"navigator.clipboard command failed for HostClientType: ".concat(i,", Error: ").concat(n)),pe(!1)}))]);case 2:return t.sent(),[3,4];case 3:null==r||r.ULS.sendTraceTag(508352274,v.W.io,h.G.Info,"ExecCommand 'copy' succeeded for HostClientType: ".concat(i,"!")),pe(!0),t.label=4;case 4:return[3,6];case 5:return null==r||r.ULS.sendTraceTag(508352273,v.W.io,h.G.Info,"This handler is not supported for fileType: ".concat(T.T)),[2];case 6:return[2]}}))}))}}({getCurrentDocumentInfo:S,hostClientType:nn,logger:$,health:tn}),pn=function(n){var e=this,o=n.getCurrentDocumentInfo,i=n.fetchItemFromNetwork,r=n.officeDocumentSession,u=n.appUrlPromise,a=n.logger,s=n.health;return function(n){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,se($n.GetWopiInfoFromUrl,n,o,i,u,r,a,s)];case 1:return e.sent(),[2]}}))}))}}({getCurrentDocumentInfo:S,fetchItemFromNetwork:l,officeDocumentSession:o,appUrlPromise:g,logger:$,health:tn}),mn=function(n){var e=this,o=n.getCurrentDocumentInfo,i=n.fetchItemFromNetwork,r=n.officeDocumentSession,u=n.appUrlPromise,a=n.logger,s=n.health;return function(n){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,se($n.GetDavUrlFromIds,n,o,i,u,r,a,s)];case 1:return e.sent(),[2]}}))}))}}({getCurrentDocumentInfo:S,fetchItemFromNetwork:l,officeDocumentSession:o,appUrlPromise:g,logger:$,health:tn}),gn=function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,u.e(3648).then(u.bind(u,1820))];case 1:return[4,e.sent().actionCompleteHandler(n,o)];case 2:return e.sent(),[2]}}))}))}}({getCurrentDocumentInfo:S,logger:$,webUrl:null!==(a=n.webUrl)&&void 0!==a?a:"",health:tn}),Sn=function(n){var e=this;return function(){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,u.e(3648).then(u.bind(u,1820))];case 1:return e.sent().openInBrowserHandler(n),[2]}}))}))}}({getCurrentDocumentInfo:S,logger:$,webUrl:null!==(f=n.webUrl)&&void 0!==f?f:"",health:tn,correlationId:wn}),bn=function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,u.e(3648).then(u.bind(u,1820))];case 1:return e.sent().openInMobileAppHandler(n,o),[2]}}))}))}}({getCurrentDocumentInfo:S,logger:$,openInMobileAppCallback:O,health:tn,correlationId:wn}),In={appUrlPromise:g,container:w,fetchAccessToken:c,fetchItemFromNetwork:l,getCurrentDocumentInfo:S,host:null==F?void 0:F.uiHostName,health:tn,logger:$,officeDocumentSession:o,wopiHostData:n,sessionConfig:d,uiHostConfig:F,initPackageParams:B},Cn=null!=M?M:function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,u.e(3648).then(u.bind(u,1820))];case 1:return[4,e.sent().moveToFolderFilePickerHandler(n,o)];case 2:return e.sent(),[2]}}))}))}}(In),Tn=null!=j?j:function(n){var e=this;return function(o){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,u.e(3648).then(u.bind(u,1820))];case 1:return[4,e.sent().commonPickerHandler(n,o)];case 2:return e.sent(),[2]}}))}))}}(In),Hn=function(n){var e=this,o=n.customAuthConfigValue,i=n.officeDocumentSession,r=n.appUrlPromise,u=n.logger;return function(){return(0,t.mG)(e,void 0,void 0,(function(){var n,e;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return"string"!=typeof o?[3,1]:(e=o,[3,3]);case 1:return[4,o];case 2:e=t.sent(),t.label=3;case 3:return(n=e)&&(0,ne.R)(Xn.KX.PostMessage_SendCustomAuthConfig,{AuthConfig:n},r,i,u),[2]}}))}))}}({customAuthConfigValue:null==d?void 0:d.customAuthConfigValue,getCurrentDocumentInfo:S,officeDocumentSession:o,appUrlPromise:g,logger:$,health:tn}),Un=function(n){var e=this,o=n.supportsPopAndPushState,i=n.logger,r=n.sharingLinkTokenProvider;return function(n){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){return o?(r&&r.TokenPromise?(null==i||i.ULS.sendTraceTag(528004815,v.W.io,h.G.Info,"".concat(we,": Handling push state with sharing link token")),r.TokenPromise.then((function(e){if(e){var t=new URL(n.Url);t.searchParams.set(e.Key,e.Value),n.Url=t.toString()}ge(n)})).catch((function(n){null==i||i.ULS.sendTraceTag(528004816,v.W.io,h.G.Error,"".concat(we,": Handling push state with sharing link token error ").concat(n))}))):(null==i||i.ULS.sendTraceTag(528004817,v.W.io,h.G.Info,"".concat(we,": Handling push state without sharing link token")),ge(n)),[2]):[2]}))}))}}({getCurrentDocumentInfo:S,supportsPopAndPushState:null==F?void 0:F.supportsPopAndPushState,logger:$,sharingLinkTokenProvider:D,health:tn}),En=function(n){var e=this,o=n.onCAAEMessage;return function(n){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){return o&&o(n),[2]}))}))}}({getCurrentDocumentInfo:S,onCAAEMessage:W,health:tn}),kn=function(n){var e=n.appUrlPromise,t=n.logger,o=n.officeDocumentSession;return function(n){var i={State:n.state,Url:window.location.href};(0,ne.R)(Xn.KX.PostMessage_PopState,i,e,o,t)}}({getCurrentDocumentInfo:S,appUrlPromise:g,logger:$,officeDocumentSession:o,health:tn});!function(n){var e=n.onPopState;n.supportsPopAndPushState&&window.addEventListener("popstate",e)}({getCurrentDocumentInfo:S,onPopState:kn,supportsPopAndPushState:null==F?void 0:F.supportsPopAndPushState,health:tn});var Rn=function(n){var e=this,o=n.onFrameChange;return function(n){return(0,t.mG)(e,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){return o&&o(n),[2]}))}))}}({getCurrentDocumentInfo:S,onFrameChange:L,health:tn});return{documentRebootHandler:y,renameHandler:H,sessionRefreshInfoHandler:k,shareHandler:R,userAccessHandler:J,userActivityHandler:q,createNewHandler:z,getAuthTokenHandler:on,sendConversationIdHandler:rn,closeTeamsConversationHandler:un,navigateBackToHostHandler:sn,accessibilityLoopCompleteHandler:ln,getClientUrlCompleteHandler:cn,getWebUrlCompleteHandler:hn,loadingStatusHandler:vn,wopiInfoFromUrlHandler:pn,davUrlFromIdsHandler:mn,onCloseHandler:function(){null==$||$.ULS.sendTraceTag(575545427,v.W.io,h.G.Info,"Handle UI_Close post message from WAC. onCloseHandler exist: ".concat(E?"true":"false")),E&&E()},actionCompleteHandler:gn,openInBrowserHandler:Sn,openInMobileAppHandler:bn,moveToFolderPickerHandler:Cn,commonFilePickerHandler:Tn,getCustomAuthConfigHandler:Hn,pushStateHandler:Un,caaeMessageHandler:En,frameChangedHandler:Rn,fileEmbedHandler:function(){K&&K()},dismissSplashScreenHandler:function(){var n=document.getElementById("splashscreen-container");n&&(n.style.display="none")}}},hn=(null==B?void 0:B.jsApiUrlInfos)?null==B?void 0:B.jsApiUrlInfos:new Map;0===hn.size&&hn.set(T.T.Word,{jsApiUrl:null===(o=null==B?void 0:B.wordBootstrapperUrlInfo)||void 0===o?void 0:o.url,jsApiSri:null===(i=null==B?void 0:B.wordBootstrapperUrlInfo)||void 0===i?void 0:i.sri,PreloadedInBootStrapper:null===(r=null==B?void 0:B.wordBootstrapperUrlInfo)||void 0===r?void 0:r.wordJsApiPreloadedInBootStrapper});var pn,mn=(0,Qn.Tq)(s,z,l,F,d,b,!1,k,(function(n,e,t,o){pn=n;var i=new bn.X(t),r=vn(e,i,o),u=r.documentRebootHandler,a=r.renameHandler,s=r.sessionRefreshInfoHandler,l=r.shareHandler,c=r.userAccessHandler,d=r.userActivityHandler,f=r.createNewHandler,v=r.getAuthTokenHandler,h=r.sendConversationIdHandler,p=r.closeTeamsConversationHandler,m=r.navigateBackToHostHandler,w=r.accessibilityLoopCompleteHandler,g=r.getClientUrlCompleteHandler,S=r.getWebUrlCompleteHandler,b=r.loadingStatusHandler,I=r.wopiInfoFromUrlHandler,C=r.davUrlFromIdsHandler,A=r.onCloseHandler,y=r.actionCompleteHandler,H=r.openInBrowserHandler,U=r.openInMobileAppHandler,E=r.moveToFolderPickerHandler,P=r.commonFilePickerHandler,N=r.getCustomAuthConfigHandler,O=r.pushStateHandler,D=r.caaeMessageHandler,_=r.frameChangedHandler,W=r.fileEmbedHandler,x=r.dismissSplashScreenHandler,M=(0,Se.vJ)(Se.Fh.FeatureGate_UseNewEuplReporting,null==F?void 0:F.featureGates);un=function(n){var e=n.data;switch(n.type){case me.Reboot:u(e);break;case me.FileRenamed:a(e);break;case me.UserAccessAndPermissions:c(e);break;case me.Share:l(e);break;case me.UserActivity:d(e);break;case me.CreateNewDocument:f(e);break;case me.RefreshSessionInfo:s(e);break;case me.GetAuthToken:v(e);break;case me.AccessibilityLoopCompleted:w(e);break;case me.GetClientUrlComplete:g(e);break;case me.LoadingStatus:b(e);break;case me.GetWebUrlComplete:S(e);break;case me.NavigateBackToHost:m(e);break;case me.SendConversationId:h(e);break;case me.CloseTeamsConversation:p(e);break;case me.GetWopiInfoFromUrl:I(e);break;case me.Close:A();break;case me.ActionCompleted:y(e);break;case me.OpenInBrowser:H(e);break;case me.OpenInMobileApp:U(e);break;case me.MoveToFolder:E(e);break;case me.SharedFilePicker:P(e);break;case me.GetCustomAuthConfig:N(e);break;case me.GetDavUrlFromIds:C(e);break;case me.PushState:O(e);break;case me.CAAEMessage:D(e);break;case me.FrameChanged:_(e);break;case me.FileEmbed:W();break;case me.ContentDisplayed:M&&t.fileType!==T.T.Excel&&(null==k||k(M));break;case me.SessionStarted:M&&t.fileType!==T.T.Excel&&(null==R||R());break;case me.SplashScreenShown:x()}},pn.addEventListener(un)}),ln,hn,J),wn=mn.correlationId,In=mn.bootstrapperObservable,Cn=mn.fileNamePromise,An=mn.applicationUrlPromise;null==$||$.ULS.sendTraceTag(546182048,v.W.io,h.G.Info,"BootApp: Load document returned"),Cn.then((function(n){return null==g?void 0:g(n)})).catch((function(){return"obligatory catch"}));var Tn,yn=void 0,Un=void 0,En=void 0,Rn=void 0,Fn=new on.xQ,Pn=function(n){(0,ne.R)(Xn.KX.PostMessage_HostSendConversationId,{conversationId:n},An,yn,$)};return En=function(n,e,t){return n.pipe(Mn((function(n){return n({container:e,flushTime:t})}),void 0,1))}(In,w,a).subscribe((function(n){var e=n.officeApplication,o=n.bootedDocumentInfo,i=n.wopiHostData,r=n.wopiPendingApp,u=n.officeDocumentSession,a=n.wacBootDiagnostics;pn=e,yn=u,Un=r;var l=kn(window,"message").pipe(Kn((function(n){return!!n.data&&!!n.origin&&n.origin.endsWith(Ie)})),Hn((function(n){return JSON.parse(n.data)})),Kn((function(n){return!(!n||!n.MessageId)})));if(!rn){var c=vn(i,o,u),f=c.documentRebootHandler,m=c.renameHandler,w=c.sessionRefreshInfoHandler,g=c.shareHandler,b=c.userAccessHandler,I=c.userActivityHandler,C=c.createNewHandler,A=c.getAuthTokenHandler,U=c.sendConversationIdHandler,E=c.closeTeamsConversationHandler,k=c.navigateBackToHostHandler,R=c.accessibilityLoopCompleteHandler,P=c.getClientUrlCompleteHandler,N=c.getWebUrlCompleteHandler,O=c.loadingStatusHandler,D=c.wopiInfoFromUrlHandler,_=c.davUrlFromIdsHandler,W=c.onCloseHandler,x=c.actionCompleteHandler,M=c.openInBrowserHandler,j=c.moveToFolderPickerHandler,G=c.commonFilePickerHandler,B=c.getCustomAuthConfigHandler,L=c.pushStateHandler,V=c.caaeMessageHandler,K=c.fileEmbedHandler;cn=[[Xn.Dm.PostMessage_SendConversationId,U],[Xn.Dm.PostMessage_CloseTeamsConversation,E],[Xn.Dm.PostMessage_NavigateBackToHost,k],[Xn.Dm.PostMessage_AccessibilityLoopComplete,R],[Xn.Dm.PostMessage_GetClientUrlComplete,P],[Xn.Dm.PostMessage_GetWebUrlComplete,N],[Xn.Dm.PostMessage_LoadingStatus,O],[Xn.E_.Event_DocumentReboot,f],[Xn.Dm.PostMessage_FileRenamed,m],[Xn.Dm.PostMessage_CheckUserAccess,b],[Xn.Dm.PostMessage_Share,g],[Xn.Dm.PostMessage_UserActivity,I],[Xn.Dm.PostMessage_AppCreateNewDocument,C],[Xn.Dm.PostMessage_OpenInBrowser,M],[Xn.E_.Event_MoveToFolder,j],[Xn.E_.Event_SharedFilePicker,G],[Xn.E_.Event_GetCustomAuthConfig,B],[Xn.Dm.PostMessage_CAAEMessage,V]],s.fileType===T.T.Excel&&(cn.push([Xn.E_.Event_GetWopiInfoFromUrl,D]),cn.push([Xn.E_.Event_GetDavUrlFromIds,_])),cn.forEach((function(n){var o=(0,t.CR)(n,2),i=o[0],r=o[1];e.RegisterEventHandler(i,r)})),Rn=l.subscribe((function(n){switch(n.MessageId){case Xn.Dm.PostMessage_AppRefreshSessionInfo:w(n.Values);break;case Xn.Dm.PostMessage_GetAuthToken:A(n.Values);break;case Xn.Dm.PostMessage_Close:W();break;case Xn.Dm.PostMessage_ActionComplete:x(n.Values);break;case Xn.Dm.PostMessage_AppPushState:L(n.Values);break;case Xn.Dm.PostMessage_FileEmbed:K()}}))}if(S){if(null==$||$.ULS.sendTraceTag(546182049,v.W.io,h.G.Info,"BootApp: About to execute OnBootComplete"),(0,p.l)(y.r_.OwlOnBootComplete),!H.qj.isOwlFrame&&!H.qj.isOwlFrameExperimentEnabled(null==F?void 0:F.featureGates,$)){var J=(0,y.OV)((0,y.vY)("owl"));null==$||$.ULS.sendTraceTag(508568928,v.W.io,h.G.Important,(0,H.T4)(s.fileType,d.wiseEnvironment,null==F?void 0:F.featureGates,null==F?void 0:F.uiHostName,null==F?void 0:F.uiHostIntegrationType,$)+", OwlTraditional Telemetry Data: "+JSON.stringify(J))}S(s,a)}}),(function(n){b&&(null==$||$.ULS.sendTraceTag(546182050,v.W.io,h.G.Info,"BootApp: About to execute OnBootFailure"),b(n)),null==En||En.unsubscribe(),null==Rn||Rn.unsubscribe()})),{endSession:fn,sessionEndObservable:Fn.asObservable(),hostAccessibilityLoopComplete:function(n){return(0,ne.R)(Xn.KX.PostMessage_HostAccessibilityLoopComplete,{Direction:n?"forward":"backward"},An,yn,$),!0},hostGetClientUrl:function(){(0,ne.R)(Xn.KX.PostMessage_HostGetClientUrl,{},An,yn,$)},hostGetWebUrl:function(){(0,ne.R)(Xn.KX.PostMessage_HostGetWebUrl,{},An,yn,$)},postFrameDiagnostics:function(n){(0,ne.R)(Xn.KX.PostMessage_OwlFrameDiagnostics,{FrameDiagnostics:n},An,yn,$)},hostBackButtonPressed:function(){return(0,ne.R)(Xn.KX.PostMessage_HostBackButtonPressed,{},An,yn,$),!0},hostSendConversationId:Pn,postWacToken:function(n){var e,t,o=(0,p.a)();null==$||$.ULS.sendTraceTag(507597022,v.W.io,h.G.Important,"postWacToken flow initiated"),Promise.race([new Promise((function(n){return e=window.setInterval((function(){return(yn||Un)&&n()}),He)})),new Promise((function(n,e){return t=window.setTimeout(e,Ue)}))]).then((function(){yn?(null==$||$.ULS.sendTraceTag(507597021,v.W.io,h.G.Info,"officeDocSession created after ".concat((0,p.a)()-o," ms")),yn.run(Sn.O.postWacToken,{wacToken:n}).catch((function(n){return null==$?void 0:$.ULS.sendTraceTag(507852515,v.W.io,h.G.Warning,"Caught error running postWacToken flow: ".concat(n))}))):Un?(null==$||$.ULS.sendTraceTag(507597020,v.W.io,h.G.Info,"wopiPending created after ".concat((0,p.a)()-o," ms")),Un.PostWacToken(n)):null==$||$.ULS.sendTraceTag(507852514,v.W.io,h.G.Warning,"postWacToken: WopiPending or OfficeDocumentSession is not defined. This should never happen here, only if the promise waiting for them rejects.")})).catch((function(){return null==$?void 0:$.ULS.sendTraceTag(507852513,v.W.io,h.G.Warning,"postWacToken: Timed out waiting for WopiPending or OfficeDocumentSession to be defined.")})).finally((function(){window.clearInterval(e),window.clearTimeout(t)}))},completeCreateNew:function(n){be.r.session?be.r.session.run(Sn.O.completeCreateNew,n).then((function(n){return be.r.completeCreateNew(n)})).catch((function(n){$.ULS.sendTraceTag(507778315,v.W.io,h.G.Warning,"Caught error running completeCreateNew flow: ".concat(n)),be.r.failCreateNew(n)})):($.ULS.sendTraceTag(507778314,v.W.io,h.G.Warning,"Attempting to run completeCreateNew flow without an OfficeDocumentSession."),be.r.failCreateNew(new Error("CreateNewUtils.session is undefined")))}}}var ke,Re=["id","openWith","officebundle","currentUserRole","eTag","name","size","content.downloadUrl","file","sharepointIds","sensitivityLabel","webUrl","webDavUrl","parentReference"];function Fe(n,e,t,o,i,r,u,a,s,l,c,d,f,v,h,p){var m=new E.zP(n,t,e,s,a,l).health;return null==m||m.addQosPillar("Open"),null==m||m.updatePartADimensions({applicationLcid:o,loggableUserId:i,tenantId:r,uiHost:c,uiHostIntegrationType:d,sessionOrigin:f}),null==m||m.addOrUpdatePartCDimension("HostCorrelationId",u),null==m||m.addOrUpdatePartCDimension("AppSessionId",n),null==m||m.addOrUpdatePartCDimension("HostRingId",null!=v?v:"n/a"),null==m||m.addOrUpdatePartCDimension("IsNewFile",(!!h).toString()),null==m||m.addOrUpdatePartCDimension("isOdcMigrated",(!!p).toString()),null==m||m.addOrUpdatePartCDimension("IsTestMode",window.location.pathname.endsWith("/test").toString()),m}var Pe,Ne=null===(ke=document.getElementById("owl"))||void 0===ke?void 0:ke.dataset,Oe="e03a13ee-9730-4cae-8525-47559c8cf18a",De="6a2a0a9e-6f11-4d59-b8a1-afd8bfd2401c";function _e(n,e,o,i,r){return(0,t.mG)(this,void 0,void 0,(function(){var u,a,s,l,c,d,f,m,w,S,b,I,C,A=this;return(0,t.Jh)(this,(function(T){switch(T.label){case 0:return[4,Promise.all([Ge.instance(),n])];case 1:return u=t.CR.apply(void 0,[T.sent(),2]),a=u[0],s=u[1],l=null===e?(0,g.n)()[0]:e,(0,p.l)(y.r_.OwlGetAccountByUsernameStart),c=(0,p.a)(),d=o?s.getAccountByUsername(o):null,(0,p.l)(y.r_.OwlGetAccountByUsernameEnd),f=(0,p.a)(),null==i||i.ULS.sendTraceTag(508053090,v.W.io,h.G.Warning,"[OWL] Msal get user account from cache, take time: ".concat(f-c)),null!==d?[3,3]:[4,xe(s,l,o,i)];case 2:return(m=T.sent())?[2,m.accessToken]:[2,Promise.reject("SsoSilent login failed")];case 3:if(r)try{w=atob(r)}catch(n){return[2,Promise.reject("Failed to decode claims")]}return S={correlationId:e,account:d,scopes:["".concat(Oe,"/.default")],claims:w,enableRTExpiryCheck:!0},(0,p.l)(y.r_.OwlTryGetWacTokenStart),b=(0,p.a)(),I=s.acquireTokenSilent(S),C="",[4,I.then((function(n){if(n.fromCache)if(r){(0,p.l)(y.r_.OwlTryGetWacTokenWithClaimsFromCacheEnd);var e=(0,p.a)();null==i||i.ULS.sendTraceTag(508045138,v.W.io,h.G.Warning,"[OWL] Msal get wac token silently with claims from cache succeed, take time: ".concat(e-b))}else{(0,p.l)(y.r_.OwlTryGetWacTokenFromCacheEnd);var t=(0,p.a)();null==i||i.ULS.sendTraceTag(508122775,v.W.io,h.G.Warning,"[OWL] Msal get wac token silently from cache succeed, take time: ".concat(t-b))}else if(r){(0,p.l)(y.r_.OwlTryGetWacTokenWithClaimsEnd);var o=(0,p.a)();null==i||i.ULS.sendTraceTag(508045137,v.W.io,h.G.Warning,"[OWL] Msal get wac token silently with claim succeed, take time: ".concat(o-b))}else{(0,p.l)(y.r_.OwlTryGetWacTokenEnd);var u=(0,p.a)();null==i||i.ULS.sendTraceTag(508155349,v.W.io,h.G.Info,"[OWL] Msal get wac token silently succeed, take time: ".concat(u-b))}C=n.accessToken})).catch((function(n){return(0,t.mG)(A,void 0,void 0,(function(){var e;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return Se.Fh.FeatureGate_EcsHootGate&&n instanceof a.InteractionRequiredAuthError?[4,je(s,S,i)]:[3,2];case 1:return e=t.sent(),C=e.accessToken,[3,3];case 2:null==i||i.ULS.sendTraceTag(508123353,v.W.io,h.G.Warning,"[OWL] Msal failed to get wac token silently: error ".concat(n)),t.label=3;case 3:return[2]}}))}))}))];case 4:return T.sent(),[2,C]}}))}))}function We(n,e){return(0,t.mG)(this,void 0,void 0,(function(){var o,i,r=this;return(0,t.Jh)(this,(function(u){switch(u.label){case 0:return[4,Ge.instance()];case 1:return o=u.sent(),i=function(n){var e,t;return{appIds:[De],authority:null!==(e=H.yB||(null==Ne?void 0:Ne.authority))&&void 0!==e?e:"",authorityType:n.isMsa?"msa":"aad",upn:null!==(t=n.loginHint||n.upn)&&void 0!==t?t:"string"==typeof n.customAuthConfigValue?JSON.parse(n.customAuthConfigValue).login_Hint:""}}(n),[2,new Promise((function(n){return(0,t.mG)(r,void 0,void 0,(function(){var r,u,a,s,l;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return i.authority&&(i.authority=i.authority.replace(Pe.ProdLegacy,Pe.Prod)),"msa"===i.authorityType.toLowerCase()?i.authority=Pe.Prod+Pe.MsaSuffix:(i.authority||(i.authority=Pe.Prod+Pe.AadSuffix),i.authority.indexOf(Pe.AadSuffix)<0&&("/"===i.authority.charAt(i.authority.length-1)?i.authority+=Pe.AadSuffix:i.authority+="/"+Pe.AadSuffix)),r={auth:{authority:i.authority,clientId:De,redirectUri:"/suite/OAuth.html",clientCapabilities:["CP1"]},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1}},u={disabled:!1,samplingPercentage:1},(0,p.l)(y.r_.OwlMsalInitStart),a=new o.PublicClientApplication(r,u),s=(0,p.a)(),[4,a.initialize()];case 1:return t.sent(),(0,p.l)(y.r_.OwlMsalInitEnd),l=(0,p.a)(),null==e||e.ULS.sendTraceTag(508143306,v.W.io,h.G.Info,"[OWL] Msal init time: ".concat(l-s)),n(a),[2]}}))}))}))]}}))}))}function xe(n,e,o,i){return(0,t.mG)(this,void 0,void 0,(function(){var r,u,a,s,l,c;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return[4,Ge.instance()];case 1:r=t.sent(),u={loginHint:o,correlationId:e,scopes:["".concat(Oe,"/.default")]},t.label=2;case 2:return t.trys.push([2,4,,7]),(0,p.l)(y.r_.OwlMsalSsoSilentStart),a=(0,p.a)(),[4,n.ssoSilent(u)];case 3:return(s=t.sent())&&(l=(0,p.a)(),(0,p.l)(y.r_.OwlMsalSsoSilentEnd),null==i||i.ULS.sendTraceTag(508143305,v.W.io,h.G.Info,"[OWL] Msal ssoSilent succeed, take time: ".concat(a-l))),[2,s];case 4:return c=t.sent(),Se.Fh.FeatureGate_EcsHootGate&&c instanceof r.InteractionRequiredAuthError?[4,Me(n,u,i)]:[3,6];case 5:return[2,t.sent()];case 6:return null==i||i.ULS.sendTraceTag(508143303,v.W.io,h.G.Warning,"[OWL] Msal ssoSilent failed, error: ".concat(c)),[2,Promise.reject(c)];case 7:return[2]}}))}))}function Me(n,e,o,i){return void 0===i&&(i=2),(0,t.mG)(this,void 0,void 0,(function(){var r,u,a,s,l;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,6]),(0,p.l)(y.r_.OwlMsalLoginPopupStart),r=(0,p.a)(),[4,n.loginPopup(e)];case 1:return(u=t.sent())&&(a=(0,p.a)(),(0,p.l)(y.r_.OwlMsalLoginPopupEnd),null==o||o.ULS.sendTraceTag(508123352,v.W.io,h.G.Info,"[OWL] Msal loginPopup succeed, take time: ".concat(a-r))),[2,u];case 2:return s=t.sent(),[4,Ge.instance()];case 3:return l=t.sent(),s instanceof l.BrowserAuthError&&s.errorCode===l.BrowserAuthErrorCodes.popupWindowError&&document.getElementById("authenticationButton")?[4,Me(n,e,o,i-1)]:[3,5];case 4:t.sent(),t.label=5;case 5:return null==o||o.ULS.sendTraceTag(508123351,v.W.io,h.G.Warning,"[OWL] Msal loginPopup failed"),[2,Promise.reject(s)];case 6:return[2]}}))}))}function je(n,e,o,i){return void 0===i&&(i=2),(0,t.mG)(this,void 0,void 0,(function(){var r=this;return(0,t.Jh)(this,(function(u){return[2,new Promise((function(u){return(0,t.mG)(r,void 0,void 0,(function(){var r,a,s,l,c;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,6]),(0,p.l)(y.r_.OwlTryGetWacTokenPopupStart),r=(0,p.a)(),[4,n.acquireTokenPopup(e)];case 1:return(a=t.sent())&&(s=(0,p.a)(),(0,p.l)(y.r_.OwlTryGetWacTokenPopupEnd),null==o||o.ULS.sendTraceTag(508123355,v.W.io,h.G.Info,"[OWL] Msal get wac token through popup succeed, take time: ".concat(s-r)),u(a)),[3,6];case 2:return l=t.sent(),[4,Ge.instance()];case 3:return c=t.sent(),l instanceof c.BrowserAuthError&&l.errorCode===c.BrowserAuthErrorCodes.popupWindowError&&i>0&&document.getElementById("authenticationButton")?[4,je(n,e,o,i-1)]:[3,5];case 4:t.sent(),t.label=5;case 5:return null==o||o.ULS.sendTraceTag(508123354,v.W.io,h.G.Warning,"[OWL] Msal failed to get wac token through popup: error ".concat(l)),[3,6];case 6:return[2]}}))}))}))]}))}))}!function(n){n.Prod="https://login.microsoftonline.com/",n.ProdLegacy="https://login.windows.net/",n.Ppe="https://login.windows-ppe.net/",n.AadSuffix="organizations",n.MsaSuffix="consumers"}(Pe||(Pe={}));var Ge=function(){function n(){}return n.instance=function(){return(0,t.mG)(this,void 0,void 0,(function(){var n;return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return this.lt?[3,2]:((0,p.l)(y.r_.OwlMsalLoadStart),n=this,[4,u.e(2468).then(u.bind(u,8727))]);case 1:n.lt=e.sent(),(0,p.l)(y.r_.OwlMsalLoadEnd),e.label=2;case 2:return[2,this.lt]}}))}))},n}(),Be=u(2685),Le="WacDataCenter";function Ve(n){switch(n){case T.T.Word:case T.T.PowerPoint:case T.T.Excel:case T.T.OneNote:case T.T.Visio:return"".concat(n.toString()).concat(Le);default:return}}function Ke(n){var e,t=Ve(n),o=t?null===localStorage||void 0===localStorage?void 0:localStorage.getItem(t):void 0;return null!==(e=null!=o?o:null===localStorage||void 0===localStorage?void 0:localStorage.getItem(Le))&&void 0!==e?e:void 0}function Je(n,e){if(e){null===localStorage||void 0===localStorage||localStorage.setItem(Le,e);var t=Ve(n);t&&(null===localStorage||void 0===localStorage||localStorage.setItem(t,e))}}var qe,ze,Qe,Xe=u(43),Ze=u(654),Ye=u(2473),$e=u(1561);function nt(n,e,o,i,r){var u=this;void 0===o&&(o=!1),m.c.driveItemStartTime=(0,p.a)(),(0,p.l)("driveItemStartTime"),qe||(qe=new Map);var a=qe.get(n);if(!o&&a&&a.promise&&(!a.expiryTime||a.expiryTime>new Date))return m.c.driveItemEndTime=(0,p.a)(),(0,p.l)("driveItemEndTime"),null==i||i.ULS.sendTraceTag(553726288,v.W.io,h.G.Info,"GetDriveItem: Returning drive item from the cache"),a.promise;null==i||i.ULS.sendTraceTag(553726289,v.W.io,h.G.Info,"GetDriveItem: Invalidating the cache"),qe.delete(n),null==i||i.ULS.sendTraceTag(546182045,v.W.io,h.G.Info,"GetDriveItem: About to make the fetch call to get drive item");var s=n,l={method:Ye.hx.Get,headers:e.headers};if((0,Se.dt)(Se.Fh.FeatureGate_BypassOPTIONSCall,r,i),r){s=n.concat("&ump=1");var c=function(n){var e=(0,$e.c)(),o=[];return o.push("--".concat(e)),void 0!==n&&Object.entries(n).forEach((function(n){var e=(0,t.CR)(n,2),i=e[0],r=e[1];void 0!==r&&o.push("".concat(i,": ").concat(r))})),o.push("X-HTTP-Method-Override: GET"),o.push("\r\n--".concat(e,"--")),{body:o.join("\r\n"),headers:{"Content-Type":"multipart/form-data;boundary=".concat(e)}}}(e.headers),d=c.body,f=c.headers;l={method:Ye.hx.Post,headers:f,body:d},null==i||i.ULS.sendTraceTag(508961629,v.W.io,h.G.Info,"GetDriveItem: POST request to get drive item: content-length : ".concat(d.length))}var w=fetch(s,l).catch((function(n){return Promise.reject({api:"getItem",failure:n,message:"Fetch call failed",retry:!0})})).then((function(e){return(0,t.mG)(u,void 0,void 0,(function(){var o,r,u,a,s,l,c,d,f,p;return(0,t.Jh)(this,(function(g){switch(g.label){case 0:if(200===e.status)return o=e.json().then((function(n){return n||Promise.reject({api:"getItem",status:e.status,message:"Ok httpStatus, invalid response"})})),r=new Map,a=null===(s=null==e?void 0:e.headers)||void 0===s?void 0:s.get("SPRequestGuid"),m.c.spRequestGuid=null!=a?a:void 0,r.set("SPRequestGuid",a),null==i||i.ULS.sendTraceTag(554964099,v.W.io,h.G.Info,"GetDriveItem:  [VroomResponseHeaders: ".concat(JSON.stringify(r),"]")),qe.set(n,{promise:w,expiryTime:(S=new Date,new Date(S.getFullYear(),S.getMonth(),S.getDate(),S.getHours()+24,S.getMinutes(),S.getSeconds(),S.getMilliseconds()))}),[2,o];g.label=1;case 1:return g.trys.push([1,3,,4]),[4,e.json()];case 2:return u=g.sent(),a=null===(l=null==e?void 0:e.headers)||void 0===l?void 0:l.get("SPRequestGuid"),m.c.spRequestGuid=null!=a?a:void 0,[2,Promise.reject((0,t.pi)((0,t.pi)({api:"getItem",SPRequestGuid:a,status:e.status,errorCode:null===(c=null==u?void 0:u.error)||void 0===c?void 0:c.code,innerErrorCode:null===(f=null===(d=null==u?void 0:u.error)||void 0===d?void 0:d.innerError)||void 0===f?void 0:f.code,message:null===(p=null==u?void 0:u.error)||void 0===p?void 0:p.message,redirectLocation:(null==u?void 0:u.error)?null==u?void 0:u.error["@error.redirectLocation"]:void 0},et(e)),{retry:429===e.status||e.status>=500}))];case 3:return g.sent(),[2,Promise.reject({api:"getItem",status:e.status,message:"request failed, could not retrieve error object."})];case 4:return[2]}var S}))}))})).finally((function(){m.c.driveItemEndTime=(0,p.a)(),(0,p.l)("driveItemEndTime")}));return w}function et(n){var e,o,i,r=null===(i=null==n?void 0:n.headers)||void 0===i?void 0:i.get("www-authenticate"),u=void 0,a=void 0;if(r){var s=r.split(",");if(s)try{for(var l=(0,t.XA)(s),c=l.next();!c.done;c=l.next()){var d=c.value,f=d&&d.trim();f&&f.startsWith("error=")?u=f.split('"')[1]:f&&f.startsWith("claims=")&&(a=[f.split('"')[1]])}}catch(n){e={error:n}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(e)throw e.error}}}return{claimsError:u,claims:a}}var tt="getItemFromWac",ot="x-behind-service-response-status",it="GetDriveItem",rt=new Map,ut="owlfc";function at(n,e,o){return(0,t.mG)(this,void 0,void 0,(function(){var i;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:ze=(0,p.a)(),rt.set("StartTime",ze.toString()),o||null==e||e.ULS.sendTraceTag(526951836,v.W.io,h.G.Info,"GetDriveItem: Health object not initialized"),null==o||o.recordKpiUsage(it,A.o.FailureBased,ut,rt),rt.delete("StartTime"),m.c.driveItemFromWacStartTime=(0,p.a)(),(0,p.l)("driveItemFromWacStartTime"),t.label=1;case 1:return t.trys.push([1,3,4,5]),null==e||e.ULS.sendTraceTag(523867683,v.W.io,h.G.Info,"GetDriveItem: About to make the fetch call to get drive item"),[4,fetch(n.url,{method:n.method,headers:n.headers,body:JSON.stringify(n.body)})];case 2:return[2,st(t.sent(),e,o)];case 3:return i=t.sent(),Qe=(0,p.a)(),rt.set("DriveItemError",JSON.stringify(i)),rt.set("FailureTime",Qe.toString()),null==o||o.recordKpiFailure(it,"GetDriveItemFromHootFailed",!1,!1,{durationMs:Qe-ze,extendedProperties:rt}),[2,Promise.reject({api:tt,failure:i,message:"Failed to post request to Hoot"})];case 4:return m.c.driveItemFromWacEndTime=(0,p.a)(),(0,p.l)("driveItemFromWacEndTime"),[7];case 5:return[2]}}))}))}function st(n,e,o){var i,r,u;return(0,t.mG)(this,void 0,void 0,(function(){var a,s;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:if(n.status===Zn.W.OK)return[2,lt(n,e)];Qe=(0,p.a)(),rt.set("FailureTime",Qe.toString()),null==o||o.recordKpiFailure(it,"WacHootServiceNotAvailable",!1,!0,{durationMs:Qe-ze,extendedProperties:rt}),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,n.json()];case 2:return a=t.sent(),s=null===(i=null==n?void 0:n.headers)||void 0===i?void 0:i.get("SPRequestGuid"),m.c.spRequestGuid=null!=s?s:void 0,[2,Promise.reject({api:tt,SPRequestGuid:s,status:n.status,errorCode:null===(r=null==a?void 0:a.error)||void 0===r?void 0:r.code,message:null===(u=null==a?void 0:a.error)||void 0===u?void 0:u.message})];case 3:return t.sent(),[2,Promise.reject({api:tt,status:n.status,message:"Request to Hoot failed, could not reach out Hoot for retrieving object."})];case 4:return[2]}}))}))}function lt(n,e){var o,i,r=null===(o=null==n?void 0:n.headers)||void 0===o?void 0:o.get(ot),u=r?parseInt(r,10):Zn.W.InternalServiceError,a=new Map,s=null===(i=null==n?void 0:n.headers)||void 0===i?void 0:i.get("SPRequestGuid");return m.c.spRequestGuid=null!=s?s:void 0,a.set("SPRequestGuid",s),null==e||e.ULS.sendTraceTag(526951837,v.W.io,h.G.Info,"GetDriveItemFromWac: [VroomResponseHeaders: ".concat(JSON.stringify(a),"]. The http response status code from downstream service to Hoot: ").concat(u.toString())),u===Zn.W.OK?n.json().then((function(e){return e?function(n){var e,t,o,i,r,u,a,s;return m.c.hootRequestToWacServiceStart=null===(e=n.perfMarkers)||void 0===e?void 0:e.requestToWacServiceStart,m.c.hootTokenValidationStart=null===(t=n.perfMarkers)||void 0===t?void 0:t.hootTokenValidationStart,m.c.hootTokenValidationEnd=null===(o=n.perfMarkers)||void 0===o?void 0:o.hootTokenValidationEnd,m.c.hootPopGenerationStart=null===(i=n.perfMarkers)||void 0===i?void 0:i.hootPopGenerationStart,m.c.hootPopGenerationEnd=null===(r=n.perfMarkers)||void 0===r?void 0:r.hootPopGenerationEnd,m.c.hootVroomCallStart=null===(u=n.perfMarkers)||void 0===u?void 0:u.hootVroomCallStart,m.c.hootVroomCallEnd=null===(a=n.perfMarkers)||void 0===a?void 0:a.vroomCallEnd,m.c.hootResponseToClientComplete=null===(s=n.perfMarkers)||void 0===s?void 0:s.hootResponseToClientComplete,n}(e):Promise.reject({api:tt,SPRequestGuid:s,status:n.status,message:"Ok httpStatus, invalid response"})})):Promise.reject((0,t.pi)({api:tt,SPRequestGuid:s,status:n.status,sharePointCallStatus:u,message:"Post request to Hoot succeed, Hoot failed to retrieve object from downstream service."},et(n)))}var ct="Failed to parse stringified drive item.";function dt(n,e,o,i,r,u,a,s,l){return(0,t.mG)(this,void 0,void 0,(function(){var c,d,f,m,g,S,b,I,C,A,T;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return c={docBootInfo:n,essOptions:e,api:r},d=(0,w.XQ)(i,u),(0,p.l)(y.r_.OwlMsalGetAccessTokenStart),[4,_e(o,u,a,s)];case 1:if(!(f=t.sent()))return[2,Promise.reject("Failed to fetch necessary Wac token.")];(0,p.l)(y.r_.OwlMsalGetAccessTokenEnd),g=ft(m={accept:"application/json"},c,d,u,f),t.label=2;case 2:return t.trys.push([2,4,,9]),(0,p.l)(y.r_.OwlGetDriveItemStart),[4,at(g,s,l)];case 3:if(!(A=t.sent()))return[2,Promise.reject("Failed to fetch DriveItem from Hoot.")];if((0,p.l)(y.r_.OwlGetDriveItemEnd),!(T=vt(A,s)))throw new SyntaxError(ct);return[2,T];case 4:return(S=t.sent())instanceof SyntaxError||null==s||s.ULS.sendTraceTag(508155348,v.W.io,h.G.Warning,"Failed to get vroom data from Hoot. [Error: ".concat(JSON.stringify(S),"] [Reason: ").concat(null==S?void 0:S.failure,"]")),S&&401===S.sharePointCallStatus&&"insufficient_claims"===S.claimsError&&S.claims?(null==s||s.ULS.sendTraceTag(508155347,v.W.io,h.G.Warning,"Hoot Vroom call failed with claims challenge, retrying with claims."),[4,_e(o,u,a,s,S.claims)]):[3,7];case 5:return(b=t.sent())?[4,at(ft(m,c,d,u,b),s,l)]:[2,Promise.reject("Failed to fetch necessary Wac token with Claims")];case 6:return I=t.sent(),(C=vt(I,s))?[2,C]:[2,Promise.reject(ct)];case 7:return[4,at(g,s,l)];case 8:return A=t.sent(),(T=vt(A,s))?[2,T]:[2,Promise.reject(ct)];case 9:return[2]}}))}))}function ft(n,e,o,i,r){var u,a={Authorization:null!==(u=ht(r).Authorization)&&void 0!==u?u:"",SessionId:i},s=(0,t.pi)((0,t.pi)({},e),{optionsHttpRequestHeaders:a});return{url:o,method:Ye.hx.Post,headers:n,body:s}}function vt(n,e){try{return JSON.parse(n.graphDriveItem)}catch(n){return null==e||e.ULS.sendTraceTag(508155346,v.W.io,h.G.Error,"Failed to parse Vroom response from JSON string. [".concat(n.name,": ").concat(n.message,"]")),null}}function ht(n,e){var t=null!=e?e:{};return n?(t.Authorization="Bearer ".concat(n).trim(),t):t}var pt=u(3956);function mt(n){if(n&&n.length){if(n.match(dn.pK)||n.match(dn.XU))return"OneDrive";if(n.match(dn.VJ))return"SharePoint";if(n.match(dn.JK))return"Graph"}}var wt=function(n){return"action=".concat(n)},gt=function(n){return(null==n?void 0:n.isESSEnabled)&&(null==n?void 0:n.wacDataCenter)?[St(null==n?void 0:n.wacDataCenter),bt(null==n?void 0:n.sessionId),It(null==n?void 0:n.hostCorrelationId)]:[]},St=function(n){return n?"WacDataCenter=".concat(n):void 0},bt=function(n){return n?"usid=".concat(n):void 0},It=function(n){return n?"hid=".concat(n):void 0},Ct=function(n){return n&&n.length?"$select="+n.join(","):void 0};function At(n){return(0,pt.sm)(n,{accept:"application/json",prefer:"allow-zerobyte"})}function Tt(n,e,o,i,r,u,a,s){return void 0===r&&(r=!1),void 0===s&&(s=At),(0,t.mG)(this,void 0,void 0,(function(){return(0,t.Jh)(this,(function(t){return n?[2,e(o,r,i,void 0,!0).then(s).then((function(e){return nt(n,{headers:e},r,u,a)})).catch((function(t){return null==u||u.ULS.sendTraceTag(512255580,v.W.io,h.G.Warning,"GetDriveItemWithUrl: error when trying to getDriveItem: ".concat(t)),t&&401===t.status&&"insufficient_claims"===t.claimsError&&"authChallengeRequired"===t.innerErrorCode&&t.claims?(null==u||u.ULS.sendTraceTag(523076960,v.W.io,h.G.Warning,"GetDriveItemWithUrl: vroom call failed with claims challenge. Retry with claims"),e(o,r,i,void 0,!0,t.claims).then(s).then((function(e){return nt(n,{headers:e},r,u,a)}))):Promise.reject(t)}))]:[2,Promise.reject("No api endpoint given")]}))}))}function yt(n){var e={accept:"application/json",prefer:"redeemSharingLink,allow-zerobyte,manualRedirect"};return(0,pt.sm)(n,e),e}var Ht,Ut=function(n){return n?"expand=thumbnails":""};function Et(n,e,o,i,r,u,a,s,l){void 0===i&&(i=!1),void 0===r&&(r="open"),void 0===u&&(u=!1);var c=o.inMockMode,d=o.getAccessToken,f=function(n,e){try{null==e||e.ULS.sendTraceTag(541870043,v.W.io,h.G.Info,"getSharesUrl: Start constructing shares Url");for(var t=n.replace(/[,@+$#]/g,(function(n){return encodeURIComponent(n)})),o=window.btoa((u=encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(function(n,e){return String.fromCharCode(parseInt(e,16))})),a=void 0,(a=u)&&(a=a.replace(/#/g,"%23")),a)),i=o.length-1;"="===o.charAt(i);)--i;var r=o.slice(0,i+1).replace(/\+/g,"-").replace(/\//g,"_");return"shares/u!".concat(r,"/driveItem")}catch(n){return void(null==e||e.ULS.sendTraceTag(541872152,v.W.io,h.G.Error,"getSharesUrl: Failed to get Share Url. ".concat(n)))}var u,a}(n,a);if(!f)return Promise.reject("No shareUrl");var p=function(n,e,t){var o,i=e.isConsumer,r=e.oneDriveResourceId,u=new URL(n);if(u&&u.protocol&&u.host){var a=i?r:"".concat(u.protocol,"//").concat(u.host),s=i?function(n){return n.inMockMode?n.officeHomeApiRoot:n.oneDriveConsumerApi}(e):function(n,e,t,o){void 0===t&&(t=!1),void 0===o&&(o=!1);var i=e.inMockMode?e.officeHomeApiRoot:n;return"".concat(i,t?"/_api":o?"/_api/v2.1":"/_api/v2.0")}(a||"",e),l=i?"OneDrive":null!==(o=mt(a||""))&&void 0!==o?o:"None";if(a&&s&&l)return{baseUrl:s,tokenType:l,resourceUrl:a,hostname:u.hostname};null==t||t.ULS.sendTraceTag(542492316,v.W.io,h.G.Error,"GetApiInfo failed. [InvalidResourceUrl: ".concat(!a,"][InvalidBaseUrl: ").concat(!s,"][InvalidTokenType: ").concat(!l,"]"))}else null==t||t.ULS.sendTraceTag(542492315,v.W.io,h.G.Error,"GetApiInfo failed. [InvalidParsedUrl: ".concat(!u,"][InvalidProtocol: ").concat(!(null==u?void 0:u.protocol),"][Invalidhost: ").concat(!(null==u?void 0:u.host),"]"))}(n,o,a);if(!p)return Promise.reject("No apiInfo");var m=new Date;m.setSeconds(0,0);var w=(0,t.ev)([Ct(e),wt(r),Ut(u)],(0,t.CR)(gt(s)),!1).filter((function(n){return!!n})).join("&"),g=c?"shares?itemUrl=".concat(encodeURIComponent(f),"&currentDate=").concat(m.toISOString()):"".concat(f,"?").concat(w);return Tt("".concat(p.baseUrl,"/").concat(g),d,p.tokenType,p.resourceUrl,i,a,l,yt)}function kt(n,e,o,i,r,u,a,s,l){var c;void 0===i&&(i=!1),void 0===r&&(r="open");var d=n.driveId,f=n.docId,p=n.baseUrl,m=n.docUrl;if(!d||!f)return Promise.reject("Not enough document information was given to retrieve the item");var g,S,b=(0,t.ev)([Ct(e),wt(r)],(0,t.CR)(gt(s)),!1).filter((function(n){return!!n})).join("&"),I=function(n){if(!n)return null;var e=new URL(n);return e.protocol+"//"+e.host}(null!=p?p:m);I?(S=I,g="".concat(p||I,"/_api/v2.0"),null==a||a.ULS.sendTraceTag(543958855,v.W.io,h.G.Info,"making vroom service call with driveId+docId")):(S=(0,w.A8)(u),g="".concat(S,"/v1.0"),null==a||a.ULS.sendTraceTag(543958856,v.W.io,h.G.Info,"making graph service call with driveId+docId"));var C="".concat(g,"/drives/").concat(encodeURIComponent(d),"/items/").concat(encodeURIComponent(f),"/?").concat(b),A=null!==(c=mt(S))&&void 0!==c?c:"None";return Tt(C,o.getAccessToken,A,S,i,a,l)}function Rt(n){var e={accept:"application/json",prefer:"allow-zerobyte,manualRedirect"};return(0,pt.sm)(n,e),e}function Ft(n,e,o,i,r,u,a,s,l,c){var d;if(void 0===r&&(r=!1),void 0===u&&(u="open"),!n||!e)return Promise.reject("Not enough document information was given to retrieve the item");var f,v=new URL(e),h="".concat(v.protocol,"//").concat(v.host),p=(0,t.ev)([Ct(o),wt(u)],(0,t.CR)(gt(s)),!1).filter((function(n){return!!n})).join("&");(0,Se.dt)(Se.Fh.FeatureGate_Vroom21SupportGate,l,a),m.c.isVroom21=l,f=l?"".concat(e,"/_api/v2.1/sites/root/items/").concat(encodeURIComponent(n),"/driveItem?").concat(p):"".concat(e,"/_api/v2.0/sites/root/items/").concat(encodeURIComponent(n),"/driveItem?").concat(p);var w=null!==(d=mt(e))&&void 0!==d?d:"None";return Tt(f,i.getAccessToken,w,h,r,a,c,Rt)}var Pt,Nt,Ot,Dt,_t,Wt,xt,Mt,jt,Gt,Bt,Lt,Vt,Kt,Jt,qt,zt="getItemFromWac";function Qt(n,e,o,i){var r={Authorization:(0,pt.sm)(i).Authorization,SessionId:o},u=(0,t.pi)((0,t.pi)({},e),{optionsHttpRequestHeaders:r});return{url:Ht,method:Ye.hx.Post,headers:n,body:u}}function Xt(n,e){if(n&&n.KMSI){var t={token:e,expiryTime:n.wacTokenExpTime};null===ln.X||void 0===ln.X||ln.X.setItem(Oe,JSON.stringify(t))}}function Zt(n,e){if(n)try{return JSON.parse(n.graphDriveItem)}catch(n){null==e||e.ULS.sendTraceTag(520439698,v.W.io,h.G.Error,"GetDriveItemFromWacWithUrl: Failed to parse vroom response from string to JSON. [Error: ".concat(JSON.stringify(n),"]"))}return Promise.reject({api:zt,message:"Failed to parse response data from string to JSON due to invalid data or format"})}var Yt,$t=!1,no=!1,eo=m.NF.SharePointOnline,to="owl-container",oo="PrebootDocumentOpen",io="owlfc";function ro(n){var e,t,o;if(!(null===(e=null==n?void 0:n.clientVersion)||void 0===e?void 0:e.trim()))throw new Error("invalid clientVersion");if(!n.exposure||n.exposure<=0||n.exposure>100)throw new Error("invalid exposure ("+(null!==(t=n.exposure)&&void 0!==t?t:"undefined")+")");n.wiseEnvironment=null===(o=n.wiseEnvironment)||void 0===o?void 0:o.toLocaleUpperCase(),Pt=n}function uo(n){var e;return null!==(e=document.getElementById(to))&&void 0!==e?e:co(n,to)}function ao(){if(Pt)return Pt.clientVersion;null==Gt||Gt.ULS.sendTraceTag(508060617,v.W.io,h.G.Error,"You must call initPackage before calling getOwlVersion")}function so(n){switch(n){case"Graph":return(0,w.A8)(Jt);case"OneDrive":return(0,w.Y6)();case"SharePoint":return(0,w.tf)();default:return""}}function lo(n){var e;if(n){var t;try{t=new URL(n)}catch(n){return}return null!==(e=new URLSearchParams(t.search).get("nav"))&&void 0!==e?e:void 0}}function co(n,e){var t=document.createElement("div");return t.id=e,n.appendChild(t)}function fo(n){return Nt?Nt(n):Promise.reject("endSession not defined")}function vo(n){return Ot?Ot(n):(null==Gt||Gt.ULS.sendTraceTag(555872272,v.W.io,h.G.Error,"hostAccessibilityLoopComplete no defined"),!1)}function ho(){return Wt?Wt():(null==Gt||Gt.ULS.sendTraceTag(508127040,v.W.io,h.G.Error,"hostBackButtonPressed no defined"),!1)}function po(){if(Dt)return null==Gt||Gt.ULS.sendTraceTag(508355844,v.W.io,h.G.Info,"Trying to get hostGetClientUrl."),void Dt();null==Gt||Gt.ULS.sendTraceTag(526152082,v.W.io,h.G.Error,"hostGetClientUrl not defined")}function mo(){if(_t)return null==Gt||Gt.ULS.sendTraceTag(508352272,v.W.io,h.G.Info,"Trying to get WebUrl"),void _t();null==Gt||Gt.ULS.sendTraceTag(508352271,v.W.io,h.G.Error,"hostGetWebUrl not defined")}function wo(n){Mt?Mt(n):null==Gt||Gt.ULS.sendTraceTag(507778320,v.W.io,h.G.Error,"createNewComplete is not defined")}function go(n){var e,o,i,r,a=this,s=(0,p.a)();U(),(0,p.l)([y.r_.OwlStart,"packageEntryTime"]);var l=n.documentIdentifier,c=n.sessionConfig,d=n.uiHostConfig,f=n.getAuthToken,S=n.eventHandlers,b=n.container;Jt=null!==(e=null==Pt?void 0:Pt.wiseEnvironment)&&void 0!==e?e:c.wiseEnvironment;var R=(0,t.pi)((0,t.pi)({},l),{fileType:c.fileType,wdOrigin:null!==(o=c.sessionOrigin)&&void 0!==o?o:"TEAMS.UNIFIEDUIHOST.OPEN",wdValue:c.wdValue,uiCulture:c.uiCulture,dataCulture:c.dataCulture,puid:c.puid,clickTime:c.clickTime,isNewFile:c.isNewFile,isTwoStepCreateNew:c.isTwoStepCreateNew,navId:lo(null!==(i=l.shareUrl)&&void 0!==i?i:l.docUrl),templateId:l.templateId,intent:null!==(r=c.intent)&&void 0!==r?r:"open"}),F=mn(R),P=c.sessionId||F||(0,g.n)()[0];c.bootDiagnostics=c.bootDiagnostics||{};var N=c.bootDiagnostics.ringId;c.bootDiagnostics.packageEntryTime=c.bootDiagnostics.packageEntryTime||s,Gt=new E.G2(P,Jt).logger,c.logger=Gt;var O=P===F,D=null==c?void 0:c.isNewFile;if(c.bootDiagnostics.isPrebooted=O,function(n,e,t,o,i,r){var u,a,s,l,c=n.wiseEnvironment;n.health=null!==(u=n.health)&&void 0!==u?u:Fe(e,c,n.fileType,n.uiCulture,n.puid,n.tenantId,n.hostCorrelationId,null==r?void 0:r.exposure,null==r?void 0:r.clientVersion,n.isSynthetic,t.uiHostName,t.uiHostIntegrationType,n.sessionOrigin,o,i),n.hostClientType&&(null===(a=n.health)||void 0===a||a.addOrUpdatePartCDimension("HostClientType",n.hostClientType)),n.teamType&&(null===(s=n.health)||void 0===s||s.addOrUpdatePartCDimension("TeamType",n.teamType)),n.isPopOut&&(null===(l=n.health)||void 0===l||l.addOrUpdatePartCDimension("IsPopOut",(!!n.isPopOut).toString()))}(c,P,d,N,D,Pt),Bt=c.health,H.qj.checkOwlFrameCookie(Jt,d.featureGates),H.qj.isOwlFrameBootEnabled(d.featureGates,Gt)&&($t=!0,No(Jt,c.fileType,b,!0,P).then((function(e){(0,p.l)(y.r_.OwlCreateFrameEnd),e.status===Ao.Success?(n.sessionConfig.initPackageParams=Pt,(0,p.l)(y.r_.OwlBootAppMessageSend),null==yo||yo.sendMessage({id:C.BootApplication,data:k(n)}),null==Gt||Gt.ULS.sendTraceTag(508432458,v.W.io,h.G.Info,"CreateOwlFrame: Succeeded and now booting document")):(null==Bt||Bt.recordQosError(m.DG.QosError_OwlFrameCreationFailure,[m.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0}),null==Gt||Gt.ULS.sendTraceTag(508432456,v.W.io,h.G.Error,"CreateOwlFrame: Failed to create frame"))})).catch((function(n){null==Bt||Bt.recordQosError(m.DG.QosError_OwlFrameCreationFailure,[m.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["Error","".concat(n)]])}),null==Gt||Gt.ULS.sendTraceTag(508432455,v.W.io,h.G.Error,"CreateOwlFrame: Exception: ".concat(n))})),H.qj.isOwlFrameBootEnabled(d.featureGates,Gt))){var _=function(n,e){var o=this;return null==yo||yo.registerHandler(I.GetAuthToken,(function(e){return(0,t.mG)(o,void 0,void 0,(function(){var o,i,r,u,a,s;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,3,4]),r=e.data,u=r.resourceUrl,a=r.claims,[4,n.getAuthToken(u,a)];case 1:return o=t.sent(),[3,4];case 2:return s=t.sent(),i=s,[3,4];case 3:return null==yo||yo.sendMessage({id:C.GetAuthTokenResponse,data:{token:o,error:i,correlationId:e.correlationId}}),[7];case 4:return[2]}}))}))})),rn(n.eventHandlers,e,n.sessionConfig.wiseEnvironment,n.uiHostConfig,n.sessionConfig.logger)}(n,R),W=Oo();return Nt=W.endSession,Ot=W.hostAccessibilityLoopComplete,Dt=W.hostGetClientUrl,_t=W.hostGetWebUrl,Wt=W.hostBackButtonPressed,xt=W.hostSendConversationId,Mt=W.completeCreateNew,(0,t.pi)((0,t.pi)({},W),{sessionEndObservable:_})}if(Vt=(0,Se.vJ)(Se.Fh.FeatureGate_EcsHootGate,d.featureGates),H.qj.isOwlFrame&&Vt&&!c.isAnonymous&&(c.loginHint||c.upn)&&(Yt||(Yt=We(c,Gt))),Pt||(Pt=c.initPackageParams),Kt=function(n,e){switch(n){case T.T.PowerPoint:return(0,Se.vJ)(Se.Fh.FeatureGate_Vroom21SupportGate,e.featureGates);case T.T.Word:return(0,Se.vJ)(Se.Fh.FeatureGate_Vroom21ForWord,e.featureGates);case T.T.Excel:return(0,Se.vJ)(Se.Fh.FeatureGate_Vroom21ForExcel,e.featureGates);default:return!1}}(c.fileType,d),qt=(0,Se.vJ)(Se.Fh.FeatureGate_BypassOPTIONSCall,d.featureGates),no=(0,Se.vJ)(Se.Fh.FeatureGate_ManualRedirectOnTenantChangeGate,d.featureGates),O){var x=new Map;x.set("StartTime",(new Date).toUTCString()),wn(R,P),null==Bt||Bt.recordKpiUsage(oo,A.o.FailureBased,io,x)}if(Lt=uo(b),l.docUrl||l.driveId&&l.docId||l.shareUrl||l.baseUrl&&l.fileId){var M,j=bo(f),G={correlationId:c.hostCorrelationId,officeHomeApiRoot:"",getAccessToken:j},B=(0,t.pi)((0,t.pi)({},c),{shareApiEndpoint:(0,w.PO)(Jt),metaUiHostVersion:Be.J.version,logger:Gt,sessionId:P}),L={isESSEnabled:B.isESSEnabled,wacDataCenter:B.isESSEnabled?Ke(c.fileType):void 0,sessionId:B.sessionId,hostCorrelationId:B.hostCorrelationId};(0,Se.dt)(Se.Fh.FeatureGate_EcsHootGate,Vt,Gt),Vt&&H.qj.isOwlFrame?(null==Gt||Gt.ULS.sendTraceTag(520757324,v.W.io,h.G.Info,"FetchItemFromWac: Hoot endpoint enabled in ECS, fetch driveItem from Wac"),M=Co(R)?Io(G,Jt,L,Kt,qt):function(n,e,o,i){return function(r,u,a,s){return void 0===u&&(u=!1),void 0===a&&(a=!1),null==s||s.ULS.sendTraceTag(526951838,v.W.io,h.G.Info,"Item to be fetched through wac service"),function(n,e,o,i,r,u,a,s){var l=this,c={docBootInfo:o,essOptions:u,api:r};return Ht=(0,w.XQ)(i,e),function(n,e){return(0,t.mG)(this,void 0,void 0,(function(){var o,i;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:if(o=null===ln.X||void 0===ln.X?void 0:ln.X.getItem(Oe))try{if((i=JSON.parse(o))&&i.token&&i.expiryTime&&parseInt(i.expiryTime,10)>(new Date).getTime()/1e3)return null==e||e.ULS.sendTraceTag(524821017,v.W.io,h.G.Info,"GetDriveItemFromWacWithUrl: Fetched valid access token from the windows local storage cache"),[2,i.token];null===ln.X||void 0===ln.X||ln.X.removeItem(Oe)}catch(n){null===ln.X||void 0===ln.X||ln.X.removeItem(Oe)}return[4,n("None",!0,Oe,void 0,!0)];case 1:return[2,t.sent()]}}))}))}(n,a).then((function(o){var i={accept:"application/json"},r=Qt(i,c,e,o);return at(r,a,s).then((function(n){return Xt(n,o),Zt(n,a)})).catch((function(u){return(0,t.mG)(l,void 0,void 0,(function(){return(0,t.Jh)(this,(function(t){return null==a||a.ULS.sendTraceTag(526471961,v.W.io,h.G.Error,"GetDriveItemFromWacWithUrl: Retrying getDriveItemFromWac. [Error: ".concat(JSON.stringify(u),"][FailureReason: ").concat(null==u?void 0:u.failure,"]")),u&&401===u.sharePointCallStatus&&"insufficient_claims"===u.claimsError&&u.claims?(null==a||a.ULS.sendTraceTag(512492100,v.W.io,h.G.Warning,"GetDriveItemFromWacWithUrl: Wac call vroom failed with claims challenge. Retry with claims"),[2,n("None",!0,Oe,void 0,!0,u.claims).then((function(n){return at(Qt(i,c,e,n),a,s).then((function(e){return Xt(e,n),Zt(e,a)}))}))]):[2,at(r,a,s).then((function(n){return Xt(n,o),Zt(n,a)}))]}))}))}))}))}(n.getAccessToken,e,r,o,eo,i,s,Bt)}}(G,P,Jt,L)):(null==Gt||Gt.ULS.sendTraceTag(520757325,v.W.io,h.G.Info,"FetchItemFromVroom: Hoot endpoint disabled in ECS, fetch driveItem from Vroom"),M=Io(G,Jt,L,Kt,qt));var V={documentBootInfo:R,fetchItemFromNetwork:M,fetchAccessToken:j,openShareControl:function(n){return(0,t.mG)(a,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){switch(e.label){case 0:return[4,u.e(3648).then(u.bind(u,3132))];case 1:return[2,e.sent().openVanillaJsShareControl(n,{},Lt)]}}))}))},sessionConfig:B,onBootComplete:S.onBootComplete,onBootFailure:S.onBootFailure,onReturnFocus:S.onReturnFocus,onConversationClose:S.onConversationClose,onNavigateBack:S.onNavigateBack,onOpenPageLevelConversation:S.onOpenPageLevelConversation,onDocumentClose:function(){S.onDocumentClose&&S.onDocumentClose(),null==Bt||Bt.shutdown()},onSuccessNotification:S.onSuccessNotification,onDismissHostSpinner:S.onDismissHostSpinner,onOpenInMobileApp:S.onOpenInMobileApp,onRename:S.onRename,initializeTwoStepCreateNew:S.initializeTwoStepCreateNew,bootstrapFile:S.bootstrapFile,uiHostConfig:d,createDocument:function(n){return(0,t.mG)(a,void 0,void 0,(function(){var e,o;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,4872))];case 1:return e=t.sent(),o={fileType:n.fileType,wdOrigin:"TEAMS.UNIFIEDUIHOST.NEW",uiCulture:c.uiCulture,dataCulture:c.dataCulture,puid:c.puid,clickTime:n.clickTime,isNewFile:!0},[2,e.createNewDocument(G,o,n,Jt,Gt)]}}))}))},container:b};return So(V)}null==Gt||Gt.ULS.sendTraceTag(576217559,v.W.io,h.G.Error,"No document url is found. Exit")}function So(n){var e,o,i,r,u,a,s,l,c,d=this,f=(0,p.a)();(0,p.l)(y.r_.OwlWithCustomFunctionsStart),U();var w=null!==(e=null==Pt?void 0:Pt.wiseEnvironment)&&void 0!==e?e:n.sessionConfig.wiseEnvironment,S=!!n.sessionConfig.health,b=function(n,e){var o,i,r,u,a,s,l,c,d,f,v,h=null!==(o=null==e?void 0:e.wiseEnvironment)&&void 0!==o?o:n.sessionConfig.wiseEnvironment,p=n.sessionConfig.sessionId||(0,g.n)();(n.sessionConfig.logger||(n.sessionConfig.logger=new E.G2(p,h).logger),n.sessionConfig.owlRollout="".concat(h,".").concat(null==e?void 0:e.exposure),n.sessionConfig.owlVersion=null==e?void 0:e.clientVersion,n.sessionConfig.health)||(v="string"==typeof p?p:(0,t.CR)(p,1)[0],n.sessionConfig.health=Fe(v,h,null===(i=n.documentBootInfo)||void 0===i?void 0:i.fileType,null===(r=n.documentBootInfo)||void 0===r?void 0:r.uiCulture,null===(u=n.documentBootInfo)||void 0===u?void 0:u.puid,n.sessionConfig.tenantId,n.sessionConfig.hostCorrelationId,null==e?void 0:e.exposure,null==e?void 0:e.clientVersion,n.sessionConfig.isSynthetic,null===(a=n.uiHostConfig)||void 0===a?void 0:a.uiHostName,null===(s=n.uiHostConfig)||void 0===s?void 0:s.uiHostIntegrationType,null===(l=n.documentBootInfo)||void 0===l?void 0:l.wdOrigin,null===(c=n.sessionConfig.bootDiagnostics)||void 0===c?void 0:c.ringId,null===(d=n.documentBootInfo)||void 0===d?void 0:d.isNewFile,null===(f=n.sessionConfig.bootDiagnostics)||void 0===f?void 0:f.isOdcMigrated));return n}(n,Pt),A=null!==(o=b.sessionConfig.sessionId)&&void 0!==o?o:(0,g.n)()[0];n.sessionConfig.sessionId=A,H.qj.checkOwlFrameCookie(w,null===(i=n.uiHostConfig)||void 0===i?void 0:i.featureGates),Vt||(Vt=(0,Se.vJ)(Se.Fh.FeatureGate_EcsHootGate,null===(r=b.uiHostConfig)||void 0===r?void 0:r.featureGates)),H.qj.isOwlFrame&&Vt&&!n.sessionConfig.isAnonymous&&(n.sessionConfig.loginHint||n.sessionConfig.upn)&&(Yt||(Yt=We(n.sessionConfig,Gt)),Co(n.documentBootInfo)||(n.fetchItemFromNetwork=function(e,t,o,i){var r;void 0===t&&(t=!1),void 0===o&&(o=!1);var u={isESSEnabled:n.sessionConfig.isESSEnabled,wacDataCenter:n.sessionConfig.isESSEnabled?Ke(n.documentBootInfo.fileType):void 0,sessionId:n.sessionConfig.sessionId,hostCorrelationId:n.sessionConfig.hostCorrelationId},a=null===(r=n.sessionConfig.bootDiagnostics)||void 0===r?void 0:r.isOdcMigrated;return"boolean"!=typeof a||a||(eo=m.NF.OneDriveConsumer),dt(e,u,Yt,n.sessionConfig.wiseEnvironment,eo,A,n.sessionConfig.upn,i,Bt)})),S||(Bt=b.sessionConfig.health),Gt||(Gt=b.sessionConfig.logger);var T=(0,Se.vJ)(Se.Fh.FeatureGate_IsOwlWacOAuthExperimentTreatmentEnabled,null===(u=n.uiHostConfig)||void 0===u?void 0:u.featureGates);if(null==Gt||Gt.ULS.sendTraceTag(508121308,v.W.io,h.G.Important,"OAuth Feature Gate: ".concat(T?"Enabled":"Disabled")),function(n,e){var t,o,i,r,u,a,s,l;n.sessionConfig.bootDiagnostics=n.sessionConfig.bootDiagnostics||{},n.sessionConfig.bootDiagnostics.packageEntryTime=n.sessionConfig.bootDiagnostics.packageEntryTime||e,n.sessionConfig.bootDiagnostics.perfNavigationTiming=n.sessionConfig.bootDiagnostics.perfNavigationTiming||(0,E.pb)(),H.qj.isOwlFrameBootEnabled(null===(t=n.uiHostConfig)||void 0===t?void 0:t.featureGates,Gt)&&(n.sessionConfig.bootDiagnostics.legacyPerformanceData=n.sessionConfig.bootDiagnostics.legacyPerformanceData||{host:(0,E.vb)()},H.qj.isOwlFrame&&(n.sessionConfig.bootDiagnostics.owlFramePerfNavigationTiming=n.sessionConfig.bootDiagnostics.owlFramePerfNavigationTiming||(0,E.pb)(),n.sessionConfig.bootDiagnostics.legacyPerformanceData.owlFrame=n.sessionConfig.bootDiagnostics.legacyPerformanceData.owlFrame||(0,E.vb)())),n.sessionConfig.bootDiagnostics.loadManifestStartTime=n.sessionConfig.bootDiagnostics.loadManifestStartTime||(null===(o=null==Pt?void 0:Pt.owlBootstrapperDiagnostics)||void 0===o?void 0:o.loadManifestStartTime)||0,n.sessionConfig.bootDiagnostics.loadManifestEndTime=n.sessionConfig.bootDiagnostics.loadManifestEndTime||(null===(i=null==Pt?void 0:Pt.owlBootstrapperDiagnostics)||void 0===i?void 0:i.loadManifestEndTime)||(null===(r=null==Pt?void 0:Pt.owlBootstrapperDiagnostics)||void 0===r?void 0:r.getManifestFromRemoteTimeElapsed),n.sessionConfig.bootDiagnostics.getManifestFromRemoteTimeElapsed=n.sessionConfig.bootDiagnostics.getManifestFromRemoteTimeElapsed||(null===(u=null==Pt?void 0:Pt.owlBootstrapperDiagnostics)||void 0===u?void 0:u.getManifestFromRemoteTimeElapsed),n.sessionConfig.bootDiagnostics.loadManifestServerTimeElapsed=n.sessionConfig.bootDiagnostics.loadManifestServerTimeElapsed||(null===(a=null==Pt?void 0:Pt.owlBootstrapperDiagnostics)||void 0===a?void 0:a.loadManifestServerTimeElapsed),n.sessionConfig.bootDiagnostics.loadOwlStartTime=n.sessionConfig.bootDiagnostics.loadOwlStartTime||(null===(s=null==Pt?void 0:Pt.owlBootstrapperDiagnostics)||void 0===s?void 0:s.loadOwlStartTime),n.sessionConfig.bootDiagnostics.loadOwlEndTime=n.sessionConfig.bootDiagnostics.loadOwlEndTime||(null===(l=null==Pt?void 0:Pt.owlBootstrapperDiagnostics)||void 0===l?void 0:l.loadOwlEndTime)}(b,f),!$t&&H.qj.isOwlFrameBootEnabled(null===(a=n.uiHostConfig)||void 0===a?void 0:a.featureGates,Gt)&&($t=!0,No(w,n.documentBootInfo.fileType,n.container,!0,A).then((function(e){return(0,t.mG)(d,void 0,void 0,(function(){var o,i,r;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return(0,p.l)(y.r_.OwlCreateFrameEnd),e.status!==Ao.Success?[3,4]:(n.sessionConfig.initPackageParams=Pt,(0,p.l)(y.r_.OwlBootAppWithCustomFunctionsMessageSend),null!=yo?[3,1]:[3,3]);case 1:return i=(o=yo).sendMessage,r={id:C.BootApplicationWithCustomFunctions},[4,R(n)];case 2:i.apply(o,[(r.data=t.sent(),r)]),t.label=3;case 3:return null==Gt||Gt.ULS.sendTraceTag(508432454,v.W.io,h.G.Info,"CreateOwlFrame: Succeeded and now booting document"),[3,5];case 4:null==Bt||Bt.recordQosError(m.DG.QosError_OwlFrameCreationFailure,[m.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0}),null==Gt||Gt.ULS.sendTraceTag(508432452,v.W.io,h.G.Error,"CreateOwlFrame: Failed to create frame"),t.label=5;case 5:return[2]}}))}))})).catch((function(n){null==Bt||Bt.recordQosError(m.DG.QosError_OwlFrameCreationFailure,[m.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["Error","".concat(n)]])}),null==Gt||Gt.ULS.sendTraceTag(508432451,v.W.io,h.G.Error,"CreateOwlFrame: Exception: ".concat(n))})),H.qj.isOwlFrameBootEnabled(null===(s=n.uiHostConfig)||void 0===s?void 0:s.featureGates,Gt))){var k=function(n){var e=this,o=rn(n,n.documentBootInfo,n.sessionConfig.wiseEnvironment,n.uiHostConfig,n.sessionConfig.logger);return null==yo||yo.registerHandler(I.FetchItemFromNetwork,(function(o){return(0,t.mG)(e,void 0,void 0,(function(){var e,i,r,u,a,s,l;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,3,4]),r=o.data,u=r.docBootInfo,a=r.forceRefresh,s=r.zeroByte,[4,n.fetchItemFromNetwork(u,a,s)];case 1:return e=t.sent(),[3,4];case 2:return l=t.sent(),i=l,[3,4];case 3:return null==yo||yo.sendMessage({id:C.FetchItemFromNetworkResponse,data:{correlationId:o.correlationId,item:e,error:i}}),[7];case 4:return[2]}}))}))})),null==yo||yo.registerHandler(I.FetchAccessToken,(function(o){return(0,t.mG)(e,void 0,void 0,(function(){var e,i,r,u,a,s,l,c,d;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return e=o.data,i=e.tokenConsumer,r=e.forceFetch,u=e.resourceUrl,a=e.scope,s=e.isBoot,l=e.claims,c=e.silent,[4,n.fetchAccessToken(i,r,u,a,s,l,c)];case 1:return d=t.sent(),null==yo||yo.sendMessage({id:C.FetchAccessTokenResponse,data:{correlationId:o.correlationId,response:d}}),[2]}}))}))})),null==yo||yo.registerHandler(I.OpenShareControl,(function(o){return(0,t.mG)(e,void 0,void 0,(function(){var e,i,r;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return e=o.data,i=e.shareProps,r=e.isShareDialogueZoomEnabled,[4,n.openShareControl(i,r)];case 1:return t.sent(),null==yo||yo.sendMessage({id:C.OpenShareControlResponse,data:{correlationId:o.correlationId}}),[2]}}))}))})),null==yo||yo.registerHandler(I.CreateDocument,(function(o){return(0,t.mG)(e,void 0,void 0,(function(){var e,i,r,u,a;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return e=o.data,i=e.createNewInfo,r=e.template,[4,null===(a=n.createDocument)||void 0===a?void 0:a.call(n,i,r)];case 1:return(u=t.sent())?null==yo||yo.sendMessage({id:C.CreateDocumentResponse,data:{correlationId:o.correlationId,url:u}}):null==yo||yo.sendMessage({id:C.CreateDocumentResponse,data:{correlationId:o.correlationId,error:"Failed to create document"}}),[2]}}))}))})),null==yo||yo.registerHandler(I.UserActivity,(function(e){var t;return null===(t=n.onUserActivity)||void 0===t?void 0:t.call(n)})),null==yo||yo.registerHandler(I.CAAEMessage,(function(e){var t;return null===(t=n.onCAAEMessage)||void 0===t?void 0:t.call(n,e.data)})),null==yo||yo.registerHandler(I.UserAccess,(function(e){var t;return null===(t=n.onUserAccess)||void 0===t?void 0:t.call(n,e.data)})),null==yo||yo.registerHandler(I.MoveToFolder,(function(e){var t;return null===(t=n.onMoveToFolder)||void 0===t?void 0:t.call(n,e.data)})),null==yo||yo.registerHandler(I.SharedFilePicker,(function(e){var t;return null===(t=n.onSharedFilePicker)||void 0===t?void 0:t.call(n,e.data)})),null==yo||yo.registerHandler(I.Rename,(function(e){var t;return null===(t=n.onRename)||void 0===t?void 0:t.call(n,e.data.newName)})),null==yo||yo.registerHandler(I.FrameChange,(function(e){var t;return null===(t=n.onFrameChange)||void 0===t?void 0:t.call(n,e.data)})),null==yo||yo.registerHandler(I.InvokeSessionRefreshInfoPopupBlockedDialog,(function(e){var t;null===(t=n.invokeSessionRefreshInfoPopupBlockedDialog)||void 0===t||t.call(n,{visible:e.data.visible,handleRefresh:function(){return null==Ho?void 0:Ho.sendMessage({id:C.SessionRefreshInfoDialogHandleRefresh,data:{}})},handleCancel:function(){return null==Ho?void 0:Ho.sendMessage({id:C.SessionRefreshInfoDialogHandleCancel,data:{}})},onDismiss:function(){return null==Ho?void 0:Ho.sendMessage({id:C.SessionRefreshInfoDialogOnDismiss,data:{}})}})})),null==yo||yo.registerHandler(I.FileEmbed,(function(e){var t;return null===(t=n.onFileEmbed)||void 0===t?void 0:t.call(n)})),o}(n),F=Oo();return Nt=F.endSession,Ot=F.hostAccessibilityLoopComplete,Dt=F.hostGetClientUrl,_t=F.hostGetWebUrl,Wt=F.hostBackButtonPressed,xt=F.hostSendConversationId,Mt=F.completeCreateNew,(0,t.pi)((0,t.pi)({},F),{sessionEndObservable:k})}var P=b.container;Lt=uo(b.container),b.container=Lt;var N=mn(b.documentBootInfo),O=A===N,D=b.onBootFailure;if(b.onBootFailure=function(n,e){var t,o,i,r=n.httpErrorCode,u=(0,Xe.SS)(n.wacErrorName),a=null!==(t=n.networkError)&&void 0!==t&&t;if(null==Bt||Bt.recordQosError(n.qosErrorName,["UnifiedUiHostBootstrappingFailed"],(0,Xe.Yf)(r,a),u,!0,!0,{inStaging:null===(o=n.inStaging)||void 0===o||o,extendedProperties:(0,Ze.x)(n)}),O){var s=new Map;s.set("FailureTime",(new Date).toUTCString()),s.set("Error",n.error),e&&s.set("DocumentBootInfo",JSON.stringify(e)),r&&s.set("HttpErrorCode",r),null==Bt||Bt.recordKpiFailure(oo,"PrebootDocumentOpenFailed",!1,!0,{durationMs:(0,p.a)()-((null===(i=b.sessionConfig.bootDiagnostics)||void 0===i?void 0:i.packageEntryTime)||f),extendedProperties:s})}D&&D(n,e),null==Bt||Bt.shutdown()},H.qj.isOwlFrameExperimentEnabled(null===(l=b.uiHostConfig)||void 0===l?void 0:l.featureGates,Gt)){var _=n.onBootComplete;n.onBootComplete=function(n,e){(function(n,e,o){return(0,t.mG)(this,void 0,void 0,(function(){var i,r,u;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,3,4]),(0,p.l)(y.r_.OwlCreateFrameStart),[4,No(o.sessionConfig.wiseEnvironment,e,n,!1,o.sessionConfig.sessionId)];case 1:return i=t.sent(),(0,p.l)(y.r_.OwlCreateFrameEnd),i.status===Ao.Success&&((0,p.l)(y.r_.OwlTokenFetchingExperimentMessageSend),null==yo||yo.sendMessage({id:C.TokenFetchingExperiment,data:{bootParams:o}})),r=(0,y.ME)({owlVersion:(null==Pt?void 0:Pt.clientVersion)||o.sessionConfig.owlVersion,wiseEnvironment:(null==Pt?void 0:Pt.wiseEnvironment)||o.sessionConfig.wiseEnvironment,exposure:null==Pt?void 0:Pt.exposure}).owlTelemetryData,null==Gt||Gt.ULS.sendTraceTag(508168084,v.W.io,h.G.Important,"[Auth Token Experiment Data (Host)]: ".concat(r)),[3,4];case 2:return u=t.sent(),i={status:Ao.Error,error:"Caught unexpected exception: ".concat(u)},null==Bt||Bt.recordQosError(m.DG.QosError_OwlFrameCreationFailure,[m.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["Error","".concat(u)]])}),[3,4];case 3:return(0,y.DS)(),[7];case 4:return null==Gt||Gt.ULS.sendTraceTag(508168083,v.W.io,h.G.Info,JSON.stringify(i)),[2]}}))}))})(b.container,b.documentBootInfo.fileType,b).catch((function(n){return null==Gt?void 0:Gt.ULS.sendTraceTag(508168085,v.W.io,h.G.Error,"Caught unexpected error running HOOT experiment: ".concat(n))})),null==_||_(n,e)}}var W=(0,t.pi)((0,t.pi)({},b),{initPackageParams:Pt});(null!==(c=W.initializeTwoStepCreateNew)&&void 0!==c?c:be.f)(W,Gt);var x=Ee(W);Nt=x.endSession,Ot=x.hostAccessibilityLoopComplete,Dt=x.hostGetClientUrl,_t=x.hostGetWebUrl,jt=x.postFrameDiagnostics,Wt=x.hostBackButtonPressed,xt=x.hostSendConversationId,Mt=x.completeCreateNew,H.qj.isOwlFrame&&function(n,e,o,i,r,u,a,s){var l=this;null==Ho||Ho.registerHandler(C.EndSession,(function(e){return(0,t.mG)(l,void 0,void 0,(function(){var o,i,r;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,3,4]),[4,n()];case 1:return o=t.sent(),[3,4];case 2:return r=t.sent(),i=r,[3,4];case 3:return null==Ho||Ho.sendMessage({id:I.EndSessionResponse,data:{result:o,error:i,correlationId:e.correlationId}}),[7];case 4:return[2]}}))}))})),null==Ho||Ho.registerHandler(C.HostAccessibilityLoopComplete,(function(n){return e(n.data.navigateForward)})),null==Ho||Ho.registerHandler(C.GetClientUrl,(function(n){return o()})),null==Ho||Ho.registerHandler(C.GetWebUrl,(function(n){return i()})),null==Ho||Ho.registerHandler(C.BackButtonPressed,(function(n){return r()})),null==Ho||Ho.registerHandler(C.SendConversationId,(function(n){return u(n.data.conversationId)})),null==Ho||Ho.registerHandler(C.GetAuthTokenResponse,Uo.getHandler(C.GetAuthTokenResponse,tn.Token)),null==Ho||Ho.registerHandler(C.FetchItemFromNetworkResponse,Uo.getHandler(C.FetchItemFromNetworkResponse,tn.Item)),null==Ho||Ho.registerHandler(C.FetchAccessTokenResponse,Uo.getHandler(C.FetchAccessTokenResponse,tn.Response)),null==Ho||Ho.registerHandler(C.OpenShareControlResponse,Uo.getHandler(C.OpenShareControlResponse)),null==Ho||Ho.registerHandler(C.CreateDocumentResponse,Uo.getHandler(C.CreateDocumentResponse,tn.URL)),null==Ho||Ho.registerHandler(C.TelemetryData,(function(n){var e=n.data,t=e.context,o=e.hostData,i=e.frameData,r=(0,y.W8)(JSON.parse(o.owlTelemetryData),JSON.parse(i.owlTelemetryData));a&&a(r.owlPerformanceTimeline),null==s||s.ULS.sendTraceTag(508614159,v.W.io,h.G.Important,t+", OwlFrame Telemetry Data: "+JSON.stringify(r)),null==s||s.ULS.sendTraceTag(508614158,v.W.io,h.G.Important,t+", Boot Telemetry Data: "+JSON.stringify({hostBoot:o.bootTelemetryData,frameBoot:i.bootTelemetryData}))}))}(Nt,Ot,Dt,_t,Wt,xt,jt,Gt);var M=function(n){var e=n.subscribe((function(n){var o,i;if(n&&(null===(o=b.uiHostConfig)||void 0===o?void 0:o.supportsInternalReboot)){var r=(0,g.n)(),u=new E.G2(r,w);b.sessionConfig.sessionId=u.sessionId,b.sessionConfig.logger=u.logger,b.sessionConfig.bootDiagnostics=(i=b.sessionConfig.bootDiagnostics,{tabsCacheHit:!0,packageEntryTime:(0,p.a)(),isTestMode:null==i?void 0:i.isTestMode,isPrebooted:!1,ringId:null==i?void 0:i.ringId,teamsContextStartTime:0,teamsContextEndTime:0,owlFramePerfNavigationTiming:(0,E.pb)(),perfNavigationTiming:(0,E.pb)(),meetingLiveDiagnostics:void 0}),b.sessionConfig.highContrastMode=n.theme,P&&Lt&&Lt.parentNode===P&&P.removeChild(Lt),Lt=co(P,to);var a=Ee((0,t.pi)((0,t.pi)({},b),{container:Lt,documentBootInfo:n.documentBootInfo,initPackageParams:Pt}));Nt=a.endSession,Ot=a.hostAccessibilityLoopComplete,Dt=a.hostGetClientUrl,_t=a.hostGetWebUrl,Wt=a.hostBackButtonPressed,xt=a.hostSendConversationId,Mt=a.completeCreateNew,e.unsubscribe(),M(a.sessionEndObservable)}else P&&Lt&&Lt.parentNode===P&&P.removeChild(Lt),e.unsubscribe();null==Bt||Bt.shutdown()}))};return M(x.sessionEndObservable),H.qj.isOwlFrame&&x.sessionEndObservable.subscribe((function(n){null==Ho||Ho.sendMessage({id:I.EndSessionObservable,data:{rebootInfo:n}})})),(0,p.l)([y.r_.OwlEnd,y.r_.OwlWithCustomFunctionsEnd]),x}function bo(n){return function(e,t,o,i,r,u){return null==Gt||Gt.ULS.sendTraceTag(546182046,v.W.io,h.G.Info,"FetchAccessToken: Start"),r&&(m.c.accessTokenStartTime=(0,p.a)(),(0,p.l)("accessTokenStartTime")),n(o||so(e),u).then((function(n){return{success:!0,token:n,format:"JWT",source:"OfficeHome"}})).catch((function(n){return Promise.reject({api:"getAuthToken",failure:n,message:"Failed to retrieve auth token"})})).finally((function(){null==Gt||Gt.ULS.sendTraceTag(546182047,v.W.io,h.G.Info,"FetchAccessToken: End"),r&&(m.c.accessTokenEndTime=(0,p.a)(),(0,p.l)("accessTokenEndTime"))}))}}function Io(n,e,o,i,r){var u=this;return function(a,s,l,c){return void 0===s&&(s=!0),void 0===l&&(l=!1),(0,t.mG)(u,void 0,void 0,(function(){var u,s,d;return(0,t.Jh)(this,(function(t){return u=!0,s=l?"editnew":"view"===a.intent?"view":"edit"===a.intent?"edit":"open",(null==o?void 0:o.isESSEnabled)&&o.wacDataCenter&&!Re.includes("wacSession")&&Re.push("wacSession"),a.shareUrl?(null==c||c.ULS.sendTraceTag(572634827,v.W.io,h.G.Info,"Item to be fetched using shareUrl"),[2,Et(a.shareUrl,Re,n,u,s,!1,c,o,r).catch((function(e){if(e&&404===e.status&&"The site has been moved to a new location."===e.message&&e.redirectLocation&&a.shareUrl){null==c||c.ULS.sendTraceTag(546120988,v.W.io,h.G.Info,"Get item failed due to site move. Retry with the redirect location");var t=new URL(e.redirectLocation),i=new URL(a.shareUrl);return a.shareUrl=a.shareUrl.replace(i.hostname,t.hostname),Et(a.shareUrl,Re,n,u,s,!1,c,o,r)}throw e}))]):a.driveId&&a.docId?(null==c||c.ULS.sendTraceTag(572634828,v.W.io,h.G.Info,"Item to be fetched using driveId and docId"),[2,kt(a,Re,n,u,s,e,c,o,r)]):a.fileId&&a.baseUrl?(null==c||c.ULS.sendTraceTag(572343521,v.W.io,h.G.Info,"Item to be fetched using fileId and baseUrl"),[2,Ft(a.fileId,a.baseUrl,Re,n,u,s,c,o,i,r).catch((function(e){if(no&&e&&404===e.status&&e.redirectLocation){if(null==c||c.ULS.sendTraceTag(508380358,v.W.io,h.G.Important,"Get item failed due to site move. Retry with the redirect location"),a.baseUrl){var t=new URL(a.baseUrl),l=new URL(e.redirectLocation);a.baseUrl=a.baseUrl.replace(t.hostname,l.hostname)}return Ft(a.fileId||"",a.baseUrl||"",Re,n,u,s,c,o,i,r)}throw e}))]):(null==c||c.ULS.sendTraceTag(572634829,v.W.io,h.G.Info,"Item to be fetched using docUrl"),[2,Et(null!==(d=a.docUrl)&&void 0!==d?d:"",Re,n,u,s,!1,c,o,r).catch((function(n){throw n}))])}))}))}}function Co(n){return!(n.shareUrl||!n.docId||!n.driveId||n.baseUrl||n.docUrl)}var Ao,To=function(){function n(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];this.$u=n,this.na=new Map(e.map((function(n){return[n,new Map]})))}return n.prototype.registerHandlers=function(){for(var n=this,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.forEach((function(e){return n.na.set(e,new Map)}))},n.prototype.getHandler=function(n,e,t){void 0===e&&(e=""),void 0===t&&(t="error");var o=this.na.get(n);return function(n){if(o){var i=o.get(n.data.correlationId);i&&(o.delete(n.data.correlationId),e?n.data[e]?i.resolve(n.data[e]):i.reject(n.data[t]||t):i.resolve())}}},n.prototype.getMessagePromise=function(n,e){var t=this,o=this.na.get(n);return o?new Promise((function(n,i){var r;t.$u||i("frameToHostMessenger does not exist");var u=null===(r=t.$u)||void 0===r?void 0:r.sendMessage(e);u?o.set(u,{resolve:n,reject:i}):i("Encountered error sending message to host")})):Promise.reject("No registered handlers ")},n}();!function(n){n[n.Success=0]="Success",n[n.Error=1]="Error",n[n.Timeout=2]="Timeout"}(Ao||(Ao={}));var yo,Ho,Uo,Eo,ko,Ro="OwlFrame",Fo=3e4,Po=m.NF.SharePointOnline;function No(n,e,o,i,r){return(0,t.mG)(this,void 0,void 0,(function(){var u,a,s,l;return(0,t.Jh)(this,(function(t){return u=function(n){return new URL((0,w.wl)(n)).origin}(n),(a=document.createElement("iframe")).src="".concat(u).concat(H.$$).concat(window.location.search?window.location.search+"&":"?","filetype=").concat(e,"&hostorigin=").concat(encodeURIComponent(window.location.origin),"&env=").concat(n).concat(r?"&corrid=".concat(r,"&usid=").concat(r):""),a.id=Ro,a.allowFullscreen=!0,a.allow="microphone ".concat(u,"; autoplay ").concat(u,"; camera ").concat(u,"; clipboard-read ").concat(u,"; clipboard-write ").concat(u,"; keyboard-map ").concat(u,"; display-capture ").concat(u),a.setAttribute("style","inset: 0px; height: ".concat(i?"100%":"0px","; width: ").concat(i?"100%":"0px","; display: block; position: absolute; background-color: transparent; border: none; visibility: ").concat(i?"visible":"hidden",";")),(0,p.l)(y.r_.OwlFetchWebLoaderStart),o.appendChild(a),s=new Promise((function(n){a.contentWindow&&(yo=new d(a.contentWindow,u),Eo=new To(yo,I.EndSessionResponse),yo.registerHandler(I.FrameLoaded,(function(e){(0,p.l)(y.r_.OwlLoadedMessageReceive),n(e.data.success?{status:Ao.Success}:{status:Ao.Error,error:e.data.error})})))})),l=new Promise((function(n){return setTimeout((function(){return n({status:Ao.Timeout,error:"Timed out waiting for OWL frame to load after ".concat(Fo," ms.")})}),Fo)})),[2,Promise.race([s,l])]}))}))}function Oo(){return{endSession:function(n){return Eo.getMessagePromise(I.EndSessionResponse,{id:C.EndSession,data:{rebootInfo:n}})},hostAccessibilityLoopComplete:function(n){return null==yo||yo.sendMessage({id:C.HostAccessibilityLoopComplete,data:{navigateForward:n}}),!0},hostGetClientUrl:function(){null==yo||yo.sendMessage({id:C.GetClientUrl,data:{}})},hostGetWebUrl:function(){null==yo||yo.sendMessage({id:C.GetWebUrl,data:{}})},hostBackButtonPressed:function(){return null==yo||yo.sendMessage({id:C.BackButtonPressed,data:{}}),!0},hostSendConversationId:function(n){null==yo||yo.sendMessage({id:C.SendConversationId,data:{conversationId:n}})},postWacToken:function(n){null==yo||yo.sendMessage({id:C.PostWacToken,data:{wacToken:n}})},completeCreateNew:function(){}}}function Do(){Ho&&Ho.dispose(),yo&&yo.dispose(),window.performance&&window.performance.getEntriesByType&&window.performance.clearMarks&&window.performance.getEntriesByType("mark").filter((function(n){return n.name.startsWith("owl")})).forEach((function(n){return window.performance.clearMarks(n.name)}));var n=document.getElementById(Ro);n&&n.remove()}!function(n){n[n.Firefox=0]="Firefox",n[n.Opera=1]="Opera",n[n.IE=2]="IE",n[n.Edge=3]="Edge",n[n.Chrome=4]="Chrome",n[n.Safari=5]="Safari",n[n.TeamsElectron=6]="TeamsElectron",n[n.Unknown=7]="Unknown"}(ko||(ko={}));var _o=window.navigator,Wo=_o?_o.userAgent:void 0;function xo(){return!!Wo&&Wo.indexOf("iPhone")>=0||/android.+mobile/i.test(_o.userAgent)}var Mo,jo,Go,Bo=u(8404);function Lo(){var n=window.location.search,e=new URLSearchParams(n),t=e.get(m.$c.ItemId),o=e.get(m.$c.DriveId),i=e.get(m.$c.DocUrl);return{docId:null!=t?t:void 0,driveId:null!=o?o:void 0,docUrl:null!=i?i:void 0}}function Vo(n){return Go||(Go=function(){jo||((jo={})[T.T[T.T.Excel]]=["xls","xlsx","xlb","xlc","xlsb","xlsm","xlt","xltx","xltm","xlm","xla","xll","xlam","xlw","excel","csv"],jo[T.T[T.T.Visio]]=["vsd","vss","vst","vdx","vsx","vtx","vsl","vsu","vsw","vsdx","vsdm","vssm","vstx","vstm"],jo[T.T[T.T.PowerPoint]]=["ppt","pptx","pot","potx","potm","ppam","ppsx","ppsm","sldx","sldm","ppa","pps","pptm","powerpoint"],jo[T.T[T.T.Word]]=["doc","dot","docx","docm","dotx","dotm","docb","word"],jo[T.T[T.T.OneNote]]=["one"]),Go={};var n=function(n){if(!jo.hasOwnProperty(n))return"continue";var e=jo[n];if(!e)return"continue";e.forEach((function(e){Go[e]=T.T[n]}))};for(var e in jo)n(e);return Go}()),n&&Go[n.toLowerCase()]||T.T.None}function Ko(){var n=window.location.pathname.split("/");if(4===n.length||5===n.length)return function(n){switch(n){case"word":return T.T.Word;case"excel":return T.T.Excel;case"powerpoint":return T.T.PowerPoint;case"onenote":return T.T.OneNote;case"visio":return T.T.Visio;default:return}}(n[2].toLowerCase())}!function(n){n[n.NotSupported=0]="NotSupported",n[n.SameDocOnly=1]="SameDocOnly",n[n.AnyDoc=2]="AnyDoc",n[n.OtherMode=4]="OtherMode"}(Mo||(Mo={})),function(){var n,e;if(H.qj.isOwlFrame){(0,p.l)(y.r_.OwlFrameScriptExecutionStart);var o=new URLSearchParams(location.search),i=document.getElementById("owl"),r=o.get("hostorigin"),u="true"===(null===(e=null===(n=null==i?void 0:i.dataset)||void 0===n?void 0:n.validHost)||void 0===e?void 0:e.toLowerCase());r&&u&&function(n){var e=this;Ho=new d(window.parent,n),Uo=new To(Ho,C.GetAuthTokenResponse,C.FetchItemFromNetworkResponse,C.FetchAccessTokenResponse,C.OpenShareControlResponse,C.CreateDocumentResponse),Ho.registerHandler(C.BootApplication,(function(n){(0,p.l)(y.r_.OwlBootAppMessageReceive),go(function(n){var e,o,i,r,u,a,s,l,c,d,f,v,h,p,m,w,g,S,b,A,T,y,H,U,k,R,j,G,B,L,V,K,q,z,Q,X,Z,Y,$,nn,tn;return{documentIdentifier:n.documentIdentifier,sessionConfig:{hostCorrelationId:n.sessionConfig.hostCorrelationId,isMsa:n.sessionConfig.isMsa,tenantId:n.sessionConfig.tenantId,organizationName:n.sessionConfig.organizationName,sessionId:n.sessionConfig.sessionId,isESSEnabled:n.sessionConfig.isESSEnabled,experiments:n.sessionConfig.experiments,highContrastMode:n.sessionConfig.highContrastMode,additionalApplicationParameters:n.sessionConfig.additionalApplicationParameters,bootDiagnostics:{tabsCacheHit:null===(e=n.sessionConfig.bootDiagnostics)||void 0===e?void 0:e.tabsCacheHit,packageEntryTime:null===(o=n.sessionConfig.bootDiagnostics)||void 0===o?void 0:o.packageEntryTime,isTestMode:null===(i=n.sessionConfig.bootDiagnostics)||void 0===i?void 0:i.isTestMode,isManifestCachingEnabled:null===(r=n.sessionConfig.bootDiagnostics)||void 0===r?void 0:r.isManifestCachingEnabled,isOwlBootstrapperEnabled:null===(u=n.sessionConfig.bootDiagnostics)||void 0===u?void 0:u.isOwlBootstrapperEnabled,isPrebooted:null===(a=n.sessionConfig.bootDiagnostics)||void 0===a?void 0:a.isPrebooted,isVroom21:null===(s=n.sessionConfig.bootDiagnostics)||void 0===s?void 0:s.isVroom21,ringId:null===(l=n.sessionConfig.bootDiagnostics)||void 0===l?void 0:l.ringId,teamsContextStartTime:null===(c=n.sessionConfig.bootDiagnostics)||void 0===c?void 0:c.teamsContextStartTime,teamsContextEndTime:null===(d=n.sessionConfig.bootDiagnostics)||void 0===d?void 0:d.teamsContextEndTime,wopiDataStartTime:null===(f=n.sessionConfig.bootDiagnostics)||void 0===f?void 0:f.wopiDataStartTime,wopiDataEndTime:null===(v=n.sessionConfig.bootDiagnostics)||void 0===v?void 0:v.wopiDataEndTime,bootStrapStartTime:null===(h=n.sessionConfig.bootDiagnostics)||void 0===h?void 0:h.bootStrapStartTime,bootStrapEndTime:null===(p=n.sessionConfig.bootDiagnostics)||void 0===p?void 0:p.bootStrapEndTime,driveItemStartTime:null===(m=n.sessionConfig.bootDiagnostics)||void 0===m?void 0:m.driveItemStartTime,driveItemEndTime:null===(w=n.sessionConfig.bootDiagnostics)||void 0===w?void 0:w.driveItemEndTime,driveItemFromWacStartTime:null===(g=n.sessionConfig.bootDiagnostics)||void 0===g?void 0:g.driveItemFromWacStartTime,driveItemFromWacEndTime:null===(S=n.sessionConfig.bootDiagnostics)||void 0===S?void 0:S.driveItemFromWacEndTime,accessTokenStartTime:null===(b=n.sessionConfig.bootDiagnostics)||void 0===b?void 0:b.accessTokenStartTime,accessTokenEndTime:null===(A=n.sessionConfig.bootDiagnostics)||void 0===A?void 0:A.accessTokenEndTime,isCookieBlocked:null===(T=n.sessionConfig.bootDiagnostics)||void 0===T?void 0:T.isCookieBlocked,meetingLiveDiagnostics:null===(y=n.sessionConfig.bootDiagnostics)||void 0===y?void 0:y.meetingLiveDiagnostics,spRequestGuid:null===(H=n.sessionConfig.bootDiagnostics)||void 0===H?void 0:H.spRequestGuid,createNewStartTime:null===(U=n.sessionConfig.bootDiagnostics)||void 0===U?void 0:U.createNewStartTime,createNewEndTime:null===(k=n.sessionConfig.bootDiagnostics)||void 0===k?void 0:k.createNewEndTime,loadManifestStartTime:null===(R=n.sessionConfig.bootDiagnostics)||void 0===R?void 0:R.loadManifestStartTime,loadManifestEndTime:null===(j=n.sessionConfig.bootDiagnostics)||void 0===j?void 0:j.loadManifestEndTime,getManifestFromRemoteTimeElapsed:null===(G=n.sessionConfig.bootDiagnostics)||void 0===G?void 0:G.getManifestFromRemoteTimeElapsed,loadManifestServerTimeElapsed:null===(B=n.sessionConfig.bootDiagnostics)||void 0===B?void 0:B.loadManifestServerTimeElapsed,loadOwlStartTime:null===(L=n.sessionConfig.bootDiagnostics)||void 0===L?void 0:L.loadOwlStartTime,loadOwlEndTime:null===(V=n.sessionConfig.bootDiagnostics)||void 0===V?void 0:V.loadOwlEndTime,owlBootstrapperStartTime:null===(K=n.sessionConfig.bootDiagnostics)||void 0===K?void 0:K.owlBootstrapperStartTime,owlBootstrapperEndTime:null===(q=n.sessionConfig.bootDiagnostics)||void 0===q?void 0:q.owlBootstrapperEndTime,isOdcMigrated:null===(z=n.sessionConfig.bootDiagnostics)||void 0===z?void 0:z.isOdcMigrated,perfNavigationTiming:null===(Q=n.sessionConfig.bootDiagnostics)||void 0===Q?void 0:Q.perfNavigationTiming,owlFramePerfNavigationTiming:(null===(X=n.sessionConfig.bootDiagnostics)||void 0===X?void 0:X.owlFramePerfNavigationTiming)||(0,E.pb)(),legacyPerformanceData:{host:null===(Y=null===(Z=n.sessionConfig.bootDiagnostics)||void 0===Z?void 0:Z.legacyPerformanceData)||void 0===Y?void 0:Y.host,owlFrame:(null===(nn=null===($=n.sessionConfig.bootDiagnostics)||void 0===$?void 0:$.legacyPerformanceData)||void 0===nn?void 0:nn.owlFrame)||(0,E.vb)()}},uiHostTabId:n.sessionConfig.uiHostTabId,upn:n.sessionConfig.upn,meeting:n.sessionConfig.meeting,customAuthConfigValue:n.sessionConfig.customAuthConfigValue,wiseEnvironment:n.sessionConfig.wiseEnvironment,isSynthetic:n.sessionConfig.isSynthetic,hostUrl:n.sessionConfig.hostUrl,owlVersion:n.sessionConfig.owlVersion,owlRollout:n.sessionConfig.owlRollout,fileType:n.sessionConfig.fileType,clickTime:n.sessionConfig.clickTime,uiCulture:n.sessionConfig.uiCulture,dataCulture:n.sessionConfig.dataCulture,puid:n.sessionConfig.puid,isNewFile:n.sessionConfig.isNewFile,wdValue:n.sessionConfig.wdValue,sessionOrigin:n.sessionConfig.sessionOrigin,intent:n.sessionConfig.intent,hostClientType:n.sessionConfig.hostClientType,isPopOut:n.sessionConfig.isPopOut,teamType:n.sessionConfig.teamType,initPackageParams:n.sessionConfig.initPackageParams&&(0,t.pi)((0,t.pi)({},n.sessionConfig.initPackageParams),{jsApiUrlInfos:en(null===(tn=n.sessionConfig.initPackageParams)||void 0===tn?void 0:tn.jsApiUrlInfos)}),origin:n.sessionConfig.origin},uiHostConfig:(0,t.pi)((0,t.pi)({},n.uiHostConfig),{featureGates:n.uiHostConfig.featureGates?en(n.uiHostConfig.featureGates):void 0}),getAuthToken:function(n,e){return Uo.getMessagePromise(C.GetAuthTokenResponse,{id:I.GetAuthToken,data:{resourceUrl:n,claims:e}})},eventHandlers:{onBootComplete:F,onBootFailure:P,onReturnFocus:N,onConversationClose:O,onNavigateBack:D,onOpenPageLevelConversation:_,onDocumentClose:W,onSuccessNotification:x,onOpenInMobileApp:M},container:document.getElementById("owl-container")||J()}}(n.data))})),Ho.registerHandler(C.BootApplicationWithCustomFunctions,(function(e){(0,p.l)(y.r_.OwlBootAppWithCustomFunctionsMessageReceive),So(function(n,e){var o,i,r,u,a,s,l,c;return{documentBootInfo:n.documentBootInfo,fetchItemFromNetwork:j,fetchAccessToken:G,openShareControl:B,sessionConfig:(0,t.pi)((0,t.pi)({},n.sessionConfig),{bootDiagnostics:(0,t.pi)((0,t.pi)({},n.sessionConfig.bootDiagnostics),{perfNavigationTiming:null===(o=n.sessionConfig.bootDiagnostics)||void 0===o?void 0:o.perfNavigationTiming,owlFramePerfNavigationTiming:(null===(i=n.sessionConfig.bootDiagnostics)||void 0===i?void 0:i.owlFramePerfNavigationTiming)||(0,E.pb)(),legacyPerformanceData:{host:null===(u=null===(r=n.sessionConfig.bootDiagnostics)||void 0===r?void 0:r.legacyPerformanceData)||void 0===u?void 0:u.host,owlFrame:(null===(s=null===(a=n.sessionConfig.bootDiagnostics)||void 0===a?void 0:a.legacyPerformanceData)||void 0===s?void 0:s.owlFrame)||(0,E.vb)()}})}),container:document.getElementById("owl-container")||J(),createDocument:L,setTitle:V,onBootComplete:F,onBootFailure:P,onReturnFocus:N,onConversationClose:O,onNavigateBack:D,onOpenPageLevelConversation:_,onDocumentClose:W,onSuccessNotification:x,onOpenInMobileApp:M,onUserActivity:K,uiHostConfig:(0,t.pi)((0,t.pi)({},n.uiHostConfig),{featureGates:(null===(l=n.uiHostConfig)||void 0===l?void 0:l.featureGates)?en(n.uiHostConfig.featureGates):void 0}),additionalApplicationParameters:n.additionalApplicationParameters,sharingLinkTokenProvider:n.sharingLinkTokenProvider?{TokenPromise:new Promise((function(n,e){null==Ho||Ho.registerHandler(C.SharingLinkTokenProvider,(function(t){t.data.token?n(t.data.token):e(t.data.error)}))}))}:void 0,onCAAEMessage:q,onUserAccess:z,onMoveToFolder:Q,onSharedFilePicker:X,onRename:Z,initPackageParams:n.initPackageParams&&(0,t.pi)((0,t.pi)({},n.initPackageParams),{jsApiUrlInfos:en(null===(c=n.initPackageParams)||void 0===c?void 0:c.jsApiUrlInfos)}),onFrameChange:Y,invokeSessionRefreshInfoPopupBlockedDialog:function(n){var t=new d(window.parent,e);t.registerHandler(C.SessionRefreshInfoDialogHandleRefresh,(function(){t.dispose(),n.handleRefresh()})),t.registerHandler(C.SessionRefreshInfoDialogHandleCancel,(function(){t.dispose(),n.handleCancel()})),t.registerHandler(C.SessionRefreshInfoDialogOnDismiss,(function(){t.dispose(),n.onDismiss()})),null==Ho||Ho.sendMessage({id:I.InvokeSessionRefreshInfoPopupBlockedDialog,data:{visible:n.visible}})},onFileEmbed:$}}(e.data,n))})),Ho.registerHandler(C.TokenFetchingExperiment,(function(n){return(0,t.mG)(e,void 0,void 0,(function(){var e,o,i,r,u,a,s,l;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:U(),(0,p.l)(y.r_.OwlTokenFetchingExperimentMessageReceived),e=n.data.bootParams,o=(0,f.L8)({remoteUlsEndpoint:(0,w.fy)(e.sessionConfig.wiseEnvironment),sessionId:e.sessionConfig.sessionId}),i=We(e.sessionConfig,o),r={isESSEnabled:e.sessionConfig.isESSEnabled,wacDataCenter:e.sessionConfig.isESSEnabled?Ke(e.documentBootInfo.fileType):void 0,sessionId:e.sessionConfig.sessionId,hostCorrelationId:e.sessionConfig.hostCorrelationId},"boolean"!=typeof(u=null===(l=e.sessionConfig.bootDiagnostics)||void 0===l?void 0:l.isOdcMigrated)||u||(Po=m.NF.OneDriveConsumer),t.label=1;case 1:return t.trys.push([1,3,4,5]),(0,p.l)(y.r_.OwlGetDriveItemWithMsalStart),[4,dt(e.documentBootInfo,r,i,e.sessionConfig.wiseEnvironment,Po,e.sessionConfig.sessionId,e.sessionConfig.upn,o)];case 2:return t.sent(),(0,p.l)(y.r_.OwlGetDriveItemWithMsalEnd),[3,5];case 3:return a=t.sent(),null==o||o.ULS.sendTraceTag(508168087,v.W.io,h.G.Error,"Failed to get drive item with shared auth, error: ".concat(a)),[3,5];case 4:return(0,y.DS)(),[7];case 5:return s=(0,y.ME)({owlVersion:null==Pt?void 0:Pt.clientVersion,wiseEnvironment:null==Pt?void 0:Pt.wiseEnvironment,exposure:null==Pt?void 0:Pt.exposure}).owlTelemetryData,null==o||o.ULS.sendTraceTag(508168086,v.W.io,h.G.Important,"[Auth Token Experiment Data (Frame)]: ".concat(s)),[2]}}))}))})),(0,p.l)(y.r_.OwlLoadedMessageSend),Ho.sendMessage({id:I.FrameLoaded,data:{success:!0}})}(r)}}()}(),((Microsoft=void 0===Microsoft?{}:Microsoft).Office=Microsoft.Office||{}).OWL=a}();